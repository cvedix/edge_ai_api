openapi: 3.0.3
info:
  title: Edge AI API
  description: |
    REST API for Edge AI operations and management.
    
    ## Logging Features
    
    The server supports detailed logging features that can be enabled via command-line arguments:
    
    - **API Logging** (`--log-api` or `--debug-api`): Logs all API requests and responses with response times
    - **Instance Execution Logging** (`--log-instance` or `--debug-instance`): Logs instance lifecycle events (start/stop/status)
    - **SDK Output Logging** (`--log-sdk-output` or `--debug-sdk-output`): Logs SDK output when instances process data
    
    Example usage:
    ```bash
    ./edge_ai_api --log-api --log-instance --log-sdk-output
    ```
    
    For more details, see the [Logging Documentation](../docs/LOGGING.md).
    
    ## Swagger UI
    
    This API provides Swagger UI for interactive testing and exploration:
    - Access Swagger UI at `/swagger` or `/v1/swagger`
    - OpenAPI specification available at `/openapi.yaml` or `/v1/openapi.yaml`
    - Server URLs are automatically updated based on environment variables (`API_HOST` and `API_PORT`)
  version: 2025.0.1.1
  contact:
    name: Edge AI API Support

servers:
  - url: http://localhost:8080
    description: Local development server
  - url: http://0.0.0.0:8080
    description: Default server

paths:
  /v1/core/health:
    get:
      summary: Health check endpoint
      description: Returns the health status of the API service
      operationId: getHealth
      tags:
        - Core
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: "healthy"
                timestamp: "2024-01-01T00:00:00.000Z"
                uptime: 3600
                service: "edge_ai_api"
                version: "2025.0.1.1"
        '500':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/version:
    get:
      summary: Get version information
      description: Returns version information about the API service
      operationId: getVersion
      tags:
        - Core
      responses:
        '200':
          description: Version information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'
              example:
                version: "2025.0.1.1"
                build_time: "Jan 01 2024 00:00:00"
                git_commit: "abc123def456"
                api_version: "v1"
                service: "edge_ai_api"

  /v1/core/system/info:
    get:
      summary: Get system hardware information
      description: Returns detailed hardware information including CPU, GPU, RAM, Disk, Mainboard, OS, and Battery
      operationId: getSystemInfo
      tags:
        - Core
      responses:
        '200':
          description: System hardware information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemInfoResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for system info
      operationId: getSystemInfoOptions
      tags:
        - Core
      responses:
        '200':
          description: CORS preflight response

  /v1/core/system/status:
    get:
      summary: Get system status
      description: Returns current system status including CPU usage, RAM usage, load average, and uptime
      operationId: getSystemStatus
      tags:
        - Core
      responses:
        '200':
          description: System status information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemStatusResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for system status
      operationId: getSystemStatusOptions
      tags:
        - Core
      responses:
        '200':
          description: CORS preflight response

  /v1/core/config:
    get:
      summary: Get system configuration
      description: |
        Returns system configuration. If `path` query parameter is provided, returns the specific configuration section.
        Otherwise, returns the complete system configuration.
        
        **Path Format:**
        - Use forward slashes `/` or dots `.` to navigate nested configuration keys
        - Examples: `system/max_running_instances`, `system.max_running_instances`, `gstreamer/decode_pipelines/auto`
        
        **Recommended:** Use query parameter with forward slashes for better compatibility.
      operationId: getConfig
      tags:
        - Config
      parameters:
        - name: path
          in: query
          required: false
          schema:
            type: string
          description: |
            Configuration path to get a specific section. Use `/` or `.` as separators.
            Examples: `system/max_running_instances`, `system.web_server`, `gstreamer/decode_pipelines/auto`
          example: "system/max_running_instances"
      responses:
        '200':
          description: Full system configuration
          content:
            application/json:
              schema:
                type: object
                description: Complete system configuration object
                additionalProperties: true
                example:
                  auto_device_list:
                    - "hailo.auto"
                    - "blaize.auto"
                  decoder_priority_list:
                    - "blaize.auto"
                    - "software"
                  gstreamer:
                    decode_pipelines:
                      auto:
                        pipeline: "decodebin ! videoconvert"
                  system:
                    web_server:
                      enabled: true
                      ip_address: "0.0.0.0"
                      port: 3546
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create or update configuration (merge)
      description: |
        Updates the system configuration by merging the provided JSON with the existing configuration.
        Only the provided fields will be updated; other fields remain unchanged.
        The configuration is saved to the config file after update.
      operationId: createOrUpdateConfig
      tags:
        - Config
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Configuration object to merge
              additionalProperties: true
              example:
                system:
                  web_server:
                    port: 8080
      responses:
        '200':
          description: Configuration updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration updated successfully"
                  config:
                    type: object
                    description: Updated full configuration
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Replace entire configuration
      description: |
        Replaces the entire system configuration with the provided JSON.
        All existing configuration will be replaced with the new values.
        The configuration is saved to the config file after replacement.
      operationId: replaceConfig
      tags:
        - Config
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Complete configuration object to replace existing config
              additionalProperties: true
              example:
                auto_device_list:
                  - "hailo.auto"
                system:
                  web_server:
                    enabled: true
                    port: 8080
      responses:
        '200':
          description: Configuration replaced successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration replaced successfully"
                  config:
                    type: object
                    description: New full configuration
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    patch:
      summary: Update configuration section (query parameter)
      description: |
        Updates a specific section of the system configuration at the given path.
        
        **Path Format:**
        - Use forward slashes `/` or dots `.` as separators
        - Examples: `system/max_running_instances`, `system.max_running_instances`
        
        Only the provided fields in the section will be updated.
        The configuration is saved to the config file after update.
      operationId: updateConfigSectionQuery
      tags:
        - Config
      parameters:
        - name: path
          in: query
          required: true
          schema:
            type: string
          description: Configuration path using `/` or `.` as separators
          example: "system/max_running_instances"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Configuration section value to update
              additionalProperties: true
              example:
                port: 8080
      responses:
        '200':
          description: Configuration section updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section updated successfully"
                  path:
                    type: string
                    example: "system/max_running_instances"
                  value:
                    type: object
                    description: Updated configuration section value
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete configuration section (query parameter)
      description: |
        Deletes a specific section of the system configuration at the given path.
        
        **Path Format:**
        - Use forward slashes `/` or dots `.` as separators
        - Examples: `system/max_running_instances`, `system.max_running_instances`
        
        The configuration is saved to the config file after deletion.
      operationId: deleteConfigSectionQuery
      tags:
        - Config
      parameters:
        - name: path
          in: query
          required: true
          schema:
            type: string
          description: Configuration path using `/` or `.` as separators
          example: "system/max_running_instances"
      responses:
        '200':
          description: Configuration section deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section deleted successfully"
                  path:
                    type: string
                    example: "system/max_running_instances"
        '400':
          description: Invalid request (empty path)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Configuration section not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for config
      operationId: configOptions
      tags:
        - Config
      responses:
        '200':
          description: CORS preflight response

  /v1/core/config/reset:
    post:
      summary: Reset configuration to defaults
      description: |
        Resets the entire system configuration to default values.
        All existing configuration will be replaced with default values.
        The configuration is saved to the config file after reset.
        
        **Warning:** This operation will replace all configuration with default values.
        Consider backing up your configuration before resetting.
      operationId: resetConfig
      tags:
        - Config
      responses:
        '200':
          description: Configuration reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration reset to defaults successfully"
                  config:
                    type: object
                    description: Default configuration object
                    additionalProperties: true
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/config/{path}:
    get:
      summary: Get configuration section (path parameter)
      description: |
        Returns a specific section of the system configuration at the given path.
        
        **Path Format:**
        - Use dots `.` as separators (e.g., `system.max_running_instances`)
        - Forward slashes `/` with URL encoding (`%2F`) are NOT supported due to Drogon routing limitations
        
        **Recommended:** Use query parameter instead: `GET /v1/core/config?path=system/max_running_instances`
        
        Example paths: `system.max_running_instances`, `system.web_server`, `gstreamer.decode_pipelines.auto`
      operationId: getConfigSection
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: |
            Configuration path using dots as separators.
            Examples: `system.max_running_instances`, `system.web_server`, `gstreamer.decode_pipelines.auto`
            Note: Forward slashes are NOT supported in path parameter (use query parameter instead)
          example: "system.max_running_instances"
      responses:
        '200':
          description: Configuration section
          content:
            application/json:
              schema:
                type: object
                description: Configuration section value (can be object, array, or primitive)
                additionalProperties: true
                example:
                  enabled: true
                  ip_address: "0.0.0.0"
                  port: 3546
        '400':
          description: Invalid request (empty path)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Configuration section not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    patch:
      summary: Update configuration section (path parameter)
      description: |
        Updates a specific section of the system configuration at the given path.
        
        **Path Format:**
        - Use dots `.` as separators (e.g., `system.max_running_instances`)
        - Forward slashes `/` with URL encoding (`%2F`) are NOT supported
        
        **Recommended:** Use query parameter instead: `PATCH /v1/core/config?path=system/max_running_instances`
        
        Only the provided fields in the section will be updated.
        The configuration is saved to the config file after update.
      operationId: updateConfigSection
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: |
            Configuration path using dots as separators.
            Examples: `system.max_running_instances`, `system.web_server`
            Note: Forward slashes are NOT supported in path parameter (use query parameter instead)
          example: "system.max_running_instances"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Configuration section value to update
              additionalProperties: true
              example:
                port: 8080
      responses:
        '200':
          description: Configuration section updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section updated successfully"
                  path:
                    type: string
                    example: "system/web_server"
                  value:
                    type: object
                    description: Updated configuration section value
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete configuration section (path parameter)
      description: |
        Deletes a specific section of the system configuration at the given path.
        
        **Path Format:**
        - Use dots `.` as separators (e.g., `system.max_running_instances`)
        - Forward slashes `/` with URL encoding (`%2F`) are NOT supported
        
        **Recommended:** Use query parameter instead: `DELETE /v1/core/config?path=system/max_running_instances`
        
        The configuration is saved to the config file after deletion.
      operationId: deleteConfigSection
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: |
            Configuration path using dots as separators.
            Examples: `system.max_running_instances`, `system.web_server`
            Note: Forward slashes are NOT supported in path parameter (use query parameter instead)
          example: "system.max_running_instances"
      responses:
        '200':
          description: Configuration section deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section deleted successfully"
                  path:
                    type: string
                    example: "system/web_server"
        '400':
          description: Invalid request (empty path)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Configuration section not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for config path
      operationId: configPathOptions
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: Configuration path
      responses:
        '200':
          description: CORS preflight response

  /v1/core/models/upload:
    post:
      summary: Upload a model file
      description: Uploads a model file (ONNX, weights, etc.) to the server. The file will be saved in the models directory.
      operationId: uploadModel
      tags:
        - Models
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Model file to upload (.onnx, .weights, .cfg, .pt, .pth, .pb, .tflite)
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: Model file as binary data
      responses:
        '201':
          description: Model file uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  filename:
                    type: string
                  originalFilename:
                    type: string
                  path:
                    type: string
                  size:
                    type: integer
                  url:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: File already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for model upload
      operationId: uploadModelOptions
      tags:
        - Models
      responses:
        '200':
          description: CORS preflight response

  /v1/core/models/list:
    get:
      summary: List uploaded model files
      description: Returns a list of all model files that have been uploaded to the server.
      operationId: listModels
      tags:
        - Models
      responses:
        '200':
          description: List of model files
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  models:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        modified:
                          type: string
                  count:
                    type: integer
                  directory:
                    type: string
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/models/{modelName}:
    delete:
      summary: Delete a model file
      description: Deletes a model file from the server.
      operationId: deleteModel
      tags:
        - Models
      parameters:
        - name: modelName
          in: path
          required: true
          schema:
            type: string
          description: Name of the model file to delete
      responses:
        '200':
          description: Model file deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  filename:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Model file not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instance/status/summary:
    get:
      summary: Get instance status summary
      description: |
        Returns a summary of instance status including total number of configured instances, 
        number of running instances, and number of stopped instances.
      operationId: getStatusSummary
      tags:
        - Instances
      responses:
        '200':
          description: Instance status summary
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
              example:
                total: 5
                configured: 5
                running: 3
                stopped: 2
                timestamp: "2024-01-01T00:00:00.000Z"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for status summary endpoint
      operationId: statusSummaryOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
                example: "*"
            Access-Control-Allow-Methods:
              schema:
                type: string
                example: "GET, OPTIONS"
            Access-Control-Allow-Headers:
              schema:
                type: string
                example: "Content-Type, Authorization"

  /v1/core/instances:
    get:
      summary: List all instances
      description: |
        Returns a list of all AI instances with summary information including running status, solution information, and basic configuration details.
        
        The response includes:
        - Total count of instances
        - Number of running instances
        - Number of stopped instances
        - Summary information for each instance (ID, display name, running status, solution, etc.)
        
        This endpoint is useful for getting an overview of all instances in the system without fetching detailed information for each one.
      operationId: listInstances
      tags:
        - Instances
      responses:
        '200':
          description: List of instances
          content:
            application/json:
              schema:
                type: object
                properties:
                  instances:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstanceSummary'
                  total:
                    type: integer
                    description: Total number of instances
                  running:
                    type: integer
                    description: Number of running instances
                  stopped:
                    type: integer
                    description: Number of stopped instances
              example:
                total: 3
                running: 1
                stopped: 2
                instances:
                  - instanceId: "550e8400-e29b-41d4-a716-446655440000"
                    displayName: "Face Detection Camera 1"
                    running: true
                    solutionId: "face_detection"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for list instances
      operationId: listInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}:
    get:
      summary: Get instance details
      description: |
        Returns detailed information about a specific instance including full configuration, status, and runtime information.
        
        The response includes:
        - Instance configuration (display name, group, solution, etc.)
        - Runtime status (running, loaded, FPS, etc.)
        - Configuration settings (detector mode, sensitivity, frame rate limits, etc.)
        - Input/Output configuration
        - Originator information
        
        The instance must exist. If the instance is not found, a 404 error will be returned.
      operationId: getInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceInfo'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    put:
      summary: Update instance information
      description: |
        Updates configuration of an existing instance. Only provided fields will be updated. Supports two update formats:
        
        **Update Format 1: Field-by-field (camelCase)**
        - Update individual fields like `name`, `group`, `autoStart`, `frameRateLimit`, etc.
        - Use `additionalParams` to update solution-specific parameters (RTSP_URL, MODEL_PATH, etc.)
        
        **Update Format 2: Direct Config (PascalCase)**
        - Update using PascalCase format matching instance config file
        - Can update `Input`, `Output`, `Detector`, `Zone`, etc. directly
        
        **Behavior:**
        - If the instance is currently running, it will be automatically restarted to apply the changes
        - If the instance is not running, changes will take effect when the instance is started
        - The instance must exist and not be read-only
        - Only provided fields will be updated; other fields remain unchanged
      operationId: updateInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateInstanceRequest'
      responses:
        '200':
          description: Instance updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
                        example: "Instance updated successfully"
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    delete:
      summary: Delete an instance
      description: |
        Deletes an instance and stops its pipeline if running. This operation permanently removes the instance from the system.
        
        **Behavior:**
        - If the instance is currently running, it will be stopped first
        - The instance configuration will be removed from memory
        - If the instance is persistent, its configuration file will be deleted from storage
        - All resources associated with the instance will be released
        
        **Prerequisites:**
        - Instance must exist
        - Instance must not be read-only (system instances cannot be deleted)
        
        **Note:** This operation cannot be undone. Once deleted, the instance must be recreated using the create instance endpoint.
      operationId: deleteInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  instanceId:
                    type: string
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instances/{instanceId}/start:
    post:
      summary: Start an instance
      description: |
        Starts the pipeline for an instance. The instance must have a pipeline configured and a valid solution.
        
        **Prerequisites:**
        - Instance must exist
        - Instance must have a valid solution configuration
        - Instance must not be read-only
        - Input source must be properly configured (if required by solution)
        
        **Behavior:**
        - If the instance is already running, the request will succeed without error
        - The pipeline will be built and started based on the instance's solution configuration
        - Processing will begin according to the configured input source and detector settings
        - Returns the updated instance information with `running: true`
        
        **Note:** Starting an instance may take a few seconds as the pipeline is initialized.
      operationId: startInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance started successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
        '400':
          description: Failed to start instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instances/{instanceId}/stop:
    post:
      summary: Stop an instance
      description: |
        Stops the pipeline for an instance, halting all processing and releasing resources.
        
        **Behavior:**
        - If the instance is already stopped, the request will succeed without error
        - The pipeline will be gracefully stopped and all resources will be released
        - Processing will stop immediately
        - Returns the updated instance information with `running: false`
        
        **Note:** Stopping an instance may take a few seconds as the pipeline is cleaned up.
        
        The instance configuration is preserved and can be started again using the start endpoint.
      operationId: stopInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance stopped successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
        '400':
          description: Failed to stop instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instances/{instanceId}/restart:
    post:
      summary: Restart an instance
      description: |
        Restarts an instance by stopping it (if running) and then starting it again. This is useful for applying configuration changes or recovering from errors.
        
        **Behavior:**
        - If the instance is running, it will be stopped first
        - Then the instance will be started again
        - This ensures a clean restart with the current configuration
        - Returns the updated instance information after restart
        
        **Use Cases:**
        - Apply configuration changes that require a restart
        - Recover from errors or unexpected states
        - Refresh the pipeline with updated settings
        
        **Note:** Restarting an instance may take several seconds as the pipeline is stopped and then restarted.
      operationId: restartInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance restarted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
        '400':
          description: Failed to restart instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for restart instance
      operationId: restartInstanceOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/output:
    get:
      summary: Get instance output and processing results
      description: |
        Returns real-time output and processing results for a specific instance at the time of the request.
        This endpoint provides comprehensive information about:
        - Current processing metrics (FPS, frame rate limit)
        - Input source (FILE or RTSP)
        - Output type and details (FILE output files or RTMP stream)
        - Detection settings and processing modes
        - Current status and processing state
        
        For instances with FILE output, it includes file count, total size, latest file information, and activity status.
        For instances with RTMP output, it includes RTMP and RTSP URLs.
      operationId: getInstanceOutput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance output and processing results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceOutputResponse'
              examples:
                fileOutput:
                  summary: Instance with FILE output
                  value:
                    timestamp: "2025-01-15 14:30:25.123"
                    instanceId: "abc-123-def"
                    displayName: "face_detection_file_source"
                    solutionId: "face_detection"
                    solutionName: "Face Detection"
                    running: true
                    loaded: true
                    metrics:
                      fps: 25.50
                      frameRateLimit: 0
                    input:
                      type: "FILE"
                      path: "/path/to/video.mp4"
                    output:
                      type: "FILE"
                      files:
                        exists: true
                        directory: "./output/abc-123-def"
                        fileCount: 15
                        totalSizeBytes: 15728640
                        totalSize: "15 MB"
                        latestFile: "face_detection_20250115_143025.mp4"
                        latestFileTime: "2025-01-15 14:30:25"
                        recentFileCount: 3
                        isActive: true
                    detection:
                      sensitivity: "Low"
                      mode: "SmartDetection"
                      movementSensitivity: "Low"
                      sensorModality: "RGB"
                    modes:
                      statisticsMode: true
                      metadataMode: false
                      debugMode: true
                      diagnosticsMode: false
                    status:
                      running: true
                      processing: true
                      message: "Instance is running and processing frames"
                rtmpOutput:
                  summary: Instance with RTMP output
                  value:
                    timestamp: "2025-01-15 14:30:25.123"
                    instanceId: "xyz-789"
                    displayName: "face_detection_rtmp_stream"
                    solutionId: "face_detection_rtmp"
                    solutionName: "Face Detection RTMP"
                    running: true
                    loaded: true
                    metrics:
                      fps: 30.0
                      frameRateLimit: 25
                    input:
                      type: "FILE"
                      path: "/path/to/video.mp4"
                    output:
                      type: "RTMP_STREAM"
                      rtmpUrl: "rtmp://localhost:1935/live/face_stream"
                      rtspUrl: "rtsp://localhost:8554/live/face_stream_0"
                    detection:
                      sensitivity: "High"
                      mode: "SmartDetection"
                      movementSensitivity: "Low"
                      sensorModality: "RGB"
                    modes:
                      statisticsMode: true
                      metadataMode: true
                      debugMode: false
                      diagnosticsMode: false
                    status:
                      running: true
                      processing: true
                      message: "Instance is running and processing frames"
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get instance output
      operationId: getInstanceOutputOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/frame:
    get:
      summary: Get the last frame
      description: |
        Lấy khung hình cuối cùng có sẵn từ một phiên bản đang chạy.
        Frame được encode thành JPEG base64 format.
      operationId: getLastFrame
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The ID of the running instance
      responses:
        '200':
          description: Successfully retrieved the last frame
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FrameResponse'
              example:
                frame: "/9j/4AAQSkZJRgABAQEAYABgAAD..."
                running: true
        '404':
          description: Instance ID not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get last frame
      operationId: getLastFrameOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/batch/start:
    post:
      summary: Start multiple instances concurrently
      description: |
        Starts multiple instances concurrently for faster batch operations. All operations run in parallel for optimal performance.
        
        **Behavior:**
        - All instances are started in parallel, not sequentially
        - Each instance is started independently
        - Results are returned for each instance (success or failure)
        - Instances that are already running will be marked as successful
        
        **Request Format:**
        - Provide an array of instance IDs in the `instanceIds` field
        - All instance IDs must exist in the system
        
        **Response:**
        - Returns detailed results for each instance
        - Includes total count, success count, and failed count
        - Each result includes the instance ID, success status, running status, and any error messages
        
        **Use Cases:**
        - Start multiple instances after server restart
        - Batch operations for managing multiple cameras or streams
        - Efficiently start a group of related instances
        
        **Note:** Starting multiple instances simultaneously may consume significant system resources. Monitor system performance when starting many instances at once.
      operationId: batchStartInstances
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instanceIds
              properties:
                instanceIds:
                  type: array
                  items:
                    type: string
                  description: Array of instance IDs to start
                  example: ["instance-1", "instance-2", "instance-3"]
      responses:
        '200':
          description: Batch start operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        success:
                          type: boolean
                        status:
                          type: string
                        running:
                          type: boolean
                        error:
                          type: string
                  total:
                    type: integer
                  success:
                    type: integer
                  failed:
                    type: integer
                  message:
                    type: string
              example:
                results:
                  - instanceId: "instance-1"
                    success: true
                    status: "started"
                    running: true
                  - instanceId: "instance-2"
                    success: false
                    status: "failed"
                    error: "Could not start instance. Check if instance exists and has a pipeline."
                total: 2
                success: 1
                failed: 1
                message: "Batch start operation completed"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for batch start
      operationId: batchStartInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/batch/stop:
    post:
      summary: Stop multiple instances concurrently
      description: |
        Stops multiple instances concurrently for faster batch operations. All operations run in parallel for optimal performance.
        
        **Behavior:**
        - All instances are stopped in parallel, not sequentially
        - Each instance is stopped independently
        - Results are returned for each instance (success or failure)
        - Instances that are already stopped will be marked as successful
        
        **Request Format:**
        - Provide an array of instance IDs in the `instanceIds` field
        - All instance IDs must exist in the system
        
        **Response:**
        - Returns detailed results for each instance
        - Includes total count, success count, and failed count
        - Each result includes the instance ID, success status, running status, and any error messages
        
        **Use Cases:**
        - Stop multiple instances for maintenance
        - Batch operations for managing multiple cameras or streams
        - Efficiently stop a group of related instances
        
        **Note:** Stopping multiple instances simultaneously will release system resources. This is useful for managing system load.
      operationId: batchStopInstances
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instanceIds
              properties:
                instanceIds:
                  type: array
                  items:
                    type: string
                  description: Array of instance IDs to stop
                  example: ["instance-1", "instance-2", "instance-3"]
      responses:
        '200':
          description: Batch stop operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        success:
                          type: boolean
                        status:
                          type: string
                        running:
                          type: boolean
                        error:
                          type: string
                  total:
                    type: integer
                  success:
                    type: integer
                  failed:
                    type: integer
                  message:
                    type: string
              example:
                results:
                  - instanceId: "instance-1"
                    success: true
                    status: "stopped"
                    running: false
                  - instanceId: "instance-2"
                    success: false
                    status: "failed"
                    error: "Could not stop instance. Check if instance exists."
                total: 2
                success: 1
                failed: 1
                message: "Batch stop operation completed"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for batch stop
      operationId: batchStopInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/batch/restart:
    post:
      summary: Restart multiple instances concurrently
      description: Restarts multiple instances concurrently by stopping and then starting them. All operations run in parallel for optimal performance.
      operationId: batchRestartInstances
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instanceIds
              properties:
                instanceIds:
                  type: array
                  items:
                    type: string
                  description: Array of instance IDs to restart
                  example: ["instance-1", "instance-2", "instance-3"]
      responses:
        '200':
          description: Batch restart operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        success:
                          type: boolean
                        status:
                          type: string
                        running:
                          type: boolean
                        error:
                          type: string
                  total:
                    type: integer
                  success:
                    type: integer
                  failed:
                    type: integer
                  message:
                    type: string
              example:
                results:
                  - instanceId: "instance-1"
                    success: true
                    status: "restarted"
                    running: true
                  - instanceId: "instance-2"
                    success: false
                    status: "failed"
                    error: "Could not restart instance. Check if instance exists and has a pipeline."
                total: 2
                success: 1
                failed: 1
                message: "Batch restart operation completed"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for batch restart
      operationId: batchRestartInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/groups:
    get:
      summary: List all groups
      description: |
        Returns a list of all groups with summary information including group name, description, instance count, and metadata.
        
        The response includes:
        - Total count of groups
        - Number of default groups
        - Number of custom groups
        - Summary information for each group (ID, name, description, instance count, etc.)
        
        This endpoint is useful for getting an overview of all groups in the system without fetching detailed information for each one.
      operationId: listGroups
      tags:
        - Groups
      responses:
        '200':
          description: List of groups
          content:
            application/json:
              schema:
                type: object
                properties:
                  groups:
                    type: array
                    items:
                      $ref: '#/components/schemas/GroupInfo'
                  total:
                    type: integer
                    description: Total number of groups
                  default:
                    type: integer
                    description: Number of default groups
                  custom:
                    type: integer
                    description: Number of custom groups
              example:
                total: 2
                default: 0
                custom: 2
                groups:
                  - groupId: "cameras"
                    groupName: "Security Cameras"
                    description: "Group for security camera instances"
                    instanceCount: 3
                    isDefault: false
                    readOnly: false
                  - groupId: "test"
                    groupName: "Test Group"
                    description: "Group for testing"
                    instanceCount: 1
                    isDefault: false
                    readOnly: false
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new group
      description: |
        Creates a new group for organizing instances. Groups help organize and manage multiple instances together.
        
        **Group Properties:**
        - **groupId** (required): Unique identifier for the group (alphanumeric, underscores, hyphens only)
        - **groupName** (optional): Display name for the group (defaults to groupId if not provided)
        - **description** (optional): Description of the group's purpose
        
        **Validation:**
        - Group ID must be unique
        - Group ID must match pattern: `^[A-Za-z0-9_-]+$`
        - Group name must match pattern: `^[A-Za-z0-9 -_]+$`
        
        **Persistence:**
        - Groups are automatically saved to storage
        - Group files are stored in `/var/lib/edge_ai_api/groups` (configurable via `GROUPS_DIR` environment variable)
        
        **Returns:** The created group information including timestamps.
      operationId: createGroup
      tags:
        - Groups
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGroupRequest'
            example:
              groupId: "cameras"
              groupName: "Security Cameras"
              description: "Group for security camera instances"
      responses:
        '201':
          description: Group created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupInfo'
        '400':
          description: Bad request (validation failed or group already exists)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for groups
      operationId: listGroupsOptions
      tags:
        - Groups
      responses:
        '200':
          description: CORS preflight response

  /v1/core/groups/{groupId}:
    get:
      summary: Get group details
      description: |
        Returns detailed information about a specific group including group metadata and list of instance IDs.
        
        The response includes:
        - Group configuration (ID, name, description)
        - Group metadata (isDefault, readOnly, timestamps)
        - Instance count
        - List of instance IDs in the group
        
        The group must exist. If the group is not found, a 404 error will be returned.
      operationId: getGroup
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      responses:
        '200':
          description: Group details
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GroupInfo'
                  - type: object
                    properties:
                      instanceIds:
                        type: array
                        items:
                          type: string
                        description: List of instance IDs in this group
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update a group
      description: |
        Updates an existing group's information. Only provided fields will be updated.
        
        **Updateable Fields:**
        - **groupName**: Update the display name of the group
        - **description**: Update the description of the group
        
        **Restrictions:**
        - Group must exist
        - Group must not be read-only
        - Group ID cannot be changed
        
        **Behavior:**
        - Only provided fields will be updated
        - Other fields remain unchanged
        - Updated timestamp is automatically set
      operationId: updateGroup
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGroupRequest'
            example:
              groupName: "Updated Group Name"
              description: "Updated description"
      responses:
        '200':
          description: Group updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupInfo'
        '400':
          description: Bad request (validation failed or group is read-only)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a group
      description: |
        Deletes a group from the system. This operation permanently removes the group.
        
        **Prerequisites:**
        - Group must exist
        - Group must not be a default group
        - Group must not be read-only
        - Group must have no instances (all instances must be removed or moved to other groups first)
        
        **Behavior:**
        - Group configuration will be removed from memory
        - Group file will be deleted from storage
        - All resources associated with the group will be released
        
        **Note:** This operation cannot be undone. Once deleted, the group must be recreated using the create group endpoint.
      operationId: deleteGroup
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      responses:
        '200':
          description: Group deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  groupId:
                    type: string
        '400':
          description: Failed to delete (group has instances, is default, or is read-only)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for group
      operationId: getGroupOptions
      tags:
        - Groups
      responses:
        '200':
          description: CORS preflight response

  /v1/core/groups/{groupId}/instances:
    get:
      summary: Get instances in a group
      description: |
        Returns a list of all instances that belong to a specific group.
        
        The response includes:
        - Group ID
        - List of instances with summary information (ID, display name, solution, running status)
        - Total count of instances in the group
        
        **Use Cases:**
        - View all instances in a specific group
        - Monitor group status and performance
        - Manage instances by group
        
        The group must exist. If the group is not found, a 404 error will be returned.
      operationId: getGroupInstances
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      responses:
        '200':
          description: List of instances in the group
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupId:
                    type: string
                    description: Group ID
                  instances:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        displayName:
                          type: string
                        solutionId:
                          type: string
                        running:
                          type: boolean
                        loaded:
                          type: boolean
                  count:
                    type: integer
                    description: Number of instances in the group
              example:
                groupId: "cameras"
                count: 2
                instances:
                  - instanceId: "abc-123"
                    displayName: "Camera 1"
                    solutionId: "face_detection"
                    running: true
                    loaded: true
                  - instanceId: "def-456"
                    displayName: "Camera 2"
                    solutionId: "face_detection"
                    running: false
                    loaded: true
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for group instances
      operationId: getGroupInstancesOptions
      tags:
        - Groups
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instance:
    post:
      summary: Create a new AI instance
      description: |
        Creates and registers a new AI instance with the specified configuration. Returns the instance ID (UUID) that can be used to control the instance.
        
        **Configuration Options:**
        - **Basic Settings:** name, group, solution, persistent mode
        - **Performance:** frame rate limits, input pixel limits, input orientation
        - **Detection:** detector mode, sensitivity levels, sensor modality
        - **Processing Modes:** metadata mode, statistics mode, diagnostics mode, debug mode
        - **Auto Management:** auto-start, auto-restart, blocking readahead queue
        - **Solution Parameters:** RTSP_URL, MODEL_PATH, FILE_PATH, RTMP_URL, etc. (via additionalParams)
        
        **Solution Types:**
        - `face_detection`: Face detection with RTSP input
        - `face_detection_file`: Face detection with file input
        - `object_detection`: Object detection (YOLO)
        - `face_detection_rtmp`: Face detection with RTMP streaming
        - Custom solutions registered via solution management endpoints
        
        **Persistence:**
        - If `persistent: true`, the instance will be saved to a JSON file in the instances directory
        - Persistent instances are automatically loaded when the server restarts
        - Instance configuration files are stored in `/var/lib/edge_ai_api/instances` (configurable via `INSTANCES_DIR` environment variable)
        
        **Auto Start:**
        - If `autoStart: true`, the instance will automatically start after creation
        - The pipeline will be built and started immediately
        
        **Returns:** The created instance information including the generated UUID that can be used for subsequent operations.
      operationId: createInstance
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateInstanceRequest'
            example:
              name: "Face Detection Camera 1"
              group: "cameras"
              solution: "face_detection"
              persistent: true
              frameRateLimit: 30
              metadataMode: true
              statisticsMode: true
              diagnosticsMode: false
              debugMode: false
              detectorMode: "SmartDetection"
              detectionSensitivity: "Medium"
              movementSensitivity: "Low"
              sensorModality: "RGB"
              autoStart: true
              autoRestart: false
              blockingReadaheadQueue: false
              inputOrientation: 0
              inputPixelLimit: 1920
              RTSP_URL: "rtsp://localhost:8554/stream"
              MODEL_NAME: "yunet_2023mar"
      responses:
        '201':
          description: Instance created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceInfo'
              example:
                instanceId: "550e8400-e29b-41d4-a716-446655440000"
                displayName: "Face Detection Camera 1"
                group: "cameras"
                solutionId: "face_detection"
                solutionName: "Face Detection"
                persistent: true
                loaded: true
                running: true
                fps: 0.0
                version: "2025.0.1.2"
                frameRateLimit: 30
                metadataMode: true
                statisticsMode: true
                diagnosticsMode: false
                debugMode: false
                readOnly: false
                autoStart: true
                autoRestart: false
                systemInstance: false
                inputPixelLimit: 1920
                inputOrientation: 0
                detectorMode: "SmartDetection"
                detectionSensitivity: "Medium"
                movementSensitivity: "Low"
                sensorModality: "RGB"
                originator:
                  address: ""
        '400':
          description: Bad request (validation failed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for create instance
      operationId: createInstanceOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instance/{instanceId}/input:
    post:
      summary: Set input source for an instance
      description: |
        Sets the input source configuration for an instance. Replaces the Input field in the Instance File according to the request.
        
        **Input Types:**
        - **RTSP**: Uses `rtsp_src` node for RTSP streams
        - **HLS**: Uses `hls_src` node for HLS streams
        - **Manual**: Uses `v4l2_src` node for V4L2 devices
        
        The instance must exist and not be read-only. If the instance is currently running, it will be automatically restarted to apply the changes.
      operationId: setInstanceInput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier of the instance (UUID)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetInputRequest'
            example:
              type: "Manual"
              uri: "http://example.com"
      responses:
        '204':
          description: Input settings updated successfully
        '400':
          description: Bad request (invalid input or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for set input
      operationId: setInstanceInputOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instance/{instanceId}/config:
    get:
      summary: Get instance configuration
      description: |
        Returns the configuration of an instance. This endpoint provides the configuration settings of the instance, which are different from runtime state. Configuration includes settings like AutoRestart, AutoStart, Detector settings, Input configuration, etc.
        
        **Note:** This returns the configuration format, not the runtime state. For runtime state information, use the instance details endpoint.
      operationId: getConfig
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier of the instance (UUID)
          example: "291a85b8-d4c0-5765-dcb2-48c9b51f48d0"
      responses:
        '200':
          description: Instance configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceConfig'
              example:
                AutoRestart: false
                AutoStart: false
                Detector:
                  preset_values:
                    MosaicInference:
                      Detector/conf_threshold: 0.7
                DetectorRegions: {}
                DisplayName: "Test Instance"
                Input:
                  match_fps: true
                  media_format:
                    color_format: 0
                    default_format: true
                    height: 0
                    is_software: false
                    name: "Same as Source"
                  media_type: "Images"
                  output_fps: 8
                  uri: "https://some_uri"
                InstanceId: "291a85b8-d4c0-5765-dcb2-48c9b51f48d0"
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Set config value at a specific path
      description: |
        Sets a configuration value at the specified path. The path is a key in the configuration, and for nested structures, it will be nested keys separated by forward slashes "/".
        
        **Note:** This operation will overwrite the value at the given path.
        
        **Path Examples:**
        - Simple path: `"DisplayName"` - Sets top-level DisplayName
        - Nested path: `"Output/handlers/Mqtt"` - Sets Mqtt handler in Output.handlers
        
        **jsonValue Format:**
        - For string values: `"\"my string\""` (escaped JSON string)
        - For object values: `"{\"key\":\"value\"}"` (escaped JSON object)
        
        The instance must exist and not be read-only. If the instance is currently running, it will be automatically restarted to apply the changes.
      operationId: setConfig
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier of the instance (UUID)
          example: "instanceId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetConfigRequest'
            examples:
              stringValue:
                summary: Set string value
                value:
                  path: "my/nested/path"
                  jsonValue: "\"my string\""
              objectValue:
                summary: Set object value
                value:
                  path: "Output/handlers/Mqtt"
                  jsonValue: "{\"uri\":\"mqtt://example.com:1883/events\"}"
      responses:
        '204':
          description: Config value set successfully
        '400':
          description: Bad request (invalid input or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for set config
      operationId: setConfigOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instance/{instanceId}/statistics:
    get:
      summary: Get instance statistics
      description: |
        Returns current real-time statistics for the instance. Statistics include frames processed, framerate, latency, and resolution.
        
        **Note:** Statistics reset to 0 when instance restarts. Statistics are calculated in real-time and are not persisted to storage.
        
        **Statistics Fields:**
        - `frames_processed`: Total number of frames processed since instance started
        - `source_framerate`: FPS from source (e.g., RTSP stream or video file)
        - `current_framerate`: Current processing FPS
        - `latency`: Average processing latency per frame in milliseconds
        - `start_time`: Instance start time (Unix timestamp in seconds)
        - `resolution`: Current processing resolution (e.g., "1280x720")
        - `format`: Frame format (e.g., "BGR")
        - `source_resolution`: Source resolution (e.g., "1920x1080")
        
        The instance must exist and be running. If the instance is not found or not running, a 404 error will be returned.
      operationId: getInstanceStatistics
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier for the instance
          example: "instanceId"
      responses:
        '200':
          description: Statistics information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceStatistics'
              example:
                frames_processed: 625
                source_framerate: 25
                current_framerate: 25
                latency: 40
                start_time: 1765377504
                resolution: "1280x720"
                format: "BGR"
                source_resolution: "1280x720"
        '404':
          description: Instance not found or not running
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/instance/{instanceId}/output/stream:
    get:
      summary: Get stream output configuration
      description: |
        Returns the current stream output configuration for an instance. This endpoint retrieves the stream output settings including whether it is enabled and the configured URI.
        
        **Response Format:**
        - `enabled`: Boolean indicating whether stream output is enabled
        - `uri`: The configured stream URI (empty string if disabled)
        
        The URI can be in one of the following formats:
        - **RTMP**: `rtmp://host:port/path/stream_key`
        - **RTSP**: `rtsp://host:port/path/stream_key`
        - **HLS**: `hls://host:port/path/stream_key`
      operationId: getStreamOutput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier for the instance
          example: "instanceId"
      responses:
        '200':
          description: Stream output configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StreamOutputResponse'
              examples:
                enabled:
                  summary: Stream output enabled
                  value:
                    enabled: true
                    uri: "rtmp://localhost:1935/live/stream"
                disabled:
                  summary: Stream output disabled
                  value:
                    enabled: false
                    uri: ""
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Configure stream output
      description: |
        Configures stream output for an instance. This endpoint allows you to enable or disable stream output and set the URI for the stream.
        
        **Supported Stream Types:**
        - **RTMP**: `rtmp://host:port/path/stream_key` - For RTMP streaming (e.g., to MediaMTX, YouTube Live, etc.)
        - **RTSP**: `rtsp://host:port/path/stream_key` - For RTSP streaming
        - **HLS**: `hls://host:port/path/stream_key` - For HLS streaming
        
        **Behavior:**
        - When `enabled` is `true`, the `uri` field is required and must be a valid stream URI
        - When `enabled` is `false`, stream output is disabled (URI is not required)
        - If the instance is currently running, it will be automatically restarted to apply the changes
        - The stream output uses the `rtmp_des_node` in the pipeline
        
        **MediaMTX Setup:**
        - For local streaming, ensure MediaMTX is installed and running: https://github.com/bluenviron/mediamtx
        - Default MediaMTX RTMP endpoint: `rtmp://localhost:1935/live/stream`
        - Default MediaMTX RTSP endpoint: `rtsp://localhost:8554/live/stream"
      operationId: configureStreamOutput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigureStreamOutputRequest'
            examples:
              enableLocalRTMP:
                summary: Enable local RTMP stream
                value:
                  enabled: true
                  uri: "rtmp://localhost:1935/live/stream"
              enableRemoteRTMP:
                summary: Enable remote RTMP stream
                value:
                  enabled: true
                  uri: "rtmp://localhost:1935/live/stream"
              disableStream:
                summary: Disable stream output
                value:
                  enabled: false
      responses:
        '204':
          description: Successfully configured stream output
        '400':
          description: Bad request (invalid input or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for stream output endpoints
      operationId: streamOutputOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/solutions:
    get:
      summary: List all solutions
      description: Returns a list of all available solutions with summary information including solution type and pipeline node count.
      operationId: listSolutions
      tags:
        - Solutions
      responses:
        '200':
          description: List of solutions
          content:
            application/json:
              schema:
                type: object
                properties:
                  solutions:
                    type: array
                    items:
                      $ref: '#/components/schemas/SolutionSummary'
                  total:
                    type: integer
                    description: Total number of solutions
                  default:
                    type: integer
                    description: Number of default solutions
                  custom:
                    type: integer
                    description: Number of custom solutions
              example:
                total: 2
                default: 1
                custom: 1
                solutions:
                  - solutionId: "face_detection"
                    solutionName: "Face Detection"
                    solutionType: "face_detection"
                    isDefault: true
                    pipelineNodeCount: 3
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new solution
      description: Creates a new custom solution configuration. Custom solutions can be modified and deleted, unlike default solutions.
      operationId: createSolution
      tags:
        - Solutions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSolutionRequest'
            example:
              solutionId: "custom_face_detection"
              solutionName: "Custom Face Detection"
              solutionType: "face_detection"
              pipeline:
                - nodeType: "rtsp_src"
                  nodeName: "source_{instanceId}"
                  parameters:
                    url: "rtsp://example.com/stream"
                - nodeType: "yunet_face_detector"
                  nodeName: "detector_{instanceId}"
                  parameters:
                    model_path: "models/face/yunet.onnx"
                - nodeType: "file_des"
                  nodeName: "output_{instanceId}"
                  parameters:
                    output_path: "/tmp/output"
              defaults:
                RTSP_URL: "rtsp://example.com/stream"
      responses:
        '201':
          description: Solution created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SolutionConfig'
        '400':
          description: Bad request (validation failed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Solution already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for solutions
      operationId: listSolutionsOptions
      tags:
        - Solutions
      responses:
        '200':
          description: CORS preflight response

  /v1/core/solutions/{solutionId}:
    get:
      summary: Get solution details
      description: Returns detailed information about a specific solution including full pipeline configuration.
      operationId: getSolution
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      responses:
        '200':
          description: Solution details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SolutionConfig'
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update a solution
      description: Updates an existing custom solution configuration. Default solutions cannot be updated.
      operationId: updateSolution
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSolutionRequest'
      responses:
        '200':
          description: Solution updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SolutionConfig'
        '400':
          description: Bad request (validation failed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Cannot update default solution
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a solution
      description: Deletes a custom solution. Default solutions cannot be deleted.
      operationId: deleteSolution
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      responses:
        '200':
          description: Solution deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  solutionId:
                    type: string
        '403':
          description: Cannot delete default solution
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for solution
      operationId: getSolutionOptions
      tags:
        - Solutions
      responses:
        '200':
          description: CORS preflight response

  /v1/core/logs:
    get:
      summary: List all log files by category
      description: Returns a list of all log files organized by category (api, instance, sdk_output, general)
      operationId: listLogFiles
      tags:
        - Logs
      responses:
        '200':
          description: List of log files by category
          content:
            application/json:
              schema:
                type: object
                properties:
                  categories:
                    type: object
                    additionalProperties:
                      type: array
                      items:
                        $ref: '#/components/schemas/LogFileInfo'
              example:
                categories:
                  api:
                    - date: "2025-01-15"
                      size: 1048576
                      path: "/var/lib/edge_ai_api/logs/api/2025-01-15.log"
                  instance:
                    - date: "2025-01-15"
                      size: 2048576
                      path: "/var/lib/edge_ai_api/logs/instance/2025-01-15.log"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for logs
      operationId: listLogFilesOptions
      tags:
        - Logs
      responses:
        '200':
          description: CORS preflight response

  /v1/core/logs/{category}:
    get:
      summary: Get logs by category
      description: Returns logs from a specific category with optional filtering by level, time range, and tail
      operationId: getLogsByCategory
      tags:
        - Logs
      parameters:
        - name: category
          in: path
          required: true
          schema:
            type: string
            enum: [api, instance, sdk_output, general]
          description: Log category
        - name: level
          in: query
          required: false
          schema:
            type: string
            enum: [INFO, WARNING, ERROR, FATAL, DEBUG, VERBOSE]
          description: Filter by log level (case-insensitive)
        - name: from
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs from this timestamp (ISO 8601)
        - name: to
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs to this timestamp (ISO 8601)
        - name: tail
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
          description: Get last N lines from the latest log file
      responses:
        '200':
          description: Logs from the specified category
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogsResponse'
        '400':
          description: Bad request (invalid category or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for logs by category
      operationId: getLogsByCategoryOptions
      tags:
        - Logs
      responses:
        '200':
          description: CORS preflight response

  /v1/core/logs/{category}/{date}:
    get:
      summary: Get logs by category and date
      description: Returns logs from a specific category and date with optional filtering by level, time range, and tail
      operationId: getLogsByCategoryAndDate
      tags:
        - Logs
      parameters:
        - name: category
          in: path
          required: true
          schema:
            type: string
            enum: [api, instance, sdk_output, general]
          description: Log category
        - name: date
          in: path
          required: true
          schema:
            type: string
            pattern: '^\d{4}-\d{2}-\d{2}$'
          description: Date in YYYY-MM-DD format
        - name: level
          in: query
          required: false
          schema:
            type: string
            enum: [INFO, WARNING, ERROR, FATAL, DEBUG, VERBOSE]
          description: Filter by log level (case-insensitive)
        - name: from
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs from this timestamp (ISO 8601)
        - name: to
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs to this timestamp (ISO 8601)
        - name: tail
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
          description: Get last N lines from the log file
      responses:
        '200':
          description: Logs from the specified category and date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogsResponse'
        '400':
          description: Bad request (invalid category, date format, or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Log file not found for the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for logs by category and date
      operationId: getLogsByCategoryAndDateOptions
      tags:
        - Logs
      responses:
        '200':
          description: CORS preflight response

components:
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
        - uptime
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
          description: Health status of the service
          example: "healthy"
        timestamp:
          type: string
          format: date-time
          description: Current timestamp in ISO 8601 format
          example: "2024-01-01T00:00:00.000Z"
        uptime:
          type: integer
          format: int64
          description: Service uptime in seconds
          example: 3600
        service:
          type: string
          description: Service name
          example: "edge_ai_api"
        version:
          type: string
          description: Service version
          example: "2025.0.1.1"

    StatusResponse:
      type: object
      required:
        - total
        - configured
        - running
        - stopped
        - timestamp
      properties:
        total:
          type: integer
          description: Total number of configured instances
          example: 5
        configured:
          type: integer
          description: Number of configured instances (same as total)
          example: 5
        running:
          type: integer
          description: Number of instances currently running
          example: 3
        stopped:
          type: integer
          description: Number of instances currently stopped
          example: 2
        timestamp:
          type: string
          format: date-time
          description: Current timestamp in ISO 8601 format
          example: "2024-01-01T00:00:00.000Z"

    VersionResponse:
      type: object
      required:
        - version
        - api_version
        - service
      properties:
        version:
          type: string
          description: Application version
          example: "2025.0.1.1"
        build_time:
          type: string
          description: Build timestamp
          example: "Jan 01 2024 00:00:00"
        git_commit:
          type: string
          description: Git commit hash
          example: "abc123def456"
        api_version:
          type: string
          description: API version
          example: "v1"
        service:
          type: string
          description: Service name
          example: "edge_ai_api"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
        code:
          type: integer
          description: Error code
        message:
          type: string
          description: Detailed error message

    LogFileInfo:
      type: object
      properties:
        date:
          type: string
          pattern: '^\d{4}-\d{2}-\d{2}$'
          description: Date in YYYY-MM-DD format
          example: "2025-01-15"
        size:
          type: integer
          format: int64
          description: File size in bytes
          example: 1048576
        path:
          type: string
          description: Full path to the log file
          example: "/var/lib/edge_ai_api/logs/api/2025-01-15.log"

    LogEntry:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
          description: Log entry timestamp in ISO 8601 format
          example: "2025-01-15T10:30:45.123Z"
        level:
          type: string
          enum: [INFO, WARNING, ERROR, FATAL, DEBUG, VERBOSE]
          description: Log level
          example: "INFO"
        message:
          type: string
          description: Log message
          example: "This is a log message"

    LogsResponse:
      type: object
      properties:
        category:
          type: string
          enum: [api, instance, sdk_output, general]
          description: Log category
          example: "api"
        date:
          type: string
          pattern: '^\d{4}-\d{2}-\d{2}$'
          description: Date in YYYY-MM-DD format (only present when date is specified in path)
          example: "2025-01-15"
        total_lines:
          type: integer
          description: Total number of log lines before filtering
          example: 1000
        filtered_lines:
          type: integer
          description: Number of log lines after filtering
          example: 50
        logs:
          type: array
          items:
            $ref: '#/components/schemas/LogEntry'
          description: Array of log entries

    SetInputRequest:
      type: object
      required:
        - type
        - uri
      properties:
        type:
          type: string
          description: Type of input source
          enum: [RTSP, HLS, Manual]
          example: "Manual"
        uri:
          type: string
          format: uri
          description: URI of the input source (must be valid)
          example: "http://example.com"

    InstanceConfig:
      type: object
      description: Instance configuration (config format, not runtime state)
      properties:
        InstanceId:
          type: string
          description: Unique identifier of the instance (UUID)
          example: "291a85b8-d4c0-5765-dcb2-48c9b51f48d0"
        DisplayName:
          type: string
          description: Display name of the instance
          example: "Test Instance"
        AutoStart:
          type: boolean
          description: Whether the instance should automatically start on system boot
          example: false
        AutoRestart:
          type: boolean
          description: Whether the instance should automatically restart on failure
          example: false
        Detector:
          type: object
          description: Detector configuration
          properties:
            preset_values:
              type: object
              description: Preset values for different detector modes
              additionalProperties:
                type: object
          example:
            preset_values:
              MosaicInference:
                Detector/conf_threshold: 0.7
        DetectorRegions:
          type: object
          description: Detector regions configuration
          additionalProperties: true
        Input:
          type: object
          description: Input source configuration
          properties:
            match_fps:
              type: boolean
              description: Whether to match FPS
            media_format:
              type: object
              properties:
                color_format:
                  type: integer
                default_format:
                  type: boolean
                height:
                  type: integer
                is_software:
                  type: boolean
                name:
                  type: string
            media_type:
              type: string
              description: Type of media input (e.g., "Images", "IP Camera", "File")
            output_fps:
              type: integer
              description: Output FPS
            uri:
              type: string
              description: URI of the input source
          example:
            match_fps: true
            media_format:
              color_format: 0
              default_format: true
              height: 0
              is_software: false
              name: "Same as Source"
            media_type: "Images"
            output_fps: 8
            uri: "https://some_uri"
      required:
        - InstanceId

    SetConfigRequest:
      type: object
      required:
        - path
        - jsonValue
      properties:
        path:
          type: string
          description: |
            The key for which the config value is to be updated. For nested structures, use forward slashes "/" as separators.
            Examples: "DisplayName", "Output/handlers/Mqtt", "Detector/conf_threshold"
          example: "Output/handlers/Mqtt"
        jsonValue:
          type: string
          description: |
            A string containing a JSON value or object. Ensure proper escaping for strings or objects.
            - For string values: "\"my string\"" (escaped JSON string)
            - For object values: "{\"key\":\"value\"}" (escaped JSON object)
          example: "{\"uri\":\"mqtt://example.com:1883/events\"}"

    ConfigureStreamOutputRequest:
      type: object
      required:
        - enabled
      properties:
        enabled:
          type: boolean
          description: Indicates whether stream output is enabled
          example: true
        uri:
          type: string
          format: uri
          description: |
            The requested URI for the stream output. Required when enabled is true.
            Must start with rtmp://, rtsp://, or hls://
          example: "rtmp://localhost:1935/live/stream"

    StreamOutputResponse:
      type: object
      required:
        - enabled
        - uri
      properties:
        enabled:
          type: boolean
          description: Indicates whether stream output is enabled
          example: true
        uri:
          type: string
          format: uri
          description: |
            The configured URI for the stream output. Empty string if disabled.
            Can be rtmp://, rtsp://, or hls:// format
          example: "rtmp://localhost:1935/live/stream"

    SystemInfoResponse:
      type: object
      description: System hardware information
      properties:
        cpu:
          type: object
          properties:
            vendor:
              type: string
              example: "GenuineIntel"
            model:
              type: string
              example: "Intel(R) Core(TM) i7-10700K CPU @ 3.80GHz"
            physical_cores:
              type: integer
              example: 8
            logical_cores:
              type: integer
              example: 16
            max_frequency:
              type: integer
              description: Maximum frequency in MHz
              example: 3792
            regular_frequency:
              type: integer
              description: Regular frequency in MHz
              example: 3792
            min_frequency:
              type: integer
              description: Minimum frequency in MHz (-1 if not available)
              example: -1
            current_frequency:
              type: integer
              description: Current frequency in MHz (-1 if not available)
              example: 3792
            cache_size:
              type: integer
              format: int64
              description: Cache size in bytes
              example: 16777216
        ram:
          type: object
          properties:
            vendor:
              type: string
              example: "Corsair"
            model:
              type: string
              example: "CMK32GX4M2Z3600C18"
            name:
              type: string
              example: "Physical Memory"
            serial_number:
              type: string
              example: "N/A"
            size_mib:
              type: integer
              format: int64
              description: Total size in MiB
              example: 65437
            free_mib:
              type: integer
              format: int64
              description: Free memory in MiB
              example: 54405
            available_mib:
              type: integer
              format: int64
              description: Available memory in MiB
              example: 54405
        gpu:
          type: array
          items:
            type: object
            properties:
              vendor:
                type: string
                example: "NVIDIA"
              model:
                type: string
                example: "NVIDIA GeForce RTX 3070 Ti"
              driver_version:
                type: string
                example: "31.0.15.2698"
              memory_mib:
                type: integer
                format: int64
                description: Memory size in MiB
                example: 8190
              min_frequency:
                type: integer
                example: -1
              current_frequency:
                type: integer
                description: Current frequency in MHz
                example: 0
              max_frequency:
                type: integer
                example: -1
        disk:
          type: array
          items:
            type: object
            properties:
              vendor:
                type: string
                example: "(Standard disk drives)"
              model:
                type: string
                example: "WD_BLACK SN850 Heatsink 1TB"
              serial_number:
                type: string
                example: "***"
              size_bytes:
                type: integer
                format: int64
                description: Total size in bytes
                example: 1000202273280
              free_size_bytes:
                type: integer
                format: int64
                description: Free size in bytes
                example: 500000000000
              volumes:
                type: array
                items:
                  type: string
                description: List of volume/partition names
        mainboard:
          type: object
          properties:
            vendor:
              type: string
              example: "ASUSTeK COMPUTER INC."
            name:
              type: string
              example: "PRIME Z490-A"
            version:
              type: string
              example: "Rev 1.xx"
            serial_number:
              type: string
              example: "N/A"
        os:
          type: object
          properties:
            name:
              type: string
              example: "Ubuntu 22.04 LTS"
            short_name:
              type: string
              example: "Linux"
            version:
              type: string
              example: "22.04"
            kernel:
              type: string
              example: "5.15.0-72-generic"
            architecture:
              type: string
              example: "64 bit"
            endianess:
              type: string
              example: "little endian"
        battery:
          type: array
          description: Battery information (empty array if no batteries)
          items:
            type: object
            properties:
              vendor:
                type: string
              model:
                type: string
              serial_number:
                type: string
              technology:
                type: string
              capacity_mwh:
                type: integer
                format: int64
                description: Capacity in mWh
              charging:
                type: boolean
                description: Whether battery is charging

    SystemStatusResponse:
      type: object
      description: Current system status
      properties:
        cpu:
          type: object
          properties:
            usage_percent:
              type: number
              format: double
              description: CPU usage percentage (0-100)
              example: 25.5
            current_frequency_mhz:
              type: integer
              description: Current CPU frequency in MHz (-1 if not available)
              example: 3792
            temperature_celsius:
              type: number
              format: double
              description: CPU temperature in Celsius (optional, -1 if not available)
              example: 45.5
        ram:
          type: object
          properties:
            total_mib:
              type: integer
              format: int64
              description: Total RAM in MiB
              example: 65437
            used_mib:
              type: integer
              format: int64
              description: Used RAM in MiB
              example: 11032
            free_mib:
              type: integer
              format: int64
              description: Free RAM in MiB
              example: 54405
            available_mib:
              type: integer
              format: int64
              description: Available RAM in MiB
              example: 54405
            usage_percent:
              type: number
              format: double
              description: RAM usage percentage (0-100)
              example: 16.85
            cached_mib:
              type: integer
              format: int64
              description: Cached memory in MiB (optional)
              example: 5000
            buffers_mib:
              type: integer
              format: int64
              description: Buffers memory in MiB (optional)
              example: 1000
        load_average:
          type: object
          properties:
            "1min":
              type: number
              format: double
              description: Load average for 1 minute
              example: 0.75
            "5min":
              type: number
              format: double
              description: Load average for 5 minutes
              example: 0.82
            "15min":
              type: number
              format: double
              description: Load average for 15 minutes
              example: 0.88
        uptime_seconds:
          type: integer
          format: int64
          description: System uptime in seconds
          example: 86400

    CreateInstanceRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          description: "Instance name (required, pattern: ^[A-Za-z0-9 -_]+$)"
          example: "Face Detection Camera 1"
        group:
          type: string
          description: "Group name (optional, pattern: ^[A-Za-z0-9 -_]+$)"
          example: "cameras"
        solution:
          type: string
          description: Solution ID (optional, must match existing solution)
          example: "face_detection"
        persistent:
          type: boolean
          description: Save instance to JSON file
          default: false
        frameRateLimit:
          type: integer
          description: Frame rate limit (FPS)
          default: 0
          minimum: 0
        metadataMode:
          type: boolean
          description: Enable metadata mode
          default: false
        statisticsMode:
          type: boolean
          description: Enable statistics mode
          default: false
        diagnosticsMode:
          type: boolean
          description: Enable diagnostics mode
          default: false
        debugMode:
          type: boolean
          description: Enable debug mode
          default: false
        detectorMode:
          type: string
          description: Detector mode
          enum: [SmartDetection]
          default: "SmartDetection"
        detectionSensitivity:
          type: string
          description: Detection sensitivity level
          enum: [Low, Medium, High]
          default: "Low"
        movementSensitivity:
          type: string
          description: Movement sensitivity level
          enum: [Low, Medium, High]
          default: "Low"
        sensorModality:
          type: string
          description: Sensor modality
          enum: [RGB, Thermal]
          default: "RGB"
        autoStart:
          type: boolean
          description: Automatically start instance when created
          default: false
        autoRestart:
          type: boolean
          description: Automatically restart instance on error
          default: false
        blockingReadaheadQueue:
          type: boolean
          description: Use blocking readahead queue
          default: false
        inputOrientation:
          type: integer
          description: Input orientation (0-3)
          default: 0
          minimum: 0
          maximum: 3
        inputPixelLimit:
          type: integer
          description: Input pixel limit
          default: 0
          minimum: 0
        RTSP_URL:
          type: string
          description: RTSP URL for source (required for face_detection solution)
          example: "rtsp://localhost:8554/stream"
        MODEL_NAME:
          type: string
          description: |
            Model name to use (e.g., "yunet_2023mar", "yunet_2022mar", "yolov8n_face").
            Can specify category with format "category:modelname" (e.g., "face:yunet_2023mar").
            The system will automatically search for matching model files in system directories.
            Takes priority over MODEL_PATH if both are provided.
          example: "yunet_2023mar"
        MODEL_PATH:
          type: string
          description: |
            Direct path to model file (e.g., "./models/yunet.onnx", "/usr/share/cvedix/cvedix_data/models/face/yunet.onnx").
            Used if MODEL_NAME is not provided or not found.
          example: "./models/yunet.onnx"
        additionalParams:
          type: object
          description: |
            Additional solution-specific parameters. Supported keys:
            - RTSP_URL: RTSP stream URL
            - MODEL_NAME: Model name (e.g., "yunet_2023mar", "face:yunet_2023mar")
            - MODEL_PATH: Direct path to model file
          additionalProperties:
            type: string

    UpdateInstanceRequest:
      type: object
      description: Request body for updating an instance. All fields are optional - only provided fields will be updated.
      properties:
        name:
          type: string
          description: "Instance name (pattern: ^[A-Za-z0-9 -_]+$)"
          example: "Face Detection Camera 1"
        group:
          type: string
          description: "Group name (pattern: ^[A-Za-z0-9 -_]+$)"
          example: "cameras"
        persistent:
          type: boolean
          description: Save instance to JSON file
        frameRateLimit:
          type: integer
          description: Frame rate limit (FPS)
          minimum: 0
        metadataMode:
          type: boolean
          description: Enable metadata mode
        statisticsMode:
          type: boolean
          description: Enable statistics mode
        diagnosticsMode:
          type: boolean
          description: Enable diagnostics mode
        debugMode:
          type: boolean
          description: Enable debug mode
        detectorMode:
          type: string
          description: Detector mode
          enum: [SmartDetection]
        detectionSensitivity:
          type: string
          description: Detection sensitivity level
          enum: [Low, Medium, High]
        movementSensitivity:
          type: string
          description: Movement sensitivity level
          enum: [Low, Medium, High]
        sensorModality:
          type: string
          description: Sensor modality
          enum: [RGB, Thermal]
        autoStart:
          type: boolean
          description: Automatically start instance when created
        autoRestart:
          type: boolean
          description: Automatically restart instance on error
        inputOrientation:
          type: integer
          description: Input orientation (0-3)
          minimum: 0
          maximum: 3
        inputPixelLimit:
          type: integer
          description: Input pixel limit
          minimum: 0
        RTSP_URL:
          type: string
          description: RTSP URL for source
          example: "rtsp://localhost:8554/stream"
        MODEL_NAME:
          type: string
          description: Model name to use
          example: "yunet_2023mar"
        MODEL_PATH:
          type: string
          description: Direct path to model file
          example: "./models/yunet.onnx"
        FILE_PATH:
          type: string
          description: File path for file source
          example: "/path/to/video.mp4"
        RTMP_URL:
          type: string
          description: RTMP URL for streaming destination
          example: "rtmp://localhost:1935/live/stream"
        SFACE_MODEL_PATH:
          type: string
          description: Path to SFace encoder model
        SFACE_MODEL_NAME:
          type: string
          description: Name of SFace encoder model
        additionalParams:
          type: object
          description: Additional solution-specific parameters
          additionalProperties:
            type: string

    InstanceSummary:
      type: object
      properties:
        instanceId:
          type: string
          description: Unique instance identifier (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        displayName:
          type: string
          description: Display name of the instance
          example: "Face Detection Camera 1"
        group:
          type: string
          description: Group name
          example: "cameras"
        solutionId:
          type: string
          description: Solution ID
          example: "face_detection"
        solutionName:
          type: string
          description: Solution name
          example: "Face Detection"
        running:
          type: boolean
          description: Whether instance pipeline is running
        loaded:
          type: boolean
          description: Whether instance is loaded
        persistent:
          type: boolean
          description: Whether instance is persisted to storage
        fps:
          type: number
          format: double
          description: Current frames per second

    InstanceInfo:
      type: object
      required:
        - instanceId
        - displayName
      properties:
        instanceId:
          type: string
          description: Unique instance identifier (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        displayName:
          type: string
          description: Display name of the instance
          example: "Face Detection Camera 1"
        group:
          type: string
          description: Group name
          example: "cameras"
        solutionId:
          type: string
          description: Solution ID
          example: "face_detection"
        solutionName:
          type: string
          description: Solution name
          example: "Face Detection"
        persistent:
          type: boolean
          description: Whether instance is persisted to storage
        loaded:
          type: boolean
          description: Whether instance is loaded
        running:
          type: boolean
          description: Whether instance pipeline is running
        fps:
          type: number
          format: double
          description: Current frames per second
        version:
          type: string
          description: CVEDIX SDK version
        frameRateLimit:
          type: integer
          description: Frame rate limit
        metadataMode:
          type: boolean
          description: Metadata mode enabled
        statisticsMode:
          type: boolean
          description: Statistics mode enabled
        diagnosticsMode:
          type: boolean
          description: Diagnostics mode enabled
        debugMode:
          type: boolean
          description: Debug mode enabled
        readOnly:
          type: boolean
          description: Read-only flag
        autoStart:
          type: boolean
          description: Auto-start enabled
        autoRestart:
          type: boolean
          description: Auto-restart enabled
        systemInstance:
          type: boolean
          description: System instance flag
        inputPixelLimit:
          type: integer
          description: Input pixel limit
        inputOrientation:
          type: integer
          description: Input orientation
        detectorMode:
          type: string
          description: Detector mode
        detectionSensitivity:
          type: string
          description: Detection sensitivity
        movementSensitivity:
          type: string
          description: Movement sensitivity
        sensorModality:
          type: string
          description: Sensor modality
        originator:
          type: object
          properties:
            address:
              type: string
              description: Originator address

    InstanceStatistics:
      type: object
      description: Real-time statistics for an instance
      properties:
        frames_processed:
          type: integer
          format: int64
          description: Total number of frames processed since instance started
          example: 625
        source_framerate:
          type: number
          format: double
          description: Source framerate (FPS from source stream or file)
          example: 25
        current_framerate:
          type: number
          format: double
          description: Current processing framerate (FPS)
          example: 25
        latency:
          type: number
          format: double
          description: Average processing latency per frame in milliseconds
          example: 40
        start_time:
          type: integer
          format: int64
          description: Instance start time (Unix timestamp in seconds)
          example: 1765377504
        resolution:
          type: string
          description: Current processing resolution (e.g., "1280x720")
          example: "1280x720"
        format:
          type: string
          description: Frame format (e.g., "BGR")
          example: "BGR"
        source_resolution:
          type: string
          description: Source resolution (e.g., "1920x1080")
          example: "1280x720"

    InstanceOutputResponse:
      type: object
      description: Real-time output and processing results for an instance
      required:
        - timestamp
        - instanceId
        - displayName
        - running
        - loaded
        - metrics
        - input
        - output
        - status
      properties:
        timestamp:
          type: string
          description: Timestamp when the output information was retrieved (real-time)
          example: "2025-01-15 14:30:25.123"
        instanceId:
          type: string
          description: Unique instance identifier (UUID)
          example: "abc-123-def"
        displayName:
          type: string
          description: Display name of the instance
          example: "face_detection_file_source"
        solutionId:
          type: string
          description: Solution ID
          example: "face_detection"
        solutionName:
          type: string
          description: Solution name
          example: "Face Detection"
        running:
          type: boolean
          description: Whether instance pipeline is running
          example: true
        loaded:
          type: boolean
          description: Whether instance is loaded
          example: true
        metrics:
          type: object
          description: Processing metrics
          required:
            - fps
          properties:
            fps:
              type: number
              format: double
              description: Current frames per second
              example: 25.50
            frameRateLimit:
              type: integer
              description: Frame rate limit (0 = no limit)
              example: 0
        input:
          type: object
          description: Input source information
          required:
            - type
          properties:
            type:
              type: string
              enum: [FILE, RTSP, UNKNOWN]
              description: Type of input source
              example: "FILE"
            path:
              type: string
              description: File path (if type is FILE)
              example: "/path/to/video.mp4"
            url:
              type: string
              description: RTSP URL (if type is RTSP)
              example: "rtsp://example.com:8554/live/stream"
        output:
          type: object
          description: Output information
          required:
            - type
          properties:
            type:
              type: string
              enum: [FILE, RTMP_STREAM]
              description: Type of output
              example: "FILE"
            rtmpUrl:
              type: string
              description: RTMP URL (if type is RTMP_STREAM)
              example: "rtmp://localhost:1935/live/face_stream"
            rtspUrl:
              type: string
              description: RTSP URL for viewing (if type is RTMP_STREAM and available)
              example: "rtsp://localhost:8554/live/face_stream_0"
            files:
              type: object
              description: File output information (if type is FILE)
              properties:
                exists:
                  type: boolean
                  description: Whether output directory exists
                  example: true
                directory:
                  type: string
                  description: Output directory path
                  example: "./output/abc-123-def"
                fileCount:
                  type: integer
                  description: Total number of output files
                  example: 15
                totalSizeBytes:
                  type: integer
                  format: int64
                  description: Total size of all output files in bytes
                  example: 15728640
                totalSize:
                  type: string
                  description: Total size formatted as human-readable string
                  example: "15 MB"
                latestFile:
                  type: string
                  description: Name of the most recently created file
                  example: "face_detection_20250115_143025.mp4"
                latestFileTime:
                  type: string
                  description: Modification time of the latest file
                  example: "2025-01-15 14:30:25"
                recentFileCount:
                  type: integer
                  description: Number of files created in the last minute
                  example: 3
                isActive:
                  type: boolean
                  description: Whether instance is actively creating new files (files created in last minute)
                  example: true
                expectedPaths:
                  type: array
                  items:
                    type: string
                  description: Expected output directory paths (if directory doesn't exist)
                  example: ["./output/abc-123-def", "./build/output/abc-123-def"]
                error:
                  type: string
                  description: Error message if directory reading failed
                  example: "Error reading directory: Permission denied"
        detection:
          type: object
          description: Detection settings
          properties:
            sensitivity:
              type: string
              description: Detection sensitivity level
              example: "Low"
            mode:
              type: string
              description: Detector mode
              example: "SmartDetection"
            movementSensitivity:
              type: string
              description: Movement sensitivity level
              example: "Low"
            sensorModality:
              type: string
              description: Sensor modality
              example: "RGB"
        modes:
          type: object
          description: Processing modes
          properties:
            statisticsMode:
              type: boolean
              description: Statistics mode enabled
              example: true
            metadataMode:
              type: boolean
              description: Metadata mode enabled
              example: false
            debugMode:
              type: boolean
              description: Debug mode enabled
              example: true
            diagnosticsMode:
              type: boolean
              description: Diagnostics mode enabled
              example: false
        status:
          type: object
          description: Status summary
          required:
            - running
            - processing
            - message
          properties:
            running:
              type: boolean
              description: Whether instance is running
              example: true
            processing:
              type: boolean
              description: Whether instance is processing frames (running && fps > 0)
              example: true
            message:
              type: string
              description: Human-readable status message
              example: "Instance is running and processing frames"

    SolutionSummary:
      type: object
      properties:
        solutionId:
          type: string
          description: Unique solution identifier
          example: "face_detection"
        solutionName:
          type: string
          description: Display name of the solution
          example: "Face Detection"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        isDefault:
          type: boolean
          description: Whether this is a default solution (cannot be deleted)
          example: true
        pipelineNodeCount:
          type: integer
          description: Number of nodes in the pipeline
          example: 3

    SolutionConfig:
      type: object
      required:
        - solutionId
        - solutionName
        - solutionType
        - pipeline
      properties:
        solutionId:
          type: string
          description: Unique solution identifier
          example: "face_detection"
        solutionName:
          type: string
          description: Display name of the solution
          example: "Face Detection"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        isDefault:
          type: boolean
          description: Whether this is a default solution
          example: false
        pipeline:
          type: array
          description: Pipeline node configurations
          items:
            type: object
            required:
              - nodeType
              - nodeName
            properties:
              nodeType:
                type: string
                description: Type of node (e.g., "rtsp_src", "yunet_face_detector", "file_des")
                example: "rtsp_src"
              nodeName:
                type: string
                description: Node name template (may contain {instanceId} placeholder)
                example: "source_{instanceId}"
              parameters:
                type: object
                description: Node-specific parameters
                additionalProperties:
                  type: string
                example:
                  url: "rtsp://example.com/stream"
        defaults:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string
          example:
            RTSP_URL: "rtsp://example.com/stream"

    CreateSolutionRequest:
      type: object
      required:
        - solutionId
        - solutionName
        - solutionType
        - pipeline
      properties:
        solutionId:
          type: string
          description: Unique solution identifier (alphanumeric, underscore, hyphen only)
          pattern: "^[A-Za-z0-9_-]+$"
          example: "custom_face_detection"
        solutionName:
          type: string
          description: Display name of the solution
          example: "Custom Face Detection"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        pipeline:
          type: array
          description: Pipeline node configurations
          items:
            type: object
            required:
              - nodeType
              - nodeName
            properties:
              nodeType:
                type: string
                description: Type of node
                example: "rtsp_src"
              nodeName:
                type: string
                description: Node name template
                example: "source_{instanceId}"
              parameters:
                type: object
                description: Node-specific parameters
                additionalProperties:
                  type: string
        defaults:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string

    UpdateSolutionRequest:
      type: object
      description: Request body for updating a solution. All fields except solutionId are optional.
      properties:
        solutionName:
          type: string
          description: Display name of the solution
          example: "Updated Solution Name"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        pipeline:
          type: array
          description: Pipeline node configurations
          items:
            type: object
            required:
              - nodeType
              - nodeName
            properties:
              nodeType:
                type: string
                description: Type of node
              nodeName:
                type: string
                description: Node name template
              parameters:
                type: object
                description: Node-specific parameters
                additionalProperties:
                  type: string
        defaults:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string

    GroupInfo:
      type: object
      required:
        - groupId
        - groupName
      properties:
        groupId:
          type: string
          description: Unique group identifier
          pattern: "^[A-Za-z0-9_-]+$"
          example: "cameras"
        groupName:
          type: string
          description: Display name of the group
          pattern: "^[A-Za-z0-9 -_]+$"
          example: "Security Cameras"
        description:
          type: string
          description: Description of the group
          example: "Group for security camera instances"
        isDefault:
          type: boolean
          description: Whether this is a default group (cannot be deleted)
          example: false
        readOnly:
          type: boolean
          description: Whether this group is read-only (cannot be modified)
          example: false
        instanceCount:
          type: integer
          description: Number of instances in this group
          example: 3
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00.000Z"

    CreateGroupRequest:
      type: object
      required:
        - groupId
      properties:
        groupId:
          type: string
          description: Unique group identifier (alphanumeric, underscore, hyphen only)
          pattern: "^[A-Za-z0-9_-]+$"
          example: "cameras"
        groupName:
          type: string
          description: Display name of the group (optional, defaults to groupId)
          pattern: "^[A-Za-z0-9 -_]+$"
          example: "Security Cameras"
        description:
          type: string
          description: Description of the group
          example: "Group for security camera instances"

    UpdateGroupRequest:
      type: object
      description: Request body for updating a group. All fields are optional.
      properties:
        groupName:
          type: string
          description: Display name of the group
          pattern: "^[A-Za-z0-9 -_]+$"
          example: "Updated Group Name"
        description:
          type: string
          description: Description of the group
          example: "Updated description"

    FrameResponse:
      type: object
      description: Response containing the last frame from a running instance
      required:
        - frame
        - running
      properties:
        frame:
          type: string
          description: The last available frame encoded as JPEG base64
          example: "/9j/4AAQSkZJRgABAQEAYABgAAD..."
        running:
          type: boolean
          description: Indicates if the instance is running
          example: true

tags:
  - name: Core
    description: Core API endpoints for health and version information
  - name: Config
    description: System configuration management endpoints (get, create, update, delete)
  - name: Instances
    description: AI instance management endpoints (create, list, start, stop, delete)
  - name: Solutions
    description: Solution configuration management endpoints (create, list, update, delete)
  - name: Groups
    description: Group management endpoints for organizing instances (create, list, update, delete)
  - name: Models
    description: Model file management endpoints

