openapi: 3.0.3
info:
  title: Edge AI API
  description: |
    REST API for Edge AI operations and management.

    ## Logging Features

    The server supports detailed logging features that can be enabled via command-line arguments:

    - **API Logging** (`--log-api` or `--debug-api`): Logs all API requests and responses with response times
    - **Instance Execution Logging** (`--log-instance` or `--debug-instance`): Logs instance lifecycle events (start/stop/status)
    - **SDK Output Logging** (`--log-sdk-output` or `--debug-sdk-output`): Logs SDK output when instances process data

    Example usage:
    ```bash
    ./edge_ai_api --log-api --log-instance --log-sdk-output
    ```

    For more details, see the [Logging Documentation](../docs/LOGGING.md).

    ## Swagger UI

    This API provides Swagger UI for interactive testing and exploration:
    - Access Swagger UI at `/swagger` or `/v1/swagger`
    - OpenAPI specification available at `/openapi.yaml` or `/v1/openapi.yaml`
    - Server URLs are automatically updated based on environment variables (`API_HOST` and `API_PORT`)
  version: 1.0.0
  contact:
    name: Edge AI API Support

servers:
  - url: http://localhost:8080
    description: Local development server
  - url: http://0.0.0.0:8080
    description: Default server

paths:
  /v1/core/health:
    get:
      summary: Health check endpoint
      description: Returns the health status of the API service
      operationId: getHealth
      tags:
        - Core
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: "healthy"
                timestamp: "2024-01-01T00:00:00.000Z"
                uptime: 3600
                service: "edge_ai_api"
                version: "1.0.0"
        '500':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/version:
    get:
      summary: Get version information
      description: Returns version information about the API service
      operationId: getVersion
      tags:
        - Core
      responses:
        '200':
          description: Version information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'
              example:
                version: "1.0.0"
                build_time: "Jan 01 2024 00:00:00"
                git_commit: "abc123def456"
                api_version: "v1"
                service: "edge_ai_api"

  /v1/core/system/info:
    get:
      summary: Get system hardware information
      description: Returns detailed hardware information including CPU, GPU, RAM, Disk, Mainboard, OS, and Battery
      operationId: getSystemInfo
      tags:
        - Core
      responses:
        '200':
          description: System hardware information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemInfoResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for system info
      operationId: getSystemInfoOptions
      tags:
        - Core
      responses:
        '200':
          description: CORS preflight response

  /v1/core/system/status:
    get:
      summary: Get system status
      description: Returns current system status including CPU usage, RAM usage, load average, and uptime
      operationId: getSystemStatus
      tags:
        - Core
      responses:
        '200':
          description: System status information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemStatusResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for system status
      operationId: getSystemStatusOptions
      tags:
        - Core
      responses:
        '200':
          description: CORS preflight response

  /v1/core/config:
    get:
      summary: Get system configuration
      description: |
        Returns system configuration. If `path` query parameter is provided, returns the specific configuration section.
        Otherwise, returns the complete system configuration.

        **Path Format:**
        - Use forward slashes `/` or dots `.` to navigate nested configuration keys
        - Examples: `system/max_running_instances`, `system.max_running_instances`, `gstreamer/decode_pipelines/auto`

        **Recommended:** Use query parameter with forward slashes for better compatibility.
      operationId: getConfig
      tags:
        - Config
      parameters:
        - name: path
          in: query
          required: false
          schema:
            type: string
          description: |
            Configuration path to get a specific section. Use `/` or `.` as separators.
            Examples: `system/max_running_instances`, `system.web_server`, `gstreamer/decode_pipelines/auto`
          example: "system/max_running_instances"
      responses:
        '200':
          description: Full system configuration
          content:
            application/json:
              schema:
                type: object
                description: Complete system configuration object
                additionalProperties: true
                example:
                  auto_device_list:
                    - "hailo.auto"
                    - "blaize.auto"
                  decoder_priority_list:
                    - "blaize.auto"
                    - "software"
                  gstreamer:
                    decode_pipelines:
                      auto:
                        pipeline: "decodebin ! videoconvert"
                  system:
                    web_server:
                      enabled: true
                      ip_address: "0.0.0.0"
                      port: 8080
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create or update configuration (merge)
      description: |
        Updates the system configuration by merging the provided JSON with the existing configuration.
        Only the provided fields will be updated; other fields remain unchanged.
        The configuration is saved to the config file after update.
      operationId: createOrUpdateConfig
      tags:
        - Config
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Configuration object to merge
              additionalProperties: true
              example:
                system:
                  web_server:
                    port: 8080
      responses:
        '200':
          description: Configuration updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration updated successfully"
                  config:
                    type: object
                    description: Updated full configuration
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Replace entire configuration
      description: |
        Replaces the entire system configuration with the provided JSON.
        All existing configuration will be replaced with the new values.
        The configuration is saved to the config file after replacement.
      operationId: replaceConfig
      tags:
        - Config
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Complete configuration object to replace existing config
              additionalProperties: true
              example:
                auto_device_list:
                  - "hailo.auto"
                system:
                  web_server:
                    enabled: true
                    port: 8080
      responses:
        '200':
          description: Configuration replaced successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration replaced successfully"
                  config:
                    type: object
                    description: New full configuration
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    patch:
      summary: Update configuration section (query parameter)
      description: |
        Updates a specific section of the system configuration at the given path.

        **Path Format:**
        - Use forward slashes `/` or dots `.` as separators
        - Examples: `system/max_running_instances`, `system.max_running_instances`

        Only the provided fields in the section will be updated.
        The configuration is saved to the config file after update.
      operationId: updateConfigSectionQuery
      tags:
        - Config
      parameters:
        - name: path
          in: query
          required: true
          schema:
            type: string
          description: Configuration path using `/` or `.` as separators
          example: "system/max_running_instances"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Configuration section value to update
              additionalProperties: true
              example:
                port: 8080
      responses:
        '200':
          description: Configuration section updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section updated successfully"
                  path:
                    type: string
                    example: "system/max_running_instances"
                  value:
                    type: object
                    description: Updated configuration section value
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete configuration section (query parameter)
      description: |
        Deletes a specific section of the system configuration at the given path.

        **Path Format:**
        - Use forward slashes `/` or dots `.` as separators
        - Examples: `system/max_running_instances`, `system.max_running_instances`

        The configuration is saved to the config file after deletion.
      operationId: deleteConfigSectionQuery
      tags:
        - Config
      parameters:
        - name: path
          in: query
          required: true
          schema:
            type: string
          description: Configuration path using `/` or `.` as separators
          example: "system/max_running_instances"
      responses:
        '200':
          description: Configuration section deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section deleted successfully"
                  path:
                    type: string
                    example: "system/max_running_instances"
        '400':
          description: Invalid request (empty path)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Configuration section not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for config
      operationId: configOptions
      tags:
        - Config
      responses:
        '200':
          description: CORS preflight response

  /v1/core/config/reset:
    post:
      summary: Reset configuration to defaults
      description: |
        Resets the entire system configuration to default values.
        All existing configuration will be replaced with default values.
        The configuration is saved to the config file after reset.

        **Warning:** This operation will replace all configuration with default values.
        Consider backing up your configuration before resetting.
      operationId: resetConfig
      tags:
        - Config
      responses:
        '200':
          description: Configuration reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration reset to defaults successfully"
                  config:
                    type: object
                    description: Default configuration object
                    additionalProperties: true
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/config/{path}:
    get:
      summary: Get configuration section (path parameter)
      description: |
        Returns a specific section of the system configuration at the given path.

        **Path Format:**
        - Use dots `.` as separators (e.g., `system.max_running_instances`)
        - Forward slashes `/` with URL encoding (`%2F`) are NOT supported due to Drogon routing limitations

        **Recommended:** Use query parameter instead: `GET /v1/core/config?path=system/max_running_instances`

        Example paths: `system.max_running_instances`, `system.web_server`, `gstreamer.decode_pipelines.auto`
      operationId: getConfigSection
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: |
            Configuration path using dots as separators.
            Examples: `system.max_running_instances`, `system.web_server`, `gstreamer.decode_pipelines.auto`
            Note: Forward slashes are NOT supported in path parameter (use query parameter instead)
          example: "system.max_running_instances"
      responses:
        '200':
          description: Configuration section
          content:
            application/json:
              schema:
                type: object
                description: Configuration section value (can be object, array, or primitive)
                additionalProperties: true
                example:
                  enabled: true
                  ip_address: "0.0.0.0"
                  port: 8080
        '400':
          description: Invalid request (empty path)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Configuration section not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    patch:
      summary: Update configuration section (path parameter)
      description: |
        Updates a specific section of the system configuration at the given path.

        **Path Format:**
        - Use dots `.` as separators (e.g., `system.max_running_instances`)
        - Forward slashes `/` with URL encoding (`%2F`) are NOT supported

        **Recommended:** Use query parameter instead: `PATCH /v1/core/config?path=system/max_running_instances`

        Only the provided fields in the section will be updated.
        The configuration is saved to the config file after update.
      operationId: updateConfigSection
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: |
            Configuration path using dots as separators.
            Examples: `system.max_running_instances`, `system.web_server`
            Note: Forward slashes are NOT supported in path parameter (use query parameter instead)
          example: "system.max_running_instances"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Configuration section value to update
              additionalProperties: true
              example:
                port: 8080
      responses:
        '200':
          description: Configuration section updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section updated successfully"
                  path:
                    type: string
                    example: "system/web_server"
                  value:
                    type: object
                    description: Updated configuration section value
                    additionalProperties: true
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete configuration section (path parameter)
      description: |
        Deletes a specific section of the system configuration at the given path.

        **Path Format:**
        - Use dots `.` as separators (e.g., `system.max_running_instances`)
        - Forward slashes `/` with URL encoding (`%2F`) are NOT supported

        **Recommended:** Use query parameter instead: `DELETE /v1/core/config?path=system/max_running_instances`

        The configuration is saved to the config file after deletion.
      operationId: deleteConfigSection
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: |
            Configuration path using dots as separators.
            Examples: `system.max_running_instances`, `system.web_server`
            Note: Forward slashes are NOT supported in path parameter (use query parameter instead)
          example: "system.max_running_instances"
      responses:
        '200':
          description: Configuration section deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Configuration section deleted successfully"
                  path:
                    type: string
                    example: "system/web_server"
        '400':
          description: Invalid request (empty path)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Configuration section not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for config path
      operationId: configPathOptions
      tags:
        - Config
      parameters:
        - name: path
          in: path
          required: true
          schema:
            type: string
          description: Configuration path
      responses:
        '200':
          description: CORS preflight response

  /v1/core/logs:
    get:
      summary: List all log files by category
      description: |
        Returns a list of all log files organized by category (api, instance, sdk_output, general).
        Each category contains an array of log files with their date, size, and path.
      operationId: listLogFiles
      tags:
        - Logs
      responses:
        '200':
          description: List of log files by category
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogFilesResponse'
              example:
                categories:
                  api:
                    - date: "2024-01-01"
                      size: 1024
                      path: "/var/log/edge_ai_api/api_2024-01-01.log"
                  instance:
                    - date: "2024-01-01"
                      size: 2048
                      path: "/var/log/edge_ai_api/instance_2024-01-01.log"
                  sdk_output:
                    - date: "2024-01-01"
                      size: 512
                      path: "/var/log/edge_ai_api/sdk_output_2024-01-01.log"
                  general:
                    - date: "2024-01-01"
                      size: 4096
                      path: "/var/log/edge_ai_api/general_2024-01-01.log"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for list logs
      operationId: listLogFilesOptions
      tags:
        - Logs
      responses:
        '200':
          description: CORS preflight response

  /v1/core/logs/{category}:
    get:
      summary: Get logs by category
      description: |
        Returns logs from a specific category with optional filtering.

        **Categories:** api, instance, sdk_output, general

        **Query Parameters:**
        - `level`: Filter by log level (case-insensitive, e.g., INFO, ERROR, WARNING)
        - `from`: Filter logs from timestamp (ISO 8601 format, e.g., 2024-01-01T00:00:00.000Z)
        - `to`: Filter logs to timestamp (ISO 8601 format, e.g., 2024-01-01T23:59:59.999Z)
        - `tail`: Get only the last N lines from the latest log file (integer)
      operationId: getLogsByCategory
      tags:
        - Logs
      parameters:
        - name: category
          in: path
          required: true
          schema:
            type: string
            enum: [api, instance, sdk_output, general]
          description: Log category
          example: "api"
        - name: level
          in: query
          required: false
          schema:
            type: string
          description: Filter by log level (case-insensitive)
          example: "INFO"
        - name: from
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs from timestamp (ISO 8601)
          example: "2024-01-01T00:00:00.000Z"
        - name: to
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs to timestamp (ISO 8601)
          example: "2024-01-01T23:59:59.999Z"
        - name: tail
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
          description: Get only the last N lines from the latest log file
          example: 100
      responses:
        '200':
          description: Logs from the specified category
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogsResponse'
              example:
                category: "api"
                category_dir: "/var/log/edge_ai_api/api"
                files_count: 1
                total_lines: 1000
                filtered_lines: 500
                logs:
                  - timestamp: "2024-01-01T12:00:00.000Z"
                    level: "INFO"
                    message: "API request received"
                  - timestamp: "2024-01-01T12:00:01.000Z"
                    level: "ERROR"
                    message: "Failed to process request"
        '400':
          description: Bad request (invalid category or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get logs by category
      operationId: getLogsByCategoryOptions
      tags:
        - Logs
      responses:
        '200':
          description: CORS preflight response

  /v1/core/logs/{category}/{date}:
    get:
      summary: Get logs by category and date
      description: |
        Returns logs from a specific category and date with optional filtering.

        **Categories:** api, instance, sdk_output, general
        **Date Format:** YYYY-MM-DD (e.g., 2024-01-01)

        **Query Parameters:**
        - `level`: Filter by log level (case-insensitive, e.g., INFO, ERROR, WARNING)
        - `from`: Filter logs from timestamp (ISO 8601 format, e.g., 2024-01-01T00:00:00.000Z)
        - `to`: Filter logs to timestamp (ISO 8601 format, e.g., 2024-01-01T23:59:59.999Z)
        - `tail`: Get only the last N lines from the log file (integer)
      operationId: getLogsByCategoryAndDate
      tags:
        - Logs
      parameters:
        - name: category
          in: path
          required: true
          schema:
            type: string
            enum: [api, instance, sdk_output, general]
          description: Log category
          example: "api"
        - name: date
          in: path
          required: true
          schema:
            type: string
            pattern: '^\d{4}-\d{2}-\d{2}$'
          description: Date in YYYY-MM-DD format
          example: "2024-01-01"
        - name: level
          in: query
          required: false
          schema:
            type: string
          description: Filter by log level (case-insensitive)
          example: "INFO"
        - name: from
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs from timestamp (ISO 8601)
          example: "2024-01-01T00:00:00.000Z"
        - name: to
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: Filter logs to timestamp (ISO 8601)
          example: "2024-01-01T23:59:59.999Z"
        - name: tail
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
          description: Get only the last N lines from the log file
          example: 100
      responses:
        '200':
          description: Logs from the specified category and date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogsByDateResponse'
              example:
                category: "api"
                date: "2024-01-01"
                total_lines: 1000
                filtered_lines: 500
                logs:
                  - timestamp: "2024-01-01T12:00:00.000Z"
                    level: "INFO"
                    message: "API request received"
                  - timestamp: "2024-01-01T12:00:01.000Z"
                    level: "ERROR"
                    message: "Failed to process request"
        '400':
          description: Bad request (invalid category, date format, or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Log file not found for the specified date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get logs by category and date
      operationId: getLogsByCategoryAndDateOptions
      tags:
        - Logs
      responses:
        '200':
          description: CORS preflight response

  /v1/core/ai/process:
    post:
      summary: Process single image/frame
      description: |
        Processes a single image/frame through the AI processing pipeline.
        Supports priority-based queuing and rate limiting.
      operationId: processImage
      tags:
        - AI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  description: Base64-encoded image data
                  example: "/9j/4AAQSkZJRg..."
                config:
                  type: string
                  description: Processing configuration (JSON string)
                  example: '{"model": "yolo", "threshold": 0.5}'
                priority:
                  type: string
                  enum: [low, medium, high]
                  default: medium
                  description: Request priority
      responses:
        '200':
          description: Processing job submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id:
                    type: string
                    description: Unique job identifier
                    example: "job_1234567890"
                  status:
                    type: string
                    example: "queued"
        '400':
          description: Bad request (invalid JSON or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '501':
          description: Not implemented
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/ai/batch:
    post:
      summary: Process batch of images/frames
      description: |
        Processes multiple images/frames in a batch through the AI processing pipeline.
        Currently returns 501 Not Implemented.
      operationId: processBatch
      tags:
        - AI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                images:
                  type: array
                  description: Array of base64-encoded images
                  items:
                    type: string
                config:
                  type: string
                  description: Processing configuration (JSON string)
      responses:
        '200':
          description: Batch processing job submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_ids:
                    type: array
                    items:
                      type: string
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '501':
          description: Not implemented
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/ai/status:
    get:
      summary: Get AI processing status
      description: |
        Returns the current status of the AI processing system including queue size,
        queue max capacity, GPU availability, and other resource information.
      operationId: getAIStatus
      tags:
        - AI
      responses:
        '200':
          description: AI processing status
          content:
            application/json:
              schema:
                type: object
                properties:
                  queue_size:
                    type: integer
                    format: int64
                    description: Current number of items in processing queue
                    example: 5
                  queue_max:
                    type: integer
                    format: int64
                    description: Maximum queue capacity
                    example: 100
                  gpu_total:
                    type: integer
                    format: int64
                    description: Total number of GPUs available
                    example: 2
                  gpu_available:
                    type: integer
                    format: int64
                    description: Number of available GPUs
                    example: 1

  /v1/core/ai/metrics:
    get:
      summary: Get AI processing metrics
      description: |
        Returns detailed metrics about AI processing including performance statistics,
        cache statistics, and rate limiter information.
      operationId: getAIMetrics
      tags:
        - AI
      responses:
        '200':
          description: AI processing metrics
          content:
            application/json:
              schema:
                type: object
                properties:
                  cache:
                    type: object
                    properties:
                      size:
                        type: integer
                        format: int64
                        description: Current cache size
                      max_size:
                        type: integer
                        format: int64
                        description: Maximum cache capacity
                      hit_rate:
                        type: number
                        format: float
                        description: Cache hit rate (0.0 to 1.0)
                  rate_limiter:
                    type: object
                    properties:
                      total_keys:
                        type: integer
                        format: int64
                        description: Total number of rate limit keys
                      active_keys:
                        type: integer
                        format: int64
                        description: Number of active rate limit keys

  /v1/core/watchdog:
    get:
      summary: Get watchdog status
      description: |
        Returns watchdog and health monitor statistics including instance health checks,
        restart counts, and monitoring information.
      operationId: getWatchdogStatus
      tags:
        - Core
      responses:
        '200':
          description: Watchdog status information
          content:
            application/json:
              schema:
                type: object
                description: Watchdog and health monitor statistics
                additionalProperties: true

  /v1/core/endpoints:
    get:
      summary: Get endpoint statistics
      description: |
        Returns statistics for each API endpoint including request counts, response times,
        error rates, and other performance metrics.
      operationId: getEndpointsStats
      tags:
        - Core
      responses:
        '200':
          description: Endpoint statistics
          content:
            application/json:
              schema:
                type: object
                description: Statistics for each endpoint
                additionalProperties: true

  /v1/core/metrics:
    get:
      summary: Get Prometheus format metrics
      description: |
        Returns system metrics in Prometheus format for monitoring and alerting.
        This endpoint is typically used by Prometheus scrapers.
      operationId: getMetrics
      tags:
        - Core
      responses:
        '200':
          description: Prometheus format metrics
          content:
            text/plain:
              schema:
                type: string
                description: Metrics in Prometheus text format
                example: |
                  # HELP http_requests_total Total number of HTTP requests
                  # TYPE http_requests_total counter
                  http_requests_total{method="GET",path="/v1/core/health"} 100

  /v1/core/models/upload:
    post:
      summary: Upload a model file
      description: Uploads a model file (ONNX, weights, etc.) to the server. The file will be saved in the models directory.
      operationId: uploadModel
      tags:
        - Models
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Model file(s) to upload. Select multiple files to upload at once (.onnx, .rknn, .weights, .cfg, .pt, .pth, .pb, .tflite)
                file:
                  type: string
                  format: binary
                  description: Single model file to upload (alternative to files array)
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: Model file as binary data
      responses:
        '201':
          description: Model file(s) uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  count:
                    type: integer
                    description: Number of files uploaded successfully
                  files:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        originalFilename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        url:
                          type: string
                  warnings:
                    type: array
                    items:
                      type: string
                    description: Warnings for files that failed to upload
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: File already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for model upload
      operationId: uploadModelOptions
      tags:
        - Models
      responses:
        '200':
          description: CORS preflight response

  /v1/core/models/list:
    get:
      summary: List uploaded model files
      description: Returns a list of all model files that have been uploaded to the server.
      operationId: listModels
      tags:
        - Models
      responses:
        '200':
          description: List of model files
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  models:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        modified:
                          type: string
                  count:
                    type: integer
                  directory:
                    type: string
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/models/{modelName}:
    put:
      summary: Rename a model file
      description: Renames a model file on the server.
      operationId: renameModel
      tags:
        - Models
      parameters:
        - name: modelName
          in: path
          required: true
          schema:
            type: string
          description: Current name of the model file to rename
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newName
              properties:
                newName:
                  type: string
                  description: New name for the model file (must have valid model file extension)
                  example: "my_model_v2.onnx"
      responses:
        '200':
          description: Model file renamed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  oldName:
                    type: string
                  newName:
                    type: string
                  path:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Model file not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: New name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a model file
      description: Deletes a model file from the server.
      operationId: deleteModel
      tags:
        - Models
      parameters:
        - name: modelName
          in: path
          required: true
          schema:
            type: string
          description: Name of the model file to delete
      responses:
        '200':
          description: Model file deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  filename:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Model file not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/videos/upload:
    post:
      summary: Upload a video file
      description: Uploads a video file (MP4, AVI, MKV, etc.) to the server. The file will be saved in the videos directory.
      operationId: uploadVideo
      tags:
        - Video
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Video file(s) to upload. Select multiple files to upload at once (.mp4, .avi, .mkv, .mov, .flv, .wmv, .webm, etc.)
                file:
                  type: string
                  format: binary
                  description: Single video file to upload (alternative to files array)
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: Video file as binary data
      responses:
        '201':
          description: Video file(s) uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  count:
                    type: integer
                    description: Number of files uploaded successfully
                  files:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        originalFilename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        url:
                          type: string
                  warnings:
                    type: array
                    items:
                      type: string
                    description: Warnings for files that failed to upload
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: File already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for video upload
      operationId: uploadVideoOptions
      tags:
        - Video
      responses:
        '200':
          description: CORS preflight response

  /v1/core/videos/list:
    get:
      summary: List uploaded video files
      description: Returns a list of all video files that have been uploaded to the server.
      operationId: listVideos
      tags:
        - Video
      responses:
        '200':
          description: List of video files
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  videos:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        modified:
                          type: string
                  count:
                    type: integer
                  directory:
                    type: string
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/videos/{videoName}:
    put:
      summary: Rename a video file
      description: Renames a video file on the server.
      operationId: renameVideo
      tags:
        - Video
      parameters:
        - name: videoName
          in: path
          required: true
          schema:
            type: string
          description: Current name of the video file to rename
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newName
              properties:
                newName:
                  type: string
                  description: New name for the video file (must have valid video file extension)
                  example: "my_video_v2.mp4"
      responses:
        '200':
          description: Video file renamed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  oldName:
                    type: string
                  newName:
                    type: string
                  path:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Video file not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: New name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a video file
      description: Deletes a video file from the server.
      operationId: deleteVideo
      tags:
        - Video
      parameters:
        - name: videoName
          in: path
          required: true
          schema:
            type: string
          description: Name of the video file to delete
      responses:
        '200':
          description: Video file deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  filename:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Video file not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/recognition/recognize:
    post:
      summary: Recognize faces from uploaded image
      description: |
        Recognizes faces from an uploaded image. The image can be provided as base64-encoded data
        in a multipart/form-data request. Returns face detection results including bounding boxes,
        landmarks, recognized subjects, and execution times.
      operationId: recognizeFaces
      tags:
        - Recognition
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 0
          description: Maximum number of faces to recognize (0 = no limit). Recognizes the largest faces first.
        - name: prediction_count
          in: query
          required: false
          schema:
            type: integer
            default: 1
          description: Number of predictions to return per face
        - name: det_prob_threshold
          in: query
          required: false
          schema:
            type: number
            format: float
            default: 0.5
          description: Detection probability threshold (0.0 to 1.0)
        - name: face_plugins
          in: query
          required: false
          schema:
            type: string
          description: Face plugins to enable (comma-separated)
        - name: status
          in: query
          required: false
          schema:
            type: string
          description: Status filter
        - name: detect_faces
          in: query
          required: false
          schema:
            type: boolean
            default: true
          description: Whether to detect faces (true) or only recognize existing faces (false)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Image file as base64-encoded data or binary data
      responses:
        '200':
          description: Face recognition results
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: array
                    items:
                      $ref: '#/components/schemas/FaceRecognitionResult'
              example:
                result:
                  - box:
                      probability: 1.0
                      x_max: 1420
                      y_max: 1368
                      x_min: 548
                      y_min: 295
                    landmarks:
                      - [814, 713]
                      - [1104, 829]
                      - [832, 937]
                      - [704, 1030]
                      - [1017, 1133]
                    subjects:
                      - similarity: 0.97858
                        subject: "subject1"
                    execution_time:
                      age: 28.0
                      gender: 26.0
                      detector: 117.0
                      calculator: 45.0
                      mask: 36.0
        '400':
          description: Invalid request (missing file, invalid image format, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized (missing or invalid API key)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for face recognition
      operationId: recognizeFacesOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/recognition/faces:
    get:
      summary: List face subjects
      description: |
        Retrieves a list of all saved face subjects with pagination support.
        You can filter by subject name or retrieve all subjects.

        This endpoint returns paginated results with face information including image_id and subject name.
      operationId: listFaceSubjects
      tags:
        - Recognition
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
          description: Page number of examples to return. Used for pagination. Default value is 0.
          example: 0
        - name: size
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          description: Number of faces per page (page size). Used for pagination. Default value is 20.
          example: 20
        - name: subject
          in: query
          required: false
          schema:
            type: string
          description: Specifies the subject examples to return. If empty, returns examples for all subjects.
          example: "subject1"
      responses:
        '200':
          description: List of face subjects retrieved successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - faces
                  - page_number
                  - page_size
                  - total_pages
                  - total_elements
                properties:
                  faces:
                    type: array
                    description: List of face subjects
                    items:
                      type: object
                      required:
                        - image_id
                        - subject
                      properties:
                        image_id:
                          type: string
                          format: uuid
                          description: Unique identifier of the face
                          example: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                        subject:
                          type: string
                          description: Subject (person) associated with the saved image
                          example: "subject1"
                  page_number:
                    type: integer
                    description: Current page number
                    example: 0
                  page_size:
                    type: integer
                    description: Requested page size
                    example: 20
                  total_pages:
                    type: integer
                    description: Total number of pages available
                    example: 2
                  total_elements:
                    type: integer
                    description: Total number of faces available
                    example: 12
              example:
                faces:
                  - image_id: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                    subject: "subject1"
                  - image_id: "7c246g6c-b476-5633-c2g2-5d0bd3ee1839"
                    subject: "subject1"
                page_number: 0
                page_size: 20
                total_pages: 2
                total_elements: 12
        '401':
          description: Unauthorized (missing or invalid API key)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Register face subject
      description: |
        Registers a face subject by storing the image. You can add as many images as you want to train the system.
        Images should contain only a single face.

        This endpoint accepts image data in two formats:
        1. **Multipart/form-data**: Upload file directly (recommended for file uploads)
        2. **Application/json**: Send base64-encoded image string

        Supported image formats: JPEG, JPG, PNG, BMP, GIF, ICO, TIFF, WebP
        Maximum file size: 5MB

        The system will detect the face in the image and store the face features for recognition.
      operationId: registerFaceSubject
      tags:
        - Recognition
      parameters:
        - name: subject
          in: query
          required: true
          schema:
            type: string
          description: Subject name to register (e.g., "subject1")
          example: "subject1"
        - name: det_prob_threshold
          in: query
          required: false
          schema:
            type: number
            format: float
            default: 0.5
          description: Detection probability threshold (0.0 to 1.0)
          example: 0.5
      requestBody:
        required: true
        description: |
          Image data can be sent in two formats:
          1. Multipart/form-data: Upload file directly (recommended for file uploads)
          2. Application/json: Send base64-encoded image string

          Supported image formats: JPEG, JPG, PNG, BMP, GIF, ICO, TIFF, WebP
          Maximum file size: 5MB
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: "Image file to upload. Supported formats: JPEG, JPG, PNG, BMP, GIF, ICO, TIFF, WebP. Max size: 5MB"
          application/json:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  description: "Base64-encoded image data. Supported formats: JPEG, JPG, PNG, BMP, GIF, ICO, TIFF, WebP. Max size: 5MB"
                  example: "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="
            example:
              file: "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="
      responses:
        '200':
          description: Face subject registered successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - image_id
                  - subject
                properties:
                  image_id:
                    type: string
                    format: uuid
                    description: Unique identifier for the registered image
                    example: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                  subject:
                    type: string
                    description: Subject name that was registered
                    example: "subject1"
              example:
                image_id: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                subject: "subject1"
        '400':
          description: Invalid request (missing subject, invalid image format, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized (missing or invalid API key)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for register face subject
      operationId: registerFaceSubjectOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/recognition/faces/{image_id}:
    delete:
      summary: Delete face subject by ID or subject name
      description: |
        Deletes a face subject by its image ID or subject name.

        - If the identifier is an **image_id**, only that specific face will be deleted.
        - If the identifier is a **subject name**, all faces associated with that subject will be deleted.

        The endpoint automatically detects whether the identifier is an image_id or subject name.
        If no face is found with the given identifier, a 404 error is returned.
      operationId: deleteFaceSubject
      tags:
        - Recognition
      parameters:
        - name: image_id
          in: path
          required: true
          schema:
            type: string
          description: |
            Either the UUID of the face subject to be deleted, or the subject name.
            The endpoint will automatically detect the type of identifier.
          example: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
      responses:
        '200':
          description: Face subject(s) deleted successfully
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    required:
                      - image_id
                      - subject
                    properties:
                      image_id:
                        type: string
                        description: UUID of the deleted face subject
                        example: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                      subject:
                        type: string
                        description: Name of the person associated with the deleted face
                        example: "subject1"
                  - type: object
                    required:
                      - subject
                      - deleted_count
                      - image_ids
                    properties:
                      subject:
                        type: string
                        description: Name of the subject that was deleted
                        example: "subject1"
                      deleted_count:
                        type: integer
                        description: Number of faces deleted for this subject
                        example: 3
                      image_ids:
                        type: array
                        items:
                          type: string
                        description: List of image IDs that were deleted
                        example: ["6b135f5b-a365-4522-b1f1-4c9ac2dd0728", "7c246g6c-b476-5633-c2g2-5d0bd3ee1839"]
              examples:
                single_face:
                  summary: Single face deleted
                  value:
                    image_id: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                    subject: "subject1"
                multiple_faces:
                  summary: All faces for a subject deleted
                  value:
                    subject: "subject1"
                    deleted_count: 3
                    image_ids:
                      - "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                      - "7c246g6c-b476-5633-c2g2-5d0bd3ee1839"
                      - "8d357h7d-c587-6744-d3h3-6e1ce4ff2950"
        '400':
          description: Bad request (missing image_id, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized (missing or invalid API key)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Face subject not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for delete face subject
      operationId: deleteFaceSubjectOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/recognition/faces/delete:
    post:
      summary: Delete multiple face subjects
      description: |
        Deletes multiple face subjects by their image IDs. If some IDs do not exist,
        they will be ignored. This endpoint is available since version 1.0.
      operationId: deleteMultipleFaceSubjects
      tags:
        - Recognition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
                format: uuid
              description: Array of image IDs to delete
            example:
              - "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
              - "7c246g6c-b476-5633-c2g2-5d0bd3ee1839"
      responses:
        '200':
          description: Face subjects deleted successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - deleted
                properties:
                  deleted:
                    type: array
                    description: Array of deleted face subjects
                    items:
                      type: object
                      required:
                        - image_id
                        - subject
                      properties:
                        image_id:
                          type: string
                          format: uuid
                          description: UUID of the deleted face subject
                          example: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                        subject:
                          type: string
                          description: Name of the person associated with the deleted face
                          example: "subject1"
              example:
                deleted:
                  - image_id: "6b135f5b-a365-4522-b1f1-4c9ac2dd0728"
                    subject: "subject1"
                  - image_id: "7c246g6c-b476-5633-c2g2-5d0bd3ee1839"
                    subject: "subject2"
        '400':
          description: Bad request (invalid JSON, not an array, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized (missing or invalid API key)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for delete multiple face subjects
      operationId: deleteMultipleFaceSubjectsOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/recognition/faces/all:
    delete:
      summary: Delete all face subjects
      description: |
        Deletes all face subjects from the database. This operation is irreversible.
        All image IDs and subject mappings will be removed.

        **Warning:** This endpoint will delete all registered faces. Use with caution.
      operationId: deleteAllFaceSubjects
      tags:
        - Recognition
      responses:
        '200':
          description: All face subjects deleted successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - deleted_count
                  - message
                properties:
                  deleted_count:
                    type: integer
                    description: Total number of face subjects deleted
                    example: 15
                  message:
                    type: string
                    description: Success message
                    example: "All face subjects deleted successfully"
              example:
                deleted_count: 15
                message: "All face subjects deleted successfully"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for delete all face subjects
      operationId: deleteAllFaceSubjectsOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/recognition/search:
    post:
      summary: Search appearance subject
      description: |
        Search for similar faces in the database given an input face image.
        Returns a list of matching faces sorted by similarity (highest first) above the specified threshold.

        **How it works:**
        1. Detects faces in the uploaded image
        2. Extracts face embeddings from the first detected face
        3. Compares with all faces in the database
        4. Returns matches with similarity >= threshold, sorted from highest to lowest

        **Response fields:**
        - `image_id`: Unique identifier of the matched face
        - `subject`: Name of the matched subject
        - `similarity`: Cosine similarity score (0.0 - 1.0)
        - `face_image`: Base64 encoded face image (reserved for future use)
      operationId: searchAppearanceSubject
      tags:
        - Recognition
      parameters:
        - name: threshold
          in: query
          required: false
          schema:
            type: number
            format: float
            default: 0.5
            minimum: 0.0
            maximum: 1.0
          description: Minimum similarity threshold for matches (0.0 - 1.0)
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
          description: Maximum number of results to return (0 = no limit)
        - name: det_prob_threshold
          in: query
          required: false
          schema:
            type: number
            format: float
            default: 0.5
            minimum: 0.0
            maximum: 1.0
          description: Face detection probability threshold
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Image file containing a face to search
              required:
                - file
          application/json:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: base64
                  description: Base64 encoded image data
              required:
                - file
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: array
                    items:
                      type: object
                      properties:
                        image_id:
                          type: string
                          description: Unique identifier of the matched face
                        subject:
                          type: string
                          description: Name of the matched subject
                        similarity:
                          type: number
                          format: float
                          description: Cosine similarity score (0.0 - 1.0)
                        face_image:
                          type: string
                          description: Base64 encoded face image (reserved for future use)
                  faces_found:
                    type: integer
                    description: Number of matching faces found
                  threshold:
                    type: number
                    format: float
                    description: Threshold used for search
              example:
                result:
                  - image_id: "abc123-def456-ghi789"
                    subject: "John Doe"
                    similarity: 0.95
                    face_image: ""
                  - image_id: "xyz789-uvw456-rst123"
                    subject: "Jane Smith"
                    similarity: 0.82
                    face_image: ""
                faces_found: 2
                threshold: 0.5
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for search appearance subject
      operationId: searchAppearanceSubjectOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/recognition/subjects/{subject}:
    put:
      summary: Rename face subject
      description: |
        Renames an existing face subject. This endpoint searches for the face subject name in the face database
        and allows you to select and rename that subject.

        **How it works:**
        1. The endpoint searches for the subject name specified in the URL path (`{subject}`) in the face database.
        2. If found, it renames the subject to the new name provided in the request body.
        3. All face registrations associated with the old subject name are updated to use the new name.

        **Behavior:**
        - If the new subject name does not exist, all faces from the old subject are moved to the new name.
        - If the new subject name already exists, the subjects are merged. The embeddings are averaged and
          all faces from the old subject are reassigned to the subject with the new name, and the old subject is removed.
        - All image_id mappings are automatically updated to reflect the new subject name.
        - The face database file is updated to persist the changes.

        **Note:** The subject name in the URL path must match exactly with a subject name in the database.
        Use GET /v1/recognition/faces to list all available subjects.

        This endpoint is available since version 0.6.
      operationId: renameSubject
      tags:
        - Recognition
      parameters:
        - name: subject
          in: path
          required: true
          schema:
            type: string
          description: |
            The current subject name to rename. This must match exactly with a subject name in the face database.
            Use GET /v1/recognition/faces to see all available subjects.
          example: "subject1"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RenameSubjectRequest'
            example:
              subject: "testing_face"
      responses:
        '200':
          description: Subject renamed successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - updated
                  - old_subject
                  - new_subject
                  - message
                properties:
                  updated:
                    type: string
                    enum: ["true"]
                    description: Indicates the operation was successful
                  old_subject:
                    type: string
                    description: The original subject name
                    example: "subject1"
                  new_subject:
                    type: string
                    description: The new subject name
                    example: "testing_face"
                  message:
                    type: string
                    description: Success message
                    example: "Subject renamed successfully"
              example:
                updated: "true"
                old_subject: "subject1"
                new_subject: "testing_face"
                message: "Subject renamed successfully"
        '400':
          description: Bad request (subject not found, missing subject, invalid JSON, etc.)
          content:
            application/json:
              schema:
                type: object
                required:
                  - updated
                  - error
                  - old_subject
                properties:
                  updated:
                    type: string
                    enum: ["false"]
                    description: Indicates the operation failed
                  error:
                    type: string
                    description: Error message explaining why the rename failed
                    example: "Subject 'subject1' not found in face database"
                  old_subject:
                    type: string
                    description: The subject name that was attempted to be renamed
                    example: "subject1"
              example:
                updated: "false"
                error: "Subject 'subject1' not found in face database"
                old_subject: "subject1"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for rename subject
      operationId: renameSubjectOptions
      tags:
        - Recognition
      responses:
        '200':
          description: CORS preflight response

  /v1/core/fonts/upload:
    post:
      summary: Upload a font file
      description: Uploads a font file (TTF, OTF, WOFF, WOFF2, etc.) to the server. The file will be saved in the fonts directory.
      operationId: uploadFont
      tags:
        - Fonts
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Font file(s) to upload. Select multiple files to upload at once (.ttf, .otf, .woff, .woff2, .eot, .ttc)
                file:
                  type: string
                  format: binary
                  description: Single font file to upload (alternative to files array)
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: Font file as binary data
      responses:
        '201':
          description: Font file(s) uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  count:
                    type: integer
                    description: Number of files uploaded successfully
                  files:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        originalFilename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        url:
                          type: string
        '400':
          description: Invalid request (missing file, invalid format, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized (missing or invalid API key)
        '409':
          description: File already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for font upload
      operationId: uploadFontOptions
      tags:
        - Fonts
      responses:
        '200':
          description: CORS preflight response

  /v1/core/fonts/list:
    get:
      summary: List uploaded font files
      description: Returns a list of all font files that have been uploaded to the server.
      operationId: listFonts
      tags:
        - Fonts
      responses:
        '200':
          description: List of font files
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  fonts:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        modified:
                          type: string
                  count:
                    type: integer
                  directory:
                    type: string
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/fonts/{fontName}:
    put:
      summary: Rename a font file
      description: Renames a font file on the server.
      operationId: renameFont
      tags:
        - Fonts
      parameters:
        - name: fontName
          in: path
          required: true
          schema:
            type: string
          description: Current name of the font file to rename
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newName
              properties:
                newName:
                  type: string
                  description: New name for the font file
      responses:
        '200':
          description: Font file renamed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  oldName:
                    type: string
                  newName:
                    type: string
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Font file not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: New name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for font operations
      operationId: fontOptionsHandler
      tags:
        - Fonts
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instance/status/summary:
    get:
      summary: Get instance status summary
      description: |
        Returns a summary of instance status including total number of configured instances,
        number of running instances, and number of stopped instances.
      operationId: getStatusSummary
      tags:
        - Instances
      responses:
        '200':
          description: Instance status summary
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
              example:
                total: 5
                configured: 5
                running: 3
                stopped: 2
                timestamp: "2024-01-01T00:00:00.000Z"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for status summary endpoint
      operationId: statusSummaryOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
                example: "*"
            Access-Control-Allow-Methods:
              schema:
                type: string
                example: "GET, OPTIONS"
            Access-Control-Allow-Headers:
              schema:
                type: string
                example: "Content-Type, Authorization"

  /v1/core/instances:
    get:
      summary: List all instances
      description: |
        Returns a list of all AI instances with summary information including running status, solution information, and basic configuration details.

        The response includes:
        - Total count of instances
        - Number of running instances
        - Number of stopped instances
        - Summary information for each instance (ID, display name, running status, solution, etc.)

        This endpoint is useful for getting an overview of all instances in the system without fetching detailed information for each one.
      operationId: listInstances
      tags:
        - Instances
      responses:
        '200':
          description: List of instances
          content:
            application/json:
              schema:
                type: object
                properties:
                  instances:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstanceSummary'
                  total:
                    type: integer
                    description: Total number of instances
                  running:
                    type: integer
                    description: Number of running instances
                  stopped:
                    type: integer
                    description: Number of stopped instances
              example:
                total: 3
                running: 1
                stopped: 2
                instances:
                  - instanceId: "550e8400-e29b-41d4-a716-446655440000"
                    displayName: "Face Detection Camera 1"
                    running: true
                    solutionId: "face_detection"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete all instances
      description: |
        Deletes all instances in the system. This operation permanently removes all instances and stops their pipelines if running.

        **Behavior:**
        - All instances are deleted concurrently for optimal performance
        - If instances are currently running, they will be stopped first
        - All instance configurations will be removed from memory
        - Persistent instance configuration files will be deleted from storage
        - All resources associated with instances will be released

        **Response:**
        - Returns a summary of the deletion operation
        - Includes detailed results for each instance (success/failure status)
        - Provides counts of total, deleted, and failed instances

        **Note:** This operation cannot be undone. Once deleted, instances must be recreated using the create instance endpoint.
      operationId: deleteAllInstances
      tags:
        - Instances
      responses:
        '200':
          description: Delete all instances operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: True if all instances were deleted successfully
                  message:
                    type: string
                    description: Operation status message
                  total:
                    type: integer
                    description: Total number of instances that were attempted to delete
                  deleted:
                    type: integer
                    description: Number of instances successfully deleted
                  failed:
                    type: integer
                    description: Number of instances that failed to delete
                  results:
                    type: array
                    description: Detailed results for each instance
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                          description: Instance ID
                        success:
                          type: boolean
                          description: Whether deletion was successful
                        status:
                          type: string
                          description: Status of deletion (deleted or failed)
                        error:
                          type: string
                          description: Error message if deletion failed
              example:
                success: true
                message: "Delete all instances operation completed"
                total: 3
                deleted: 3
                failed: 0
                results:
                  - instanceId: "550e8400-e29b-41d4-a716-446655440000"
                    success: true
                    status: "deleted"
                  - instanceId: "550e8400-e29b-41d4-a716-446655440001"
                    success: true
                    status: "deleted"
                  - instanceId: "550e8400-e29b-41d4-a716-446655440002"
                    success: true
                    status: "deleted"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '503':
          description: Service unavailable (registry busy)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    options:
      summary: CORS preflight for list instances
      operationId: listInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}:
    get:
      summary: Get instance details
      description: |
        Returns detailed information about a specific instance including full configuration, status, and runtime information.

        The response includes:
        - Instance configuration (display name, group, solution, etc.)
        - Runtime status (running, loaded, FPS, etc.)
        - Configuration settings (detector mode, sensitivity, frame rate limits, etc.)
        - Input/Output configuration
        - Originator information

        The instance must exist. If the instance is not found, a 404 error will be returned.
      operationId: getInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceInfo'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update instance information
      description: |
        Updates configuration of an existing instance. Only provided fields will be updated. Supports two update formats:

        **Update Format 1: Field-by-field (camelCase)**
        - Update individual fields like `name`, `group`, `autoStart`, `frameRateLimit`, etc.
        - Use `additionalParams` to update solution-specific parameters (RTSP_URL, MODEL_PATH, etc.)

        **Update Format 2: Direct Config (PascalCase)**
        - Update using PascalCase format matching instance config file
        - Can update `Input`, `Output`, `Detector`, `Zone`, etc. directly

        **Behavior:**
        - If the instance is currently running, it will be automatically restarted to apply the changes
        - If the instance is not running, changes will take effect when the instance is started
        - The instance must exist and not be read-only
        - Only provided fields will be updated; other fields remain unchanged
      operationId: updateInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateInstanceRequest'
      responses:
        '200':
          description: Instance updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
                        example: "Instance updated successfully"
        '400':
          description: Invalid request or validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete an instance
      description: |
        Deletes an instance and stops its pipeline if running. This operation permanently removes the instance from the system.

        **Behavior:**
        - If the instance is currently running, it will be stopped first
        - The instance configuration will be removed from memory
        - If the instance is persistent, its configuration file will be deleted from storage
        - All resources associated with the instance will be released

        **Prerequisites:**
        - Instance must exist
        - Instance must not be read-only (system instances cannot be deleted)

        **Note:** This operation cannot be undone. Once deleted, the instance must be recreated using the create instance endpoint.
      operationId: deleteInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  instanceId:
                    type: string
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instances/{instanceId}/start:
    post:
      summary: Start an instance
      description: |
        Starts the pipeline for an instance. The instance must have a pipeline configured and a valid solution.

        **Prerequisites:**
        - Instance must exist
        - Instance must have a valid solution configuration
        - Instance must not be read-only
        - Input source must be properly configured (if required by solution)

        **Behavior:**
        - If the instance is already running, the request will succeed without error
        - The pipeline will be built and started based on the instance's solution configuration
        - Processing will begin according to the configured input source and detector settings
        - Returns the updated instance information with `running: true`

        **Note:** Starting an instance may take a few seconds as the pipeline is initialized.
      operationId: startInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance started successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
        '400':
          description: Failed to start instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instances/{instanceId}/stop:
    post:
      summary: Stop an instance
      description: |
        Stops the pipeline for an instance, halting all processing and releasing resources.

        **Behavior:**
        - If the instance is already stopped, the request will succeed without error
        - The pipeline will be gracefully stopped and all resources will be released
        - Processing will stop immediately
        - Returns the updated instance information with `running: false`

        **Note:** Stopping an instance may take a few seconds as the pipeline is cleaned up.

        The instance configuration is preserved and can be started again using the start endpoint.
      operationId: stopInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance stopped successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
        '400':
          description: Failed to stop instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/core/instances/{instanceId}/restart:
    post:
      summary: Restart an instance
      description: |
        Restarts an instance by stopping it (if running) and then starting it again. This is useful for applying configuration changes or recovering from errors.

        **Behavior:**
        - If the instance is running, it will be stopped first
        - Then the instance will be started again
        - This ensures a clean restart with the current configuration
        - Returns the updated instance information after restart

        **Use Cases:**
        - Apply configuration changes that require a restart
        - Recover from errors or unexpected states
        - Refresh the pipeline with updated settings

        **Note:** Restarting an instance may take several seconds as the pipeline is stopped and then restarted.
      operationId: restartInstance
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance restarted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/InstanceInfo'
                  - type: object
                    properties:
                      message:
                        type: string
        '400':
          description: Failed to restart instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for restart instance
      operationId: restartInstanceOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/output:
    get:
      summary: Get instance output and processing results
      description: |
        Returns real-time output and processing results for a specific instance at the time of the request.
        This endpoint provides comprehensive information about:
        - Current processing metrics (FPS, frame rate limit)
        - Input source (FILE or RTSP)
        - Output type and details (FILE output files or RTMP stream)
        - Detection settings and processing modes
        - Current status and processing state

        For instances with FILE output, it includes file count, total size, latest file information, and activity status.
        For instances with RTMP output, it includes RTMP and RTSP URLs.
      operationId: getInstanceOutput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Instance output and processing results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceOutputResponse'
              examples:
                fileOutput:
                  summary: Instance with FILE output
                  value:
                    timestamp: "2025-01-15 14:30:25.123"
                    instanceId: "abc-123-def"
                    displayName: "face_detection_file_source"
                    solutionId: "face_detection"
                    solutionName: "Face Detection"
                    running: true
                    loaded: true
                    metrics:
                      fps: 25.50
                      frameRateLimit: 0
                    input:
                      type: "FILE"
                      path: "/path/to/video.mp4"
                    output:
                      type: "FILE"
                      files:
                        exists: true
                        directory: "./output/abc-123-def"
                        fileCount: 15
                        totalSizeBytes: 15728640
                        totalSize: "15 MB"
                        latestFile: "face_detection_20250115_143025.mp4"
                        latestFileTime: "2025-01-15 14:30:25"
                        recentFileCount: 3
                        isActive: true
                    detection:
                      sensitivity: "Low"
                      mode: "SmartDetection"
                      movementSensitivity: "Low"
                      sensorModality: "RGB"
                    modes:
                      statisticsMode: true
                      metadataMode: false
                      debugMode: true
                      diagnosticsMode: false
                    status:
                      running: true
                      processing: true
                      message: "Instance is running and processing frames"
                rtmpOutput:
                  summary: Instance with RTMP output
                  value:
                    timestamp: "2025-01-15 14:30:25.123"
                    instanceId: "xyz-789"
                    displayName: "face_detection_rtmp_stream"
                    solutionId: "face_detection_rtmp"
                    solutionName: "Face Detection RTMP"
                    running: true
                    loaded: true
                    metrics:
                      fps: 30.0
                      frameRateLimit: 25
                    input:
                      type: "FILE"
                      path: "/path/to/video.mp4"
                    output:
                      type: "RTMP_STREAM"
                      rtmpUrl: "rtmp://localhost:1935/live/face_stream"
                      rtspUrl: "rtsp://localhost:8554/live/face_stream_0"
                    detection:
                      sensitivity: "High"
                      mode: "SmartDetection"
                      movementSensitivity: "Low"
                      sensorModality: "RGB"
                    modes:
                      statisticsMode: true
                      metadataMode: true
                      debugMode: false
                      diagnosticsMode: false
                    status:
                      running: true
                      processing: true
                      message: "Instance is running and processing frames"
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get instance output
      operationId: getInstanceOutputOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/frame:
    get:
      summary: Get last frame from instance
      description: |
        Returns the last processed frame from a running instance. The frame is encoded as JPEG and returned as a base64-encoded string.

        **Features:**
        - Frame is captured from the pipeline after processing (includes OSD/detection overlays)
        - Frame is automatically cached when pipeline processes new frames
        - Frame cache is automatically cleaned up when instance stops or is deleted

        **Important Notes:**
        - Frame capture only works if the pipeline has an `app_des_node`
        - If pipeline doesn't have `app_des_node`, frame will be empty string
        - Instance must be running to have a frame
        - Frame is cached automatically each time pipeline processes a new frame
      operationId: getLastFrame
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
      responses:
        '200':
          description: Last frame retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LastFrameResponse'
              example:
                frame: "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k="
                running: true
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get last frame
      operationId: getLastFrameOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/batch/start:
    post:
      summary: Start multiple instances concurrently
      description: |
        Starts multiple instances concurrently for faster batch operations. All operations run in parallel for optimal performance.

        **Behavior:**
        - All instances are started in parallel, not sequentially
        - Each instance is started independently
        - Results are returned for each instance (success or failure)
        - Instances that are already running will be marked as successful

        **Request Format:**
        - Provide an array of instance IDs in the `instanceIds` field
        - All instance IDs must exist in the system

        **Response:**
        - Returns detailed results for each instance
        - Includes total count, success count, and failed count
        - Each result includes the instance ID, success status, running status, and any error messages

        **Use Cases:**
        - Start multiple instances after server restart
        - Batch operations for managing multiple cameras or streams
        - Efficiently start a group of related instances

        **Note:** Starting multiple instances simultaneously may consume significant system resources. Monitor system performance when starting many instances at once.
      operationId: batchStartInstances
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instanceIds
              properties:
                instanceIds:
                  type: array
                  items:
                    type: string
                  description: Array of instance IDs to start
                  example: ["instance-1", "instance-2", "instance-3"]
      responses:
        '200':
          description: Batch start operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        success:
                          type: boolean
                        status:
                          type: string
                        running:
                          type: boolean
                        error:
                          type: string
                  total:
                    type: integer
                  success:
                    type: integer
                  failed:
                    type: integer
                  message:
                    type: string
              example:
                results:
                  - instanceId: "instance-1"
                    success: true
                    status: "started"
                    running: true
                  - instanceId: "instance-2"
                    success: false
                    status: "failed"
                    error: "Could not start instance. Check if instance exists and has a pipeline."
                total: 2
                success: 1
                failed: 1
                message: "Batch start operation completed"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for batch start
      operationId: batchStartInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/batch/stop:
    post:
      summary: Stop multiple instances concurrently
      description: |
        Stops multiple instances concurrently for faster batch operations. All operations run in parallel for optimal performance.

        **Behavior:**
        - All instances are stopped in parallel, not sequentially
        - Each instance is stopped independently
        - Results are returned for each instance (success or failure)
        - Instances that are already stopped will be marked as successful

        **Request Format:**
        - Provide an array of instance IDs in the `instanceIds` field
        - All instance IDs must exist in the system

        **Response:**
        - Returns detailed results for each instance
        - Includes total count, success count, and failed count
        - Each result includes the instance ID, success status, running status, and any error messages

        **Use Cases:**
        - Stop multiple instances for maintenance
        - Batch operations for managing multiple cameras or streams
        - Efficiently stop a group of related instances

        **Note:** Stopping multiple instances simultaneously will release system resources. This is useful for managing system load.
      operationId: batchStopInstances
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instanceIds
              properties:
                instanceIds:
                  type: array
                  items:
                    type: string
                  description: Array of instance IDs to stop
                  example: ["instance-1", "instance-2", "instance-3"]
      responses:
        '200':
          description: Batch stop operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        success:
                          type: boolean
                        status:
                          type: string
                        running:
                          type: boolean
                        error:
                          type: string
                  total:
                    type: integer
                  success:
                    type: integer
                  failed:
                    type: integer
                  message:
                    type: string
              example:
                results:
                  - instanceId: "instance-1"
                    success: true
                    status: "stopped"
                    running: false
                  - instanceId: "instance-2"
                    success: false
                    status: "failed"
                    error: "Could not stop instance. Check if instance exists."
                total: 2
                success: 1
                failed: 1
                message: "Batch stop operation completed"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for batch stop
      operationId: batchStopInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/batch/restart:
    post:
      summary: Restart multiple instances concurrently
      description: Restarts multiple instances concurrently by stopping and then starting them. All operations run in parallel for optimal performance.
      operationId: batchRestartInstances
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instanceIds
              properties:
                instanceIds:
                  type: array
                  items:
                    type: string
                  description: Array of instance IDs to restart
                  example: ["instance-1", "instance-2", "instance-3"]
      responses:
        '200':
          description: Batch restart operation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        success:
                          type: boolean
                        status:
                          type: string
                        running:
                          type: boolean
                        error:
                          type: string
                  total:
                    type: integer
                  success:
                    type: integer
                  failed:
                    type: integer
                  message:
                    type: string
              example:
                results:
                  - instanceId: "instance-1"
                    success: true
                    status: "restarted"
                    running: true
                  - instanceId: "instance-2"
                    success: false
                    status: "failed"
                    error: "Could not restart instance. Check if instance exists and has a pipeline."
                total: 2
                success: 1
                failed: 1
                message: "Batch restart operation completed"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for batch restart
      operationId: batchRestartInstancesOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/groups:
    get:
      summary: List all groups
      description: |
        Returns a list of all groups with summary information including group name, description, instance count, and metadata.

        The response includes:
        - Total count of groups
        - Number of default groups
        - Number of custom groups
        - Summary information for each group (ID, name, description, instance count, etc.)

        This endpoint is useful for getting an overview of all groups in the system without fetching detailed information for each one.
      operationId: listGroups
      tags:
        - Groups
      responses:
        '200':
          description: List of groups
          content:
            application/json:
              schema:
                type: object
                properties:
                  groups:
                    type: array
                    items:
                      $ref: '#/components/schemas/GroupInfo'
                  total:
                    type: integer
                    description: Total number of groups
                  default:
                    type: integer
                    description: Number of default groups
                  custom:
                    type: integer
                    description: Number of custom groups
              example:
                total: 2
                default: 0
                custom: 2
                groups:
                  - groupId: "cameras"
                    groupName: "Security Cameras"
                    description: "Group for security camera instances"
                    instanceCount: 3
                    isDefault: false
                    readOnly: false
                  - groupId: "test"
                    groupName: "Test Group"
                    description: "Group for testing"
                    instanceCount: 1
                    isDefault: false
                    readOnly: false
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new group
      description: |
        Creates a new group for organizing instances. Groups help organize and manage multiple instances together.

        **Group Properties:**
        - **groupId** (required): Unique identifier for the group (alphanumeric, underscores, hyphens only)
        - **groupName** (optional): Display name for the group (defaults to groupId if not provided)
        - **description** (optional): Description of the group's purpose

        **Validation:**
        - Group ID must be unique
        - Group ID must match pattern: `^[A-Za-z0-9_-]+$`
        - Group name must match pattern: `^[A-Za-z0-9 -_]+$`

        **Persistence:**
        - Groups are automatically saved to storage
        - Group files are stored in `/var/lib/edge_ai_api/groups` (configurable via `GROUPS_DIR` environment variable)

        **Returns:** The created group information including timestamps.
      operationId: createGroup
      tags:
        - Groups
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGroupRequest'
            example:
              groupId: "cameras"
              groupName: "Security Cameras"
              description: "Group for security camera instances"
      responses:
        '201':
          description: Group created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupInfo'
        '400':
          description: Bad request (validation failed or group already exists)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for groups
      operationId: listGroupsOptions
      tags:
        - Groups
      responses:
        '200':
          description: CORS preflight response

  /v1/core/groups/{groupId}:
    get:
      summary: Get group details
      description: |
        Returns detailed information about a specific group including group metadata and list of instance IDs.

        The response includes:
        - Group configuration (ID, name, description)
        - Group metadata (isDefault, readOnly, timestamps)
        - Instance count
        - List of instance IDs in the group

        The group must exist. If the group is not found, a 404 error will be returned.
      operationId: getGroup
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      responses:
        '200':
          description: Group details
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GroupInfo'
                  - type: object
                    properties:
                      instanceIds:
                        type: array
                        items:
                          type: string
                        description: List of instance IDs in this group
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update a group
      description: |
        Updates an existing group's information. Only provided fields will be updated.

        **Updateable Fields:**
        - **groupName**: Update the display name of the group
        - **description**: Update the description of the group

        **Restrictions:**
        - Group must exist
        - Group must not be read-only
        - Group ID cannot be changed

        **Behavior:**
        - Only provided fields will be updated
        - Other fields remain unchanged
        - Updated timestamp is automatically set
      operationId: updateGroup
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGroupRequest'
            example:
              groupName: "Updated Group Name"
              description: "Updated description"
      responses:
        '200':
          description: Group updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupInfo'
        '400':
          description: Bad request (validation failed or group is read-only)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a group
      description: |
        Deletes a group from the system. This operation permanently removes the group.

        **Prerequisites:**
        - Group must exist
        - Group must not be a default group
        - Group must not be read-only
        - Group must have no instances (all instances must be removed or moved to other groups first)

        **Behavior:**
        - Group configuration will be removed from memory
        - Group file will be deleted from storage
        - All resources associated with the group will be released

        **Note:** This operation cannot be undone. Once deleted, the group must be recreated using the create group endpoint.
      operationId: deleteGroup
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      responses:
        '200':
          description: Group deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  groupId:
                    type: string
        '400':
          description: Failed to delete (group has instances, is default, or is read-only)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for group
      operationId: getGroupOptions
      tags:
        - Groups
      responses:
        '200':
          description: CORS preflight response

  /v1/core/groups/{groupId}/instances:
    get:
      summary: Get instances in a group
      description: |
        Returns a list of all instances that belong to a specific group.

        The response includes:
        - Group ID
        - List of instances with summary information (ID, display name, solution, running status)
        - Total count of instances in the group

        **Use Cases:**
        - View all instances in a specific group
        - Monitor group status and performance
        - Manage instances by group

        The group must exist. If the group is not found, a 404 error will be returned.
      operationId: getGroupInstances
      tags:
        - Groups
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: Group ID
      responses:
        '200':
          description: List of instances in the group
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupId:
                    type: string
                    description: Group ID
                  instances:
                    type: array
                    items:
                      type: object
                      properties:
                        instanceId:
                          type: string
                        displayName:
                          type: string
                        solutionId:
                          type: string
                        running:
                          type: boolean
                        loaded:
                          type: boolean
                  count:
                    type: integer
                    description: Number of instances in the group
              example:
                groupId: "cameras"
                count: 2
                instances:
                  - instanceId: "abc-123"
                    displayName: "Camera 1"
                    solutionId: "face_detection"
                    running: true
                    loaded: true
                  - instanceId: "def-456"
                    displayName: "Camera 2"
                    solutionId: "face_detection"
                    running: false
                    loaded: true
        '404':
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for group instances
      operationId: getGroupInstancesOptions
      tags:
        - Groups
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instance:
    post:
      summary: Create a new AI instance
      description: |
        Creates and registers a new AI instance with the specified configuration. Returns the instance ID (UUID) that can be used to control the instance.

        **Configuration Options:**
        - **Basic Settings:** name, group, solution, persistent mode
        - **Performance:** frame rate limits, input pixel limits, input orientation
        - **Detection:** detector mode, sensitivity levels, sensor modality
        - **Processing Modes:** metadata mode, statistics mode, diagnostics mode, debug mode
        - **Auto Management:** auto-start, auto-restart, blocking readahead queue
        - **Solution Parameters:** RTSP_URL, MODEL_PATH, FILE_PATH, RTMP_URL, etc. (via additionalParams)

        **Solution Types:**
        - `face_detection`: Face detection with RTSP input
        - `face_detection_file`: Face detection with file input
        - `object_detection`: Object detection (YOLO)
        - `face_detection_rtmp`: Face detection with RTMP streaming
        - Custom solutions registered via solution management endpoints

        **Persistence:**
        - If `persistent: true`, the instance will be saved to a JSON file in the instances directory
        - Persistent instances are automatically loaded when the server restarts
        - Instance configuration files are stored in `/var/lib/edge_ai_api/instances` (configurable via `INSTANCES_DIR` environment variable)

        **Auto Start:**
        - If `autoStart: true`, the instance will automatically start after creation
        - The pipeline will be built and started immediately

        **Returns:** The created instance information including the generated UUID that can be used for subsequent operations.
      operationId: createInstance
      tags:
        - Instances
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateInstanceRequest'
            example:
              name: "Face Detection Camera 1"
              group: "cameras"
              solution: "face_detection"
              persistent: true
              frameRateLimit: 30
              metadataMode: true
              statisticsMode: true
              diagnosticsMode: false
              debugMode: false
              detectorMode: "SmartDetection"
              detectionSensitivity: "Medium"
              movementSensitivity: "Low"
              sensorModality: "RGB"
              autoStart: true
              autoRestart: false
              blockingReadaheadQueue: false
              inputOrientation: 0
              inputPixelLimit: 1920
              RTSP_URL: "rtsp://localhost:8554/stream"
              MODEL_NAME: "yunet_2023mar"
      responses:
        '201':
          description: Instance created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceInfo'
              example:
                instanceId: "550e8400-e29b-41d4-a716-446655440000"
                displayName: "Face Detection Camera 1"
                group: "cameras"
                solutionId: "face_detection"
                solutionName: "Face Detection"
                persistent: true
                loaded: true
                running: true
                fps: 0.0
                version: "2025.0.1.2"
                frameRateLimit: 30
                metadataMode: true
                statisticsMode: true
                diagnosticsMode: false
                debugMode: false
                readOnly: false
                autoStart: true
                autoRestart: false
                systemInstance: false
                inputPixelLimit: 1920
                inputOrientation: 0
                detectorMode: "SmartDetection"
                detectionSensitivity: "Medium"
                movementSensitivity: "Low"
                sensorModality: "RGB"
                originator:
                  address: ""
        '400':
          description: Bad request (validation failed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for create instance
      operationId: createInstanceOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/input:
    post:
      summary: Set input source for an instance
      description: |
        Sets the input source configuration for an instance. Replaces the Input field in the Instance File according to the request.

        **Input Types:**
        - **RTSP**: Uses `rtsp_src` node for RTSP streams
        - **HLS**: Uses `hls_src` node for HLS streams
        - **Manual**: Uses `v4l2_src` node for V4L2 devices

        The instance must exist and not be read-only. If the instance is currently running, it will be automatically restarted to apply the changes.
      operationId: setInstanceInput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier of the instance (UUID)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetInputRequest'
            example:
              type: "Manual"
              uri: "http://localhost"
      responses:
        '204':
          description: Input settings updated successfully
        '400':
          description: Bad request (invalid input or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for set input
      operationId: setInstanceInputOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/config:
    get:
      summary: Get instance configuration
      description: |
        Returns the configuration of an instance. This endpoint provides the configuration settings of the instance, which are different from runtime state. Configuration includes settings like AutoRestart, AutoStart, Detector settings, Input configuration, etc.

        **Note:** This returns the configuration format, not the runtime state. For runtime state information, use the instance details endpoint.
      operationId: getConfig
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier of the instance (UUID)
          example: "291a85b8-d4c0-5765-dcb2-48c9b51f48d0"
      responses:
        '200':
          description: Instance configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceConfig'
              example:
                AutoRestart: false
                AutoStart: false
                Detector:
                  preset_values:
                    MosaicInference:
                      Detector/conf_threshold: 0.7
                DetectorRegions: {}
                DisplayName: "Test Instance"
                Input:
                  match_fps: true
                  media_format:
                    color_format: 0
                    default_format: true
                    height: 0
                    is_software: false
                    name: "Same as Source"
                  media_type: "Images"
                  output_fps: 8
                  uri: "https://some_uri"
                InstanceId: "291a85b8-d4c0-5765-dcb2-48c9b51f48d0"
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Set config value at a specific path
      description: |
        Sets a configuration value at the specified path. The path is a key in the configuration, and for nested structures, it will be nested keys separated by forward slashes "/".

        **Note:** This operation will overwrite the value at the given path.

        **Path Examples:**
        - Simple path: `"DisplayName"` - Sets top-level DisplayName
        - Nested path: `"Output/handlers/Mqtt"` - Sets Mqtt handler in Output.handlers

        **jsonValue Format:**
        - For string values: `"\"my string\""` (escaped JSON string)
        - For object values: `"{\"key\":\"value\"}"` (escaped JSON object)

        The instance must exist and not be read-only. If the instance is currently running, it will be automatically restarted to apply the changes.
      operationId: setConfig
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Unique identifier of the instance (UUID)
          example: "00000000-0000-0000-0000-000000000000"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetConfigRequest'
            examples:
              stringValue:
                summary: Set string value
                value:
                  path: "my/nested/path"
                  jsonValue: "\"my string\""
              objectValue:
                summary: Set object value
                value:
                  path: "Output/handlers/Mqtt"
                  jsonValue: "{\"uri\":\"mqtt://localhost:1883/events\"}"
      responses:
        '204':
          description: Config value set successfully
        '400':
          description: Bad request (invalid input or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for set config
      operationId: setConfigOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/statistics:
    get:
      summary: Get instance statistics
      description: |
        Returns real-time statistics for a specific instance. Statistics include frames processed, framerate, latency, resolution, and queue information.

        **Statistics Include:**
        - Frames processed count
        - Source framerate (FPS from source)
        - Current framerate (processing FPS)
        - Average latency (milliseconds)
        - Input queue size
        - Dropped frames count
        - Resolution and format information
        - Source resolution

        **Important Notes:**
        - Statistics are calculated in real-time
        - Statistics reset to 0 when instance is restarted
        - Statistics are not persisted (only calculated when requested)
        - Instance must be running to get statistics
      operationId: getStatistics
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: Instance ID (UUID)
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstanceStatisticsResponse'
              example:
                frames_processed: 1250
                source_framerate: 30.0
                current_framerate: 25.5
                latency: 200.0
                start_time: 1764900520
                input_queue_size: 2
                dropped_frames_count: 5
                resolution: "1280x720"
                format: "BGR"
                source_resolution: "1920x1080"
        '404':
          description: Instance not found or not running
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error: "Not found"
                message: "Instance not found or not running: a5204fc9-9a59-f80f-fb9f-bf3b42214943"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for get statistics
      operationId: getStatisticsOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/output/stream:
    get:
      summary: Get stream output configuration
      description: |
        Returns the current stream output configuration for an instance. This endpoint retrieves the stream output settings including whether it is enabled and the configured URI.

        **Response Format:**
        - `enabled`: Boolean indicating whether stream output is enabled
        - `uri`: The configured stream URI (empty string if disabled)

        The URI can be in one of the following formats:
        - **RTMP**: `rtmp://host:port/path/stream_key`
        - **RTSP**: `rtsp://host:port/path/stream_key`
        - **HLS**: `hls://host:port/path/stream_key`
      operationId: getStreamOutput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      responses:
        '200':
          description: Stream output configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StreamOutputResponse'
              examples:
                enabled:
                  summary: Stream output enabled
                  value:
                    enabled: true
                    uri: "rtmp://localhost:1935/live/stream"
                disabled:
                  summary: Stream output disabled
                  value:
                    enabled: false
                    uri: ""
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Configure stream/record output
      description: |
        Configures stream or record output for an instance. This endpoint allows you to enable or disable output and set either a stream URI or a local path for recording.

        **Record Output Mode (using `path` parameter):**
        - When `enabled` is `true` and `path` is provided, video will be saved as MP4 files to the specified local directory
        - The path must exist and have write permissions (will be created if it doesn't exist)
        - Uses `rtmp_des_node` to push data to local stream
        - Files are saved in MP4 format to the specified path

        **Stream Output Mode (using `uri` parameter):**
        - **RTMP**: `rtmp://host:port/path/stream_key` - For RTMP streaming (e.g., to MediaMTX, YouTube Live, etc.)
        - **RTSP**: `rtsp://host:port/path/stream_key` - For RTSP streaming
        - **HLS**: `hls://host:port/path/stream_key` - For HLS streaming

        **Behavior:**
        - When `enabled` is `true`, either `path` (for record output) or `uri` (for stream output) field is required
        - When `enabled` is `false`, output is disabled
        - If the instance is currently running, it will be automatically restarted to apply the changes
        - The stream output uses the `rtmp_des_node` in the pipeline

        **MediaMTX Setup:**
        - For local streaming, ensure MediaMTX is installed and running: https://github.com/bluenviron/mediamtx
        - Default MediaMTX RTMP endpoint: `rtmp://localhost:1935/live/stream`
        - Default MediaMTX RTSP endpoint: `rtsp://localhost:8554/live/stream"
      operationId: configureStreamOutput
      tags:
        - Instances
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigureStreamOutputRequest'
            examples:
              enableRecordOutput:
                summary: Enable record output to local path
                value:
                  enabled: true
                  path: "/mnt/sb1/data"
              enableLocalRTMP:
                summary: Enable local RTMP stream
                value:
                  enabled: true
                  uri: "rtmp://localhost:1935/live/stream"
              enableRemoteRTMP:
                summary: Enable remote RTMP stream
                value:
                  enabled: true
                  uri: "rtmp://localhost:1935/live/stream"
              disableStream:
                summary: Disable stream/record output
                value:
                  enabled: false
      responses:
        '204':
          description: Successfully configured stream output
        '400':
          description: Bad request (invalid input or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for stream output endpoints
      operationId: streamOutputOptions
      tags:
        - Instances
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/lines:
    get:
      summary: Get all crossing lines
      description: |
        Returns all crossing lines configured for a ba_crossline instance.
        Lines are used for counting objects crossing a defined line in the video stream.
      operationId: getAllLines
      tags:
        - Lines
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      responses:
        '200':
          description: List of crossing lines
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LinesResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new crossing line
      description: |
        Creates a new crossing line for a ba_crossline instance.
        The line will be drawn on the video stream and used for counting objects.

        **Real-time Update:** The line is immediately applied to the running video stream without requiring instance restart.
      operationId: createLine
      tags:
        - Lines
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLineRequest'
            examples:
              simpleLine:
                summary: Simple two-point line
                value:
                  name: "Counting Line 1"
                  coordinates:
                    - x: 100.0
                      y: 300.0
                    - x: 600.0
                      y: 300.0
                  direction: "Both"
                  classes: ["Person", "Vehicle"]
                  color: [255, 0, 0, 255]
      responses:
        '201':
          description: Line created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrossingLine'
        '400':
          description: Bad request (invalid coordinates or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete all crossing lines
      description: |
        Deletes all crossing lines for a ba_crossline instance.

        **Real-time Update:** Lines are immediately removed from the running video stream without requiring instance restart.
      operationId: deleteAllLines
      tags:
        - Lines
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
      responses:
        '200':
          description: All lines deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "All lines deleted successfully"
        '404':
          description: Instance not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for lines endpoints
      operationId: linesOptions
      tags:
        - Lines
      responses:
        '200':
          description: CORS preflight response

  /v1/core/instances/{instanceId}/lines/{lineId}:
    get:
      summary: Get a specific crossing line
      description: |
        Returns a specific crossing line by ID for a ba_crossline instance.
      operationId: getLine
      tags:
        - Lines
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
        - name: lineId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the line to retrieve
          example: "b1234567-89ab-cdef-0123-456789abcdef"
      responses:
        '200':
          description: Line retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrossingLine'
        '404':
          description: Instance or line not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update a specific crossing line
      description: |
        Updates a specific crossing line by ID for a ba_crossline instance.
        The line will be updated on the video stream and used for counting objects.

        **Real-time Update:** The line is immediately applied to the running video stream without requiring instance restart.
      operationId: updateLine
      tags:
        - Lines
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
        - name: lineId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the line to update
          example: "b1234567-89ab-cdef-0123-456789abcdef"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLineRequest'
            examples:
              updateLine:
                summary: Update line coordinates and direction
                value:
                  name: "Updated Counting Line"
                  coordinates:
                    - x: 200.0
                      y: 400.0
                    - x: 700.0
                      y: 400.0
                  direction: "Up"
                  classes: ["Person", "Vehicle"]
                  color: [0, 255, 0, 255]
      responses:
        '200':
          description: Line updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrossingLine'
        '400':
          description: Bad request (invalid coordinates or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Instance or line not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a specific crossing line
      description: |
        Deletes a specific crossing line by ID.

        **Real-time Update:** The line is immediately removed from the running video stream without requiring instance restart.
      operationId: deleteLine
      tags:
        - Lines
      parameters:
        - name: instanceId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the instance
          example: "a5204fc9-9a59-f80f-fb9f-bf3b42214943"
        - name: lineId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the line to delete
          example: "b1234567-89ab-cdef-0123-456789abcdef"
      responses:
        '200':
          description: Line deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Line deleted successfully"
        '404':
          description: Instance or line not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for line endpoints
      operationId: lineOptions
      tags:
        - Lines
      responses:
        '200':
          description: CORS preflight response

  /v1/core/solutions:
    get:
      summary: List all solutions
      description: Returns a list of all available solutions with summary information including solution type and pipeline node count.
      operationId: listSolutions
      tags:
        - Solutions
      responses:
        '200':
          description: List of solutions
          content:
            application/json:
              schema:
                type: object
                properties:
                  solutions:
                    type: array
                    items:
                      $ref: '#/components/schemas/SolutionSummary'
                  total:
                    type: integer
                    description: Total number of solutions
                  default:
                    type: integer
                    description: Number of default solutions
                  custom:
                    type: integer
                    description: Number of custom solutions
              example:
                total: 2
                default: 1
                custom: 1
                solutions:
                  - solutionId: "face_detection"
                    solutionName: "Face Detection"
                    solutionType: "face_detection"
                    isDefault: true
                    pipelineNodeCount: 3
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new solution
      description: Creates a new custom solution configuration. Custom solutions can be modified and deleted, unlike default solutions.
      operationId: createSolution
      tags:
        - Solutions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSolutionRequest'
            example:
              solutionId: "custom_face_detection"
              solutionName: "Custom Face Detection"
              solutionType: "face_detection"
              pipeline:
                - nodeType: "rtsp_src"
                  nodeName: "source_{instanceId}"
                  parameters:
                    url: "rtsp://localhost/stream"
                - nodeType: "yunet_face_detector"
                  nodeName: "detector_{instanceId}"
                  parameters:
                    model_path: "models/face/yunet.onnx"
                - nodeType: "file_des"
                  nodeName: "output_{instanceId}"
                  parameters:
                    output_path: "/tmp/output"
              defaults:
                RTSP_URL: "rtsp://localhost/stream"
      responses:
        '201':
          description: Solution created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SolutionConfig'
        '400':
          description: Bad request (validation failed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Solution already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for solutions
      operationId: listSolutionsOptions
      tags:
        - Solutions
      responses:
        '200':
          description: CORS preflight response

  /v1/core/solutions/{solutionId}:
    get:
      summary: Get solution details
      description: Returns detailed information about a specific solution including full pipeline configuration.
      operationId: getSolution
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      responses:
        '200':
          description: Solution details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SolutionConfig'
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update a solution
      description: Updates an existing custom solution configuration. Default solutions cannot be updated.
      operationId: updateSolution
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSolutionRequest'
      responses:
        '200':
          description: Solution updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SolutionConfig'
        '400':
          description: Bad request (validation failed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Cannot update default solution
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a solution
      description: Deletes a custom solution. Default solutions cannot be deleted.
      operationId: deleteSolution
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      responses:
        '200':
          description: Solution deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  solutionId:
                    type: string
        '403':
          description: Cannot delete default solution
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for solution
      operationId: getSolutionOptions
      tags:
        - Solutions
      responses:
        '200':
          description: CORS preflight response

  /v1/core/solutions/{solutionId}/parameters:
    get:
      summary: Get solution parameter schema
      description: |
        Returns the parameter schema required to create an instance with this solution.
        This includes:
        - **Additional Parameters**: Solution-specific parameters extracted from pipeline nodes (e.g., RTSP_URL, MODEL_PATH, FILE_PATH)
        - **Standard Fields**: Common instance creation fields (name, group, persistent, autoStart, etc.)

        Parameters marked as required must be provided in the `additionalParams` object when creating an instance.
        Parameters with default values are optional.
      operationId: getSolutionParameters
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      responses:
        '200':
          description: Solution parameter schema
          content:
            application/json:
              schema:
                type: object
                properties:
                  solutionId:
                    type: string
                    description: Solution ID
                    example: "face_detection"
                  solutionName:
                    type: string
                    description: Solution display name
                    example: "Face Detection"
                  solutionType:
                    type: string
                    description: Solution type
                    example: "face_detection"
                  pipeline:
                    type: array
                    description: Pipeline nodes with detailed parameter information
                    items:
                      type: object
                      properties:
                        nodeType:
                          type: string
                          description: Node type identifier
                          example: "rtsp_src"
                        nodeName:
                          type: string
                          description: Node name template
                          example: "source_{instanceId}"
                        displayName:
                          type: string
                          description: Node display name
                          example: "RTSP Source"
                        description:
                          type: string
                          description: Node description
                          example: "Receive video stream from RTSP URL"
                        category:
                          type: string
                          description: Node category
                          enum: ["source", "detector", "processor", "destination", "broker"]
                          example: "source"
                        requiredParameters:
                          type: array
                          description: Required parameters for this node type
                          items:
                            type: string
                          example: ["rtsp_url"]
                        optionalParameters:
                          type: array
                          description: Optional parameters for this node type
                          items:
                            type: string
                          example: ["channel", "resize_ratio"]
                        defaultParameters:
                          type: object
                          description: Default parameter values
                          additionalProperties:
                            type: string
                          example:
                            channel: "0"
                            resize_ratio: "1.0"
                        parameters:
                          type: object
                          description: Current parameter values in solution
                          additionalProperties:
                            type: string
                          example:
                            rtsp_url: "${RTSP_URL}"
                    example:
                      - nodeType: "rtsp_src"
                        nodeName: "source_{instanceId}"
                        displayName: "RTSP Source"
                        description: "Receive video stream from RTSP URL"
                        category: "source"
                        requiredParameters: ["rtsp_url"]
                        optionalParameters: ["channel", "resize_ratio"]
                        defaultParameters:
                          channel: "0"
                          resize_ratio: "1.0"
                        parameters:
                          rtsp_url: "${RTSP_URL}"
                  additionalParams:
                    type: object
                    description: Solution-specific parameters extracted from pipeline nodes
                    additionalProperties:
                      type: object
                      properties:
                        name:
                          type: string
                          description: Parameter name
                        type:
                          type: string
                          description: Parameter type
                          example: "string"
                        required:
                          type: boolean
                          description: Whether this parameter is required
                        default:
                          type: string
                          description: Default value if available
                        description:
                          type: string
                          description: Parameter description
                        usedInNodes:
                          type: array
                          description: List of node types that use this parameter
                          items:
                            type: string
                          example: ["rtsp_src", "rtmp_src"]
                    example:
                      RTSP_URL:
                        name: "RTSP_URL"
                        type: "string"
                        required: true
                        description: "URL for rtsp_src node"
                      MODEL_PATH:
                        name: "MODEL_PATH"
                        type: "string"
                        required: false
                        default: "./models/default.onnx"
                        description: "File path for yunet_face_detector node"
                  requiredAdditionalParams:
                    type: array
                    description: List of required additional parameter names
                    items:
                      type: string
                    example: ["RTSP_URL"]
                  standardFields:
                    type: object
                    description: Standard instance creation fields
                    additionalProperties:
                      type: object
                      properties:
                        type:
                          type: string
                          description: Field type
                        required:
                          type: boolean
                          description: Whether this field is required
                        default:
                          description: Default value
                        description:
                          type: string
                          description: Field description
                        pattern:
                          type: string
                          description: Validation pattern (for strings)
                        enum:
                          type: array
                          description: Allowed values (for enums)
                          items:
                            type: string
                        minimum:
                          type: number
                          description: Minimum value (for numbers)
                    example:
                      name:
                        type: "string"
                        required: true
                        description: "Instance name (pattern: ^[A-Za-z0-9 -_]+$)"
                        pattern: "^[A-Za-z0-9 -_]+$"
                      group:
                        type: "string"
                        required: false
                        description: "Group name (pattern: ^[A-Za-z0-9 -_]+$)"
                        pattern: "^[A-Za-z0-9 -_]+$"
                      persistent:
                        type: "boolean"
                        required: false
                        default: false
                        description: "Save instance to JSON file"
                      autoStart:
                        type: "boolean"
                        required: false
                        default: false
                        description: "Automatically start instance when created"
                  requiredStandardFields:
                    type: array
                    description: List of required standard field names
                    items:
                      type: string
                    example: ["name"]
              example:
                solutionId: "face_detection"
                solutionName: "Face Detection"
                solutionType: "face_detection"
                pipeline:
                  - nodeType: "rtsp_src"
                    nodeName: "source_{instanceId}"
                    displayName: "RTSP Source"
                    description: "Receive video stream from RTSP URL"
                    category: "source"
                    requiredParameters: ["rtsp_url"]
                    optionalParameters: ["channel", "resize_ratio"]
                    defaultParameters:
                      channel: "0"
                      resize_ratio: "1.0"
                    parameters:
                      rtsp_url: "${RTSP_URL}"
                  - nodeType: "yunet_face_detector"
                    nodeName: "detector_{instanceId}"
                    displayName: "YuNet Face Detector"
                    description: "Detect faces using YuNet model"
                    category: "detector"
                    requiredParameters: ["model_path"]
                    optionalParameters: ["score_threshold", "nms_threshold", "top_k"]
                    defaultParameters:
                      score_threshold: "0.7"
                      nms_threshold: "0.5"
                      top_k: "50"
                    parameters:
                      model_path: "${MODEL_PATH}"
                additionalParams:
                  RTSP_URL:
                    name: "RTSP_URL"
                    type: "string"
                    required: true
                    description: "Required parameter for rtsp_src (rtsp_url)"
                    usedInNodes: ["rtsp_src"]
                  MODEL_PATH:
                    name: "MODEL_PATH"
                    type: "string"
                    required: true
                    description: "Required parameter for yunet_face_detector (model_path)"
                    usedInNodes: ["yunet_face_detector"]
                requiredAdditionalParams:
                  - "RTSP_URL"
                standardFields:
                  name:
                    type: "string"
                    required: true
                    description: "Instance name (pattern: ^[A-Za-z0-9 -_]+$)"
                    pattern: "^[A-Za-z0-9 -_]+$"
                  group:
                    type: "string"
                    required: false
                    description: "Group name (pattern: ^[A-Za-z0-9 -_]+$)"
                    pattern: "^[A-Za-z0-9 -_]+$"
                  persistent:
                    type: "boolean"
                    required: false
                    default: false
                    description: "Save instance to JSON file"
                  autoStart:
                    type: "boolean"
                    required: false
                    default: false
                    description: "Automatically start instance when created"
                requiredStandardFields:
                  - "name"
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for solution parameters
      operationId: getSolutionParametersOptions
      tags:
        - Solutions
      responses:
        '200':
          description: CORS preflight response

  /v1/core/solutions/{solutionId}/instance-body:
    get:
      summary: Get example instance creation body
      description: |
        Returns an example request body for creating an instance with this solution.
        This includes:
        - **Standard Fields**: Common instance creation fields with default values
        - **Additional Parameters**: Solution-specific parameters with example values based on parameter names

        Users can copy this body, modify the values, and use it to create an instance via POST /v1/core/instance.
      operationId: getSolutionInstanceBody
      tags:
        - Solutions
      parameters:
        - name: solutionId
          in: path
          required: true
          schema:
            type: string
          description: Solution ID
      responses:
        '200':
          description: Example instance creation body
          content:
            application/json:
              schema:
                type: object
                properties:
                  solutionId:
                    type: string
                    description: Solution ID
                    example: "face_detection"
                  solutionName:
                    type: string
                    description: Solution display name
                    example: "Face Detection"
                  description:
                    type: string
                    description: Description of the response
                    example: "Example request body for creating an instance with this solution"
                  requestBody:
                    type: object
                    description: Example request body for creating an instance
                    properties:
                      name:
                        type: string
                        description: Instance name
                        example: "example_instance"
                      group:
                        type: string
                        description: Group name
                        example: "default"
                      solution:
                        type: string
                        description: Solution ID
                        example: "face_detection"
                      persistent:
                        type: boolean
                        description: Save instance to JSON file
                        example: false
                      autoStart:
                        type: boolean
                        description: Automatically start instance when created
                        example: false
                      frameRateLimit:
                        type: integer
                        description: Frame rate limit (FPS)
                        example: 0
                      detectionSensitivity:
                        type: string
                        enum: ["Low", "Medium", "High", "Normal", "Slow"]
                        description: Detection sensitivity level
                        example: "Low"
                      detectorMode:
                        type: string
                        enum: ["SmartDetection", "FullRegionInference", "MosaicInference"]
                        description: Detector mode
                        example: "SmartDetection"
                      metadataMode:
                        type: boolean
                        description: Enable metadata mode
                        example: false
                      statisticsMode:
                        type: boolean
                        description: Enable statistics mode
                        example: false
                      diagnosticsMode:
                        type: boolean
                        description: Enable diagnostics mode
                        example: false
                      debugMode:
                        type: boolean
                        description: Enable debug mode
                        example: false
                      additionalParams:
                        type: object
                        description: Solution-specific parameters with example values
                        additionalProperties:
                          type: string
                        example:
                          RTSP_URL: "rtsp://example.com/stream"
                          MODEL_PATH: "./models/example.model"
                  note:
                    type: string
                    description: Note for users
                    example: "Replace example values with actual values before creating instance"
              example:
                solutionId: "face_detection"
                solutionName: "Face Detection"
                description: "Example request body for creating an instance with this solution"
                requestBody:
                  name: "example_instance"
                  group: "default"
                  solution: "face_detection"
                  persistent: false
                  autoStart: false
                  frameRateLimit: 0
                  detectionSensitivity: "Low"
                  detectorMode: "SmartDetection"
                  metadataMode: false
                  statisticsMode: false
                  diagnosticsMode: false
                  debugMode: false
                  additionalParams:
                    RTSP_URL: "rtsp://example.com/stream"
                    MODEL_PATH: "./models/face/yunet.onnx"
                note: "Replace example values with actual values before creating instance"
        '404':
          description: Solution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for solution instance body
      operationId: getSolutionInstanceBodyOptions
      tags:
        - Solutions
      responses:
        '200':
          description: CORS preflight response

  /v1/core/nodes:
    get:
      summary: List all pre-configured nodes
      description: |
        Returns a list of all pre-configured nodes in the node pool.
        Can be filtered by availability status and category.
      operationId: listNodes
      tags:
        - Node
      parameters:
        - name: available
          in: query
          required: false
          schema:
            type: string
            enum: ["true", "false", "1", "0"]
          description: Filter to show only available (not in use) nodes
          example: "true"
        - name: category
          in: query
          required: false
          schema:
            type: string
            enum: ["source", "detector", "processor", "destination", "broker"]
          description: Filter nodes by category
          example: "source"
      responses:
        '200':
          description: List of nodes retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeListResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new pre-configured node
      description: Creates a new pre-configured node from a template with specified parameters
      operationId: createNode
      tags:
        - Node
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateNodeRequest'
      responses:
        '201':
          description: Node created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeResponse'
        '400':
          description: Bad request (missing required fields or invalid parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for nodes
      operationId: listNodesOptions
      tags:
        - Node
      responses:
        '200':
          description: CORS preflight response

  /v1/core/nodes/{nodeId}:
    get:
      summary: Get node details
      description: Returns detailed information about a specific pre-configured node
      operationId: getNode
      tags:
        - Node
      parameters:
        - name: nodeId
          in: path
          required: true
          schema:
            type: string
          description: Unique node identifier
          example: "node_a1b2c3d4"
      responses:
        '200':
          description: Node details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeResponse'
        '404':
          description: Node not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update a node
      description: |
        Updates an existing node's parameters. Only nodes that are not currently in use can be updated.
        Note: Update operation deletes the old node and creates a new one with updated parameters.
      operationId: updateNode
      tags:
        - Node
      parameters:
        - name: nodeId
          in: path
          required: true
          schema:
            type: string
          description: Unique node identifier
          example: "node_a1b2c3d4"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNodeRequest'
      responses:
        '200':
          description: Node updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeResponse'
        '400':
          description: Bad request (missing parameters field)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Node not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Conflict (node is currently in use)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a node
      description: Deletes a pre-configured node. Only nodes that are not currently in use can be deleted.
      operationId: deleteNode
      tags:
        - Node
      parameters:
        - name: nodeId
          in: path
          required: true
          schema:
            type: string
          description: Unique node identifier
          example: "node_a1b2c3d4"
      responses:
        '200':
          description: Node deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Node deleted successfully"
                  nodeId:
                    type: string
                    example: "node_a1b2c3d4"
        '404':
          description: Node not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Conflict (node is currently in use)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for node
      operationId: getNodeOptions
      tags:
        - Node
      responses:
        '200':
          description: CORS preflight response

  /v1/core/nodes/templates:
    get:
      summary: List all node templates
      description: |
        Returns a list of all available node templates that can be used to create pre-configured nodes.

        **Available Node Types:**

        **Source Nodes:**
        - `rtsp_src` - RTSP Source
        - `file_src` - File Source
        - `app_src` - App Source
        - `image_src` - Image Source
        - `rtmp_src` - RTMP Source
        - `udp_src` - UDP Source

        **Detector Nodes:**
        - `yunet_face_detector` - YuNet Face Detector
        - `yolo_detector` - YOLO Detector
        - `yolov11_detector` - YOLOv11 Detector
        - `mask_rcnn_detector` - Mask R-CNN Detector
        - `openpose_detector` - OpenPose Detector
        - `enet_seg` - ENet Segmentation
        - `trt_yolov8_detector` - TensorRT YOLOv8 Detector (requires CVEDIX_WITH_TRT)
        - `trt_yolov8_seg_detector` - TensorRT YOLOv8 Segmentation (requires CVEDIX_WITH_TRT)
        - `trt_yolov8_pose_detector` - TensorRT YOLOv8 Pose (requires CVEDIX_WITH_TRT)
        - `trt_yolov8_classifier` - TensorRT YOLOv8 Classifier (requires CVEDIX_WITH_TRT)
        - `trt_vehicle_detector` - TensorRT Vehicle Detector (requires CVEDIX_WITH_TRT)
        - `trt_vehicle_plate_detector` - TensorRT Vehicle Plate Detector (requires CVEDIX_WITH_TRT)
        - `trt_vehicle_plate_detector_v2` - TensorRT Vehicle Plate Detector v2 (requires CVEDIX_WITH_TRT)
        - `trt_insight_face_recognition` - TensorRT InsightFace Recognition (requires CVEDIX_WITH_TRT)
        - `rknn_yolov8_detector` - RKNN YOLOv8 Detector (requires CVEDIX_WITH_RKNN)
        - `rknn_yolov11_detector` - RKNN YOLOv11 Detector (requires CVEDIX_WITH_RKNN)
        - `rknn_face_detector` - RKNN Face Detector (requires CVEDIX_WITH_RKNN)
        - `ppocr_text_detector` - PaddleOCR Text Detector (requires CVEDIX_WITH_PADDLE)
        - `face_swap` - Face Swap
        - `insight_face_recognition` - InsightFace Recognition
        - `mllm_analyser` - MLLM Analyser

        **Processor Nodes:**
        - `sface_feature_encoder` - SFace Feature Encoder
        - `sort_track` - SORT Tracker
        - `face_osd_v2` - Face OSD v2
        - `ba_crossline` - BA Crossline
        - `ba_crossline_osd` - BA Crossline OSD
        - `classifier` - Classifier
        - `lane_detector` - Lane Detector
        - `restoration` - Restoration
        - `trt_vehicle_feature_encoder` - TensorRT Vehicle Feature Encoder (requires CVEDIX_WITH_TRT)
        - `trt_vehicle_color_classifier` - TensorRT Vehicle Color Classifier (requires CVEDIX_WITH_TRT)
        - `trt_vehicle_type_classifier` - TensorRT Vehicle Type Classifier (requires CVEDIX_WITH_TRT)
        - `trt_vehicle_scanner` - TensorRT Vehicle Scanner (requires CVEDIX_WITH_TRT)

        **Destination Nodes:**
        - `file_des` - File Destination
        - `rtmp_des` - RTMP Destination
        - `screen_des` - Screen Destination

        **Broker Nodes:**
        - `json_console_broker` - JSON Console Broker
        - `json_enhanced_console_broker` - JSON Enhanced Console Broker
        - `json_mqtt_broker` - JSON MQTT Broker (requires CVEDIX_WITH_MQTT)
        - `json_kafka_broker` - JSON Kafka Broker (requires CVEDIX_WITH_KAFKA)
        - `xml_file_broker` - XML File Broker
        - `xml_socket_broker` - XML Socket Broker
        - `msg_broker` - Message Broker
        - `ba_socket_broker` - BA Socket Broker
        - `embeddings_socket_broker` - Embeddings Socket Broker
        - `embeddings_properties_socket_broker` - Embeddings Properties Socket Broker
        - `plate_socket_broker` - Plate Socket Broker
        - `expr_socket_broker` - Expression Socket Broker

        All node templates are automatically imported from CVEDIX SDK nodes available in `/opt/cvedix/include/cvedix/nodes/infers`.
      operationId: listTemplates
      tags:
        - Node
      responses:
        '200':
          description: List of templates retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateListResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for templates
      operationId: listTemplatesOptions
      tags:
        - Node
      responses:
        '200':
          description: CORS preflight response

  /v1/core/nodes/templates/{templateId}:
    get:
      summary: Get template details
      description: Returns detailed information about a specific node template
      operationId: getTemplate
      tags:
        - Node
      parameters:
        - name: templateId
          in: path
          required: true
          schema:
            type: string
          description: Unique template identifier
          example: "rtsp_src_template"
      responses:
        '200':
          description: Template details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateResponse'
        '404':
          description: Template not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for template
      operationId: getTemplateOptions
      tags:
        - Node
      responses:
        '200':
          description: CORS preflight response

  /v1/core/nodes/stats:
    get:
      summary: Get node pool statistics
      description: Returns statistics about the node pool including total templates, total nodes, available nodes, and nodes by category
      operationId: getNodeStats
      tags:
        - Node
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeStatsResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight for stats
      operationId: getNodeStatsOptions
      tags:
        - Node
      responses:
        '200':
          description: CORS preflight response

components:
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
        - uptime
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
          description: Health status of the service
          example: "healthy"
        timestamp:
          type: string
          format: date-time
          description: Current timestamp in ISO 8601 format
          example: "2024-01-01T00:00:00.000Z"
        uptime:
          type: integer
          format: int64
          description: Service uptime in seconds
          example: 3600
        service:
          type: string
          description: Service name
          example: "edge_ai_api"
        version:
          type: string
          description: Service version
          example: "1.0.0"

    StatusResponse:
      type: object
      required:
        - total
        - configured
        - running
        - stopped
        - timestamp
      properties:
        total:
          type: integer
          description: Total number of configured instances
          example: 5
        configured:
          type: integer
          description: Number of configured instances (same as total)
          example: 5
        running:
          type: integer
          description: Number of instances currently running
          example: 3
        stopped:
          type: integer
          description: Number of instances currently stopped
          example: 2
        timestamp:
          type: string
          format: date-time
          description: Current timestamp in ISO 8601 format
          example: "2024-01-01T00:00:00.000Z"

    VersionResponse:
      type: object
      required:
        - version
        - api_version
        - service
      properties:
        version:
          type: string
          description: Application version
          example: "1.0.0"
        build_time:
          type: string
          description: Build timestamp
          example: "Jan 01 2024 00:00:00"
        git_commit:
          type: string
          description: Git commit hash
          example: "abc123def456"
        api_version:
          type: string
          description: API version
          example: "v1"
        service:
          type: string
          description: Service name
          example: "edge_ai_api"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
        code:
          type: integer
          description: Error code
        message:
          type: string
          description: Detailed error message

    LogFileInfo:
      type: object
      required:
        - date
        - size
        - path
      properties:
        date:
          type: string
          format: date
          description: Date of the log file (YYYY-MM-DD)
          example: "2024-01-01"
        size:
          type: integer
          format: int64
          description: Size of the log file in bytes
          example: 1024
        path:
          type: string
          description: Full path to the log file
          example: "/var/log/edge_ai_api/api_2024-01-01.log"

    LogFilesResponse:
      type: object
      required:
        - categories
      properties:
        categories:
          type: object
          description: Log files organized by category
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/LogFileInfo'
          example:
            api:
              - date: "2024-01-01"
                size: 1024
                path: "/var/log/edge_ai_api/api_2024-01-01.log"
            instance:
              - date: "2024-01-01"
                size: 2048
                path: "/var/log/edge_ai_api/instance_2024-01-01.log"

    LogEntry:
      type: object
      required:
        - timestamp
        - level
        - message
      properties:
        timestamp:
          type: string
          format: date-time
          description: Log timestamp in ISO 8601 format
          example: "2024-01-01T12:00:00.000Z"
        level:
          type: string
          description: Log level (INFO, ERROR, WARNING, DEBUG, etc.)
          example: "INFO"
        message:
          type: string
          description: Log message
          example: "API request received"

    LogsResponse:
      type: object
      required:
        - category
        - category_dir
        - files_count
        - total_lines
        - filtered_lines
        - logs
      properties:
        category:
          type: string
          description: Log category
          example: "api"
        category_dir:
          type: string
          description: Directory path for this category
          example: "/var/log/edge_ai_api/api"
        files_count:
          type: integer
          description: Number of log files in this category
          example: 1
        total_lines:
          type: integer
          description: Total number of log lines before filtering
          example: 1000
        filtered_lines:
          type: integer
          description: Number of log lines after filtering
          example: 500
        logs:
          type: array
          description: Array of log entries
          items:
            $ref: '#/components/schemas/LogEntry'

    LogsByDateResponse:
      type: object
      required:
        - category
        - date
        - total_lines
        - filtered_lines
        - logs
      properties:
        category:
          type: string
          description: Log category
          example: "api"
        date:
          type: string
          format: date
          description: Date of the log file (YYYY-MM-DD)
          example: "2024-01-01"
        total_lines:
          type: integer
          description: Total number of log lines before filtering
          example: 1000
        filtered_lines:
          type: integer
          description: Number of log lines after filtering
          example: 500
        logs:
          type: array
          description: Array of log entries
          items:
            $ref: '#/components/schemas/LogEntry'

    SetInputRequest:
      type: object
      required:
        - type
        - uri
      properties:
        type:
          type: string
          description: Type of input source
          enum: [RTSP, HLS, Manual]
          example: "Manual"
        uri:
          type: string
          format: uri
          description: URI of the input source (must be valid)
          example: "http://localhost"

    InstanceConfig:
      type: object
      description: Instance configuration (config format, not runtime state)
      properties:
        InstanceId:
          type: string
          description: Unique identifier of the instance (UUID)
          example: "291a85b8-d4c0-5765-dcb2-48c9b51f48d0"
        DisplayName:
          type: string
          description: Display name of the instance
          example: "Test Instance"
        AutoStart:
          type: boolean
          description: Whether the instance should automatically start on system boot
          example: false
        AutoRestart:
          type: boolean
          description: Whether the instance should automatically restart on failure
          example: false
        Detector:
          type: object
          description: Detector configuration
          properties:
            preset_values:
              type: object
              description: Preset values for different detector modes
              additionalProperties:
                type: object
          example:
            preset_values:
              MosaicInference:
                Detector/conf_threshold: 0.7
        DetectorRegions:
          type: object
          description: Detector regions configuration
          additionalProperties: true
        Input:
          type: object
          description: Input source configuration
          properties:
            match_fps:
              type: boolean
              description: Whether to match FPS
            media_format:
              type: object
              properties:
                color_format:
                  type: integer
                default_format:
                  type: boolean
                height:
                  type: integer
                is_software:
                  type: boolean
                name:
                  type: string
            media_type:
              type: string
              description: Type of media input (e.g., "Images", "IP Camera", "File")
            output_fps:
              type: integer
              description: Output FPS
            uri:
              type: string
              description: URI of the input source
          example:
            match_fps: true
            media_format:
              color_format: 0
              default_format: true
              height: 0
              is_software: false
              name: "Same as Source"
            media_type: "Images"
            output_fps: 8
            uri: "https://some_uri"
      required:
        - InstanceId

    SetConfigRequest:
      type: object
      required:
        - path
        - jsonValue
      properties:
        path:
          type: string
          description: |
            The key for which the config value is to be updated. For nested structures, use forward slashes "/" as separators.
            Examples: "DisplayName", "Output/handlers/Mqtt", "Detector/conf_threshold"
          example: "Output/handlers/Mqtt"
        jsonValue:
          type: string
          description: |
            A string containing a JSON value or object. Ensure proper escaping for strings or objects.
            - For string values: "\"my string\"" (escaped JSON string)
            - For object values: "{\"key\":\"value\"}" (escaped JSON object)
          example: "{\"uri\":\"mqtt://localhost:1883/events\"}"

    ConfigureStreamOutputRequest:
      type: object
      required:
        - enabled
      properties:
        enabled:
          type: boolean
          description: Indicates whether stream/record output is enabled
          example: true
        path:
          type: string
          description: |
            The requested path to save output video MP4 files. Required when enabled is true and using record output mode.
            The path must be a directory that exists or can be created, and must have write permissions.
            Directory will be created automatically if it doesn't exist.
          example: "/mnt/sb1/data"
        uri:
          type: string
          format: uri
          description: |
            The requested URI for the stream output. Required when enabled is true and using stream output mode.
            Must start with rtmp://, rtsp://, or hls://
            Either `path` (for record output) or `uri` (for stream output) must be provided when enabled is true.
          example: "rtmp://localhost:1935/live/stream"

    StreamOutputResponse:
      type: object
      required:
        - enabled
        - uri
      properties:
        enabled:
          type: boolean
          description: Indicates whether stream output is enabled
          example: true
        uri:
          type: string
          format: uri
          description: |
            The configured URI for the stream output. Empty string if disabled.
            Can be rtmp://, rtsp://, or hls:// format
          example: "rtmp://localhost:1935/live/stream"

    SystemInfoResponse:
      type: object
      description: System hardware information
      properties:
        cpu:
          type: object
          properties:
            vendor:
              type: string
              example: "GenuineIntel"
            model:
              type: string
              example: "Intel(R) Core(TM) i7-10700K CPU @ 3.80GHz"
            physical_cores:
              type: integer
              example: 8
            logical_cores:
              type: integer
              example: 16
            max_frequency:
              type: integer
              description: Maximum frequency in MHz
              example: 3792
            regular_frequency:
              type: integer
              description: Regular frequency in MHz
              example: 3792
            min_frequency:
              type: integer
              description: Minimum frequency in MHz (-1 if not available)
              example: -1
            current_frequency:
              type: integer
              description: Current frequency in MHz (-1 if not available)
              example: 3792
            cache_size:
              type: integer
              format: int64
              description: Cache size in bytes
              example: 16777216
        ram:
          type: object
          properties:
            vendor:
              type: string
              example: "Corsair"
            model:
              type: string
              example: "CMK32GX4M2Z3600C18"
            name:
              type: string
              example: "Physical Memory"
            serial_number:
              type: string
              example: "N/A"
            size_mib:
              type: integer
              format: int64
              description: Total size in MiB
              example: 65437
            free_mib:
              type: integer
              format: int64
              description: Free memory in MiB
              example: 54405
            available_mib:
              type: integer
              format: int64
              description: Available memory in MiB
              example: 54405
        gpu:
          type: array
          items:
            type: object
            properties:
              vendor:
                type: string
                example: "NVIDIA"
              model:
                type: string
                example: "NVIDIA GeForce RTX 3070 Ti"
              driver_version:
                type: string
                example: "31.0.15.2698"
              memory_mib:
                type: integer
                format: int64
                description: Memory size in MiB
                example: 8190
              min_frequency:
                type: integer
                example: -1
              current_frequency:
                type: integer
                description: Current frequency in MHz
                example: 0
              max_frequency:
                type: integer
                example: -1
        disk:
          type: array
          items:
            type: object
            properties:
              vendor:
                type: string
                example: "(Standard disk drives)"
              model:
                type: string
                example: "WD_BLACK SN850 Heatsink 1TB"
              serial_number:
                type: string
                example: "***"
              size_bytes:
                type: integer
                format: int64
                description: Total size in bytes
                example: 1000202273280
              free_size_bytes:
                type: integer
                format: int64
                description: Free size in bytes
                example: 500000000000
              volumes:
                type: array
                items:
                  type: string
                description: List of volume/partition names
        mainboard:
          type: object
          properties:
            vendor:
              type: string
              example: "ASUSTeK COMPUTER INC."
            name:
              type: string
              example: "PRIME Z490-A"
            version:
              type: string
              example: "Rev 1.xx"
            serial_number:
              type: string
              example: "N/A"
        os:
          type: object
          properties:
            name:
              type: string
              example: "Ubuntu 22.04 LTS"
            short_name:
              type: string
              example: "Linux"
            version:
              type: string
              example: "22.04"
            kernel:
              type: string
              example: "5.15.0-72-generic"
            architecture:
              type: string
              example: "64 bit"
            endianess:
              type: string
              example: "little endian"
        battery:
          type: array
          description: Battery information (empty array if no batteries)
          items:
            type: object
            properties:
              vendor:
                type: string
              model:
                type: string
              serial_number:
                type: string
              technology:
                type: string
              capacity_mwh:
                type: integer
                format: int64
                description: Capacity in mWh
              charging:
                type: boolean
                description: Whether battery is charging

    SystemStatusResponse:
      type: object
      description: Current system status
      properties:
        cpu:
          type: object
          properties:
            usage_percent:
              type: number
              format: double
              description: CPU usage percentage (0-100)
              example: 25.5
            current_frequency_mhz:
              type: integer
              description: Current CPU frequency in MHz (-1 if not available)
              example: 3792
            temperature_celsius:
              type: number
              format: double
              description: CPU temperature in Celsius (optional, -1 if not available)
              example: 45.5
        ram:
          type: object
          properties:
            total_mib:
              type: integer
              format: int64
              description: Total RAM in MiB
              example: 65437
            used_mib:
              type: integer
              format: int64
              description: Used RAM in MiB
              example: 11032
            free_mib:
              type: integer
              format: int64
              description: Free RAM in MiB
              example: 54405
            available_mib:
              type: integer
              format: int64
              description: Available RAM in MiB
              example: 54405
            usage_percent:
              type: number
              format: double
              description: RAM usage percentage (0-100)
              example: 16.85
            cached_mib:
              type: integer
              format: int64
              description: Cached memory in MiB (optional)
              example: 5000
            buffers_mib:
              type: integer
              format: int64
              description: Buffers memory in MiB (optional)
              example: 1000
        load_average:
          type: object
          properties:
            "1min":
              type: number
              format: double
              description: Load average for 1 minute
              example: 0.75
            "5min":
              type: number
              format: double
              description: Load average for 5 minutes
              example: 0.82
            "15min":
              type: number
              format: double
              description: Load average for 15 minutes
              example: 0.88
        uptime_seconds:
          type: integer
          format: int64
          description: System uptime in seconds
          example: 86400

    CreateInstanceRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          description: "Instance name (required, pattern: ^[A-Za-z0-9 -_]+$)"
          example: "Face Detection Camera 1"
        group:
          type: string
          description: "Group name (optional, pattern: ^[A-Za-z0-9 -_]+$)"
          example: "cameras"
        solution:
          type: string
          description: Solution ID (optional, must match existing solution)
          example: "face_detection"
        persistent:
          type: boolean
          description: Save instance to JSON file
          default: false
        frameRateLimit:
          type: integer
          description: Frame rate limit (FPS)
          default: 0
          minimum: 0
        metadataMode:
          type: boolean
          description: Enable metadata mode
          default: false
        statisticsMode:
          type: boolean
          description: Enable statistics mode
          default: false
        diagnosticsMode:
          type: boolean
          description: Enable diagnostics mode
          default: false
        debugMode:
          type: boolean
          description: Enable debug mode
          default: false
        detectorMode:
          type: string
          description: Detector mode
          enum: [SmartDetection]
          default: "SmartDetection"
        detectionSensitivity:
          type: string
          description: Detection sensitivity level
          enum: [Low, Medium, High]
          default: "Low"
        movementSensitivity:
          type: string
          description: Movement sensitivity level
          enum: [Low, Medium, High]
          default: "Low"
        sensorModality:
          type: string
          description: Sensor modality
          enum: [RGB, Thermal]
          default: "RGB"
        autoStart:
          type: boolean
          description: Automatically start instance when created
          default: false
        autoRestart:
          type: boolean
          description: Automatically restart instance on error
          default: false
        blockingReadaheadQueue:
          type: boolean
          description: Use blocking readahead queue
          default: false
        inputOrientation:
          type: integer
          description: Input orientation (0-3)
          default: 0
          minimum: 0
          maximum: 3
        inputPixelLimit:
          type: integer
          description: Input pixel limit
          default: 0
          minimum: 0
        RTSP_URL:
          type: string
          description: RTSP URL for source (required for face_detection solution)
          example: "rtsp://localhost:8554/stream"
        MODEL_NAME:
          type: string
          description: |
            Model name to use (e.g., "yunet_2023mar", "yunet_2022mar", "yolov8n_face").
            Can specify category with format "category:modelname" (e.g., "face:yunet_2023mar").
            The system will automatically search for matching model files in system directories.
            Takes priority over MODEL_PATH if both are provided.
          example: "yunet_2023mar"
        MODEL_PATH:
          type: string
          description: |
            Direct path to model file (e.g., "./models/yunet.onnx", "/usr/share/cvedix/cvedix_data/models/face/yunet.onnx").
            Used if MODEL_NAME is not provided or not found.
          example: "./models/yunet.onnx"
        additionalParams:
          type: object
          description: |
            Additional solution-specific parameters. Supported keys:
            - RTSP_URL: RTSP stream URL
            - MODEL_NAME: Model name (e.g., "yunet_2023mar", "face:yunet_2023mar")
            - MODEL_PATH: Direct path to model file
            - CrossingLines: (ba_crossline only) JSON string array of crossing lines configuration.
              Format: `[{"id":"uuid","name":"Line Name","coordinates":[{"x":0,"y":250},{"x":700,"y":220}],"direction":"Both","classes":["Vehicle"],"color":[255,0,0,255]}]`
              Supports multiple lines. Can be managed via `/v1/core/instances/{instanceId}/lines` API endpoints.
          additionalProperties:
            type: string

    UpdateInstanceRequest:
      type: object
      description: Request body for updating an instance. All fields are optional - only provided fields will be updated.
      properties:
        name:
          type: string
          description: "Instance name (pattern: ^[A-Za-z0-9 -_]+$)"
          example: "Face Detection Camera 1"
        group:
          type: string
          description: "Group name (pattern: ^[A-Za-z0-9 -_]+$)"
          example: "cameras"
        persistent:
          type: boolean
          description: Save instance to JSON file
        frameRateLimit:
          type: integer
          description: Frame rate limit (FPS)
          minimum: 0
        metadataMode:
          type: boolean
          description: Enable metadata mode
        statisticsMode:
          type: boolean
          description: Enable statistics mode
        diagnosticsMode:
          type: boolean
          description: Enable diagnostics mode
        debugMode:
          type: boolean
          description: Enable debug mode
        detectorMode:
          type: string
          description: Detector mode
          enum: [SmartDetection]
        detectionSensitivity:
          type: string
          description: Detection sensitivity level
          enum: [Low, Medium, High]
        movementSensitivity:
          type: string
          description: Movement sensitivity level
          enum: [Low, Medium, High]
        sensorModality:
          type: string
          description: Sensor modality
          enum: [RGB, Thermal]
        autoStart:
          type: boolean
          description: Automatically start instance when created
        autoRestart:
          type: boolean
          description: Automatically restart instance on error
        inputOrientation:
          type: integer
          description: Input orientation (0-3)
          minimum: 0
          maximum: 3
        inputPixelLimit:
          type: integer
          description: Input pixel limit
          minimum: 0
        RTSP_URL:
          type: string
          description: RTSP URL for source
          example: "rtsp://localhost:8554/stream"
        MODEL_NAME:
          type: string
          description: Model name to use
          example: "yunet_2023mar"
        MODEL_PATH:
          type: string
          description: Direct path to model file
          example: "./models/yunet.onnx"
        FILE_PATH:
          type: string
          description: File path for file source
          example: "/path/to/video.mp4"
        RTMP_URL:
          type: string
          description: RTMP URL for streaming destination
          example: "rtmp://localhost:1935/live/stream"
        SFACE_MODEL_PATH:
          type: string
          description: Path to SFace encoder model
        SFACE_MODEL_NAME:
          type: string
          description: Name of SFace encoder model
        additionalParams:
          type: object
          description: Additional solution-specific parameters
          additionalProperties:
            type: string

    InstanceSummary:
      type: object
      properties:
        instanceId:
          type: string
          description: Unique instance identifier (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        displayName:
          type: string
          description: Display name of the instance
          example: "Face Detection Camera 1"
        group:
          type: string
          description: Group name
          example: "cameras"
        solutionId:
          type: string
          description: Solution ID
          example: "face_detection"
        solutionName:
          type: string
          description: Solution name
          example: "Face Detection"
        running:
          type: boolean
          description: Whether instance pipeline is running
        loaded:
          type: boolean
          description: Whether instance is loaded
        persistent:
          type: boolean
          description: Whether instance is persisted to storage
        fps:
          type: number
          format: double
          description: Current frames per second

    InstanceInfo:
      type: object
      required:
        - instanceId
        - displayName
      properties:
        instanceId:
          type: string
          description: Unique instance identifier (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        displayName:
          type: string
          description: Display name of the instance
          example: "Face Detection Camera 1"
        group:
          type: string
          description: Group name
          example: "cameras"
        solutionId:
          type: string
          description: Solution ID
          example: "face_detection"
        solutionName:
          type: string
          description: Solution name
          example: "Face Detection"
        persistent:
          type: boolean
          description: Whether instance is persisted to storage
        loaded:
          type: boolean
          description: Whether instance is loaded
        running:
          type: boolean
          description: Whether instance pipeline is running
        fps:
          type: number
          format: double
          description: Current frames per second
        version:
          type: string
          description: CVEDIX SDK version
        frameRateLimit:
          type: integer
          description: Frame rate limit
        metadataMode:
          type: boolean
          description: Metadata mode enabled
        statisticsMode:
          type: boolean
          description: Statistics mode enabled
        diagnosticsMode:
          type: boolean
          description: Diagnostics mode enabled
        debugMode:
          type: boolean
          description: Debug mode enabled
        readOnly:
          type: boolean
          description: Read-only flag
        autoStart:
          type: boolean
          description: Auto-start enabled
        autoRestart:
          type: boolean
          description: Auto-restart enabled
        systemInstance:
          type: boolean
          description: System instance flag
        inputPixelLimit:
          type: integer
          description: Input pixel limit
        inputOrientation:
          type: integer
          description: Input orientation
        detectorMode:
          type: string
          description: Detector mode
        detectionSensitivity:
          type: string
          description: Detection sensitivity
        movementSensitivity:
          type: string
          description: Movement sensitivity
        sensorModality:
          type: string
          description: Sensor modality
        originator:
          type: object
          properties:
            address:
              type: string
              description: Originator address

    InstanceOutputResponse:
      type: object
      description: Real-time output and processing results for an instance
      required:
        - timestamp
        - instanceId
        - displayName
        - running
        - loaded
        - metrics
        - input
        - output
        - status
      properties:
        timestamp:
          type: string
          description: Timestamp when the output information was retrieved (real-time)
          example: "2025-01-15 14:30:25.123"
        instanceId:
          type: string
          description: Unique instance identifier (UUID)
          example: "abc-123-def"
        displayName:
          type: string
          description: Display name of the instance
          example: "face_detection_file_source"
        solutionId:
          type: string
          description: Solution ID
          example: "face_detection"
        solutionName:
          type: string
          description: Solution name
          example: "Face Detection"
        running:
          type: boolean
          description: Whether instance pipeline is running
          example: true
        loaded:
          type: boolean
          description: Whether instance is loaded
          example: true
        metrics:
          type: object
          description: Processing metrics
          required:
            - fps
          properties:
            fps:
              type: number
              format: double
              description: Current frames per second
              example: 25.50
            frameRateLimit:
              type: integer
              description: Frame rate limit (0 = no limit)
              example: 0
        input:
          type: object
          description: Input source information
          required:
            - type
          properties:
            type:
              type: string
              enum: [FILE, RTSP, UNKNOWN]
              description: Type of input source
              example: "FILE"
            path:
              type: string
              description: File path (if type is FILE)
              example: "/path/to/video.mp4"
            url:
              type: string
              description: RTSP URL (if type is RTSP)
              example: "rtsp://localhost:8554/live/stream"
        output:
          type: object
          description: Output information
          required:
            - type
          properties:
            type:
              type: string
              enum: [FILE, RTMP_STREAM]
              description: Type of output
              example: "FILE"
            rtmpUrl:
              type: string
              description: RTMP URL (if type is RTMP_STREAM)
              example: "rtmp://localhost:1935/live/face_stream"
            rtspUrl:
              type: string
              description: RTSP URL for viewing (if type is RTMP_STREAM and available)
              example: "rtsp://localhost:8554/live/face_stream_0"
            files:
              type: object
              description: File output information (if type is FILE)
              properties:
                exists:
                  type: boolean
                  description: Whether output directory exists
                  example: true
                directory:
                  type: string
                  description: Output directory path
                  example: "./output/abc-123-def"
                fileCount:
                  type: integer
                  description: Total number of output files
                  example: 15
                totalSizeBytes:
                  type: integer
                  format: int64
                  description: Total size of all output files in bytes
                  example: 15728640
                totalSize:
                  type: string
                  description: Total size formatted as human-readable string
                  example: "15 MB"
                latestFile:
                  type: string
                  description: Name of the most recently created file
                  example: "face_detection_20250115_143025.mp4"
                latestFileTime:
                  type: string
                  description: Modification time of the latest file
                  example: "2025-01-15 14:30:25"
                recentFileCount:
                  type: integer
                  description: Number of files created in the last minute
                  example: 3
                isActive:
                  type: boolean
                  description: Whether instance is actively creating new files (files created in last minute)
                  example: true
                expectedPaths:
                  type: array
                  items:
                    type: string
                  description: Expected output directory paths (if directory doesn't exist)
                  example: ["./output/abc-123-def", "./build/output/abc-123-def"]
                error:
                  type: string
                  description: Error message if directory reading failed
                  example: "Error reading directory: Permission denied"
        detection:
          type: object
          description: Detection settings
          properties:
            sensitivity:
              type: string
              description: Detection sensitivity level
              example: "Low"
            mode:
              type: string
              description: Detector mode
              example: "SmartDetection"
            movementSensitivity:
              type: string
              description: Movement sensitivity level
              example: "Low"
            sensorModality:
              type: string
              description: Sensor modality
              example: "RGB"
        modes:
          type: object
          description: Processing modes
          properties:
            statisticsMode:
              type: boolean
              description: Statistics mode enabled
              example: true
            metadataMode:
              type: boolean
              description: Metadata mode enabled
              example: false
            debugMode:
              type: boolean
              description: Debug mode enabled
              example: true
            diagnosticsMode:
              type: boolean
              description: Diagnostics mode enabled
              example: false
        status:
          type: object
          description: Status summary
          required:
            - running
            - processing
            - message
          properties:
            running:
              type: boolean
              description: Whether instance is running
              example: true
            processing:
              type: boolean
              description: Whether instance is processing frames (running && fps > 0)
              example: true
            message:
              type: string
              description: Human-readable status message
              example: "Instance is running and processing frames"

    LastFrameResponse:
      type: object
      description: Last frame from a running instance
      required:
        - frame
        - running
      properties:
        frame:
          type: string
          description: |
            Base64-encoded JPEG frame. Empty string if no frame is available.
            Frame is captured from pipeline after processing (includes OSD/detection overlays).
            Frame is automatically cached when pipeline processes new frames.
          example: "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k="
        running:
          type: boolean
          description: Whether the instance is currently running
          example: true

    InstanceStatisticsResponse:
      type: object
      description: Real-time statistics for an instance
      required:
        - frames_processed
        - source_framerate
        - current_framerate
        - latency
        - start_time
        - input_queue_size
        - dropped_frames_count
        - resolution
        - format
        - source_resolution
      properties:
        frames_processed:
          type: integer
          format: int64
          description: Total number of frames processed since instance started
          example: 1250
        source_framerate:
          type: number
          format: double
          description: Frame rate from source (FPS from RTSP stream or video file)
          example: 30.0
        current_framerate:
          type: number
          format: double
          description: Current processing frame rate (FPS being processed)
          example: 25.5
        latency:
          type: number
          format: double
          description: Average processing latency per frame (milliseconds)
          example: 200.0
        start_time:
          type: integer
          format: int64
          description: Unix timestamp when instance started (seconds)
          example: 1764900520
        input_queue_size:
          type: integer
          format: int64
          description: Current size of input queue
          example: 2
        dropped_frames_count:
          type: integer
          format: int64
          description: Total number of dropped frames
          example: 5
        resolution:
          type: string
          description: Current processing resolution (format WIDTHxHEIGHT)
          example: "1280x720"
        format:
          type: string
          description: Frame format (typically BGR for CVEDIX SDK)
          example: "BGR"
        source_resolution:
          type: string
          description: Original resolution from source (format WIDTHxHEIGHT)
          example: "1920x1080"

    SolutionSummary:
      type: object
      properties:
        solutionId:
          type: string
          description: Unique solution identifier
          example: "face_detection"
        solutionName:
          type: string
          description: Display name of the solution
          example: "Face Detection"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        isDefault:
          type: boolean
          description: Whether this is a default solution (cannot be deleted)
          example: true
        pipelineNodeCount:
          type: integer
          description: Number of nodes in the pipeline
          example: 3

    SolutionConfig:
      type: object
      required:
        - solutionId
        - solutionName
        - solutionType
        - pipeline
      properties:
        solutionId:
          type: string
          description: Unique solution identifier
          example: "face_detection"
        solutionName:
          type: string
          description: Display name of the solution
          example: "Face Detection"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        isDefault:
          type: boolean
          description: Whether this is a default solution
          example: false
        pipeline:
          type: array
          description: Pipeline node configurations
          items:
            type: object
            required:
              - nodeType
              - nodeName
            properties:
              nodeType:
                type: string
                description: |
                  Type of node. Available node types:

                  **Source:** rtsp_src, file_src, app_src, image_src, rtmp_src, udp_src

                  **Detector:** yunet_face_detector, yolo_detector, yolov11_detector, mask_rcnn_detector, openpose_detector, enet_seg,
                  trt_yolov8_detector, trt_yolov8_seg_detector, trt_yolov8_pose_detector, trt_yolov8_classifier,
                  trt_vehicle_detector, trt_vehicle_plate_detector, trt_vehicle_plate_detector_v2, trt_insight_face_recognition,
                  rknn_yolov8_detector, rknn_yolov11_detector, rknn_face_detector, ppocr_text_detector,
                  face_swap, insight_face_recognition, mllm_analyser

                  **Processor:** sface_feature_encoder, sort_track, face_osd_v2, ba_crossline, ba_crossline_osd, classifier,
                  lane_detector, restoration, trt_vehicle_feature_encoder, trt_vehicle_color_classifier,
                  trt_vehicle_type_classifier, trt_vehicle_scanner

                  **Destination:** file_des, rtmp_des, screen_des

                  **Broker:** json_console_broker, json_enhanced_console_broker, json_mqtt_broker, json_kafka_broker,
                  xml_file_broker, xml_socket_broker, msg_broker, ba_socket_broker, embeddings_socket_broker,
                  embeddings_properties_socket_broker, plate_socket_broker, expr_socket_broker

                  See GET /v1/core/nodes/templates for complete list with descriptions.
                example: "rtsp_src"
              nodeName:
                type: string
                description: Node name template (may contain {instanceId} placeholder)
                example: "source_{instanceId}"
              parameters:
                type: object
                description: Node-specific parameters
                additionalProperties:
                  type: string
                example:
                  url: "rtsp://localhost/stream"
        defaults:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string
          example:
            RTSP_URL: "rtsp://localhost/stream"

    CreateSolutionRequest:
      type: object
      required:
        - solutionId
        - solutionName
        - solutionType
        - pipeline
      properties:
        solutionId:
          type: string
          description: Unique solution identifier (alphanumeric, underscore, hyphen only)
          pattern: "^[A-Za-z0-9_-]+$"
          example: "custom_face_detection"
        solutionName:
          type: string
          description: Display name of the solution
          example: "Custom Face Detection"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        pipeline:
          type: array
          description: Pipeline node configurations
          items:
            type: object
            required:
              - nodeType
              - nodeName
            properties:
              nodeType:
                type: string
                description: Type of node
                example: "rtsp_src"
              nodeName:
                type: string
                description: Node name template
                example: "source_{instanceId}"
              parameters:
                type: object
                description: Node-specific parameters
                additionalProperties:
                  type: string
        defaults:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string

    UpdateSolutionRequest:
      type: object
      description: Request body for updating a solution. All fields except solutionId are optional.
      properties:
        solutionName:
          type: string
          description: Display name of the solution
          example: "Updated Solution Name"
        solutionType:
          type: string
          description: Type of solution
          example: "face_detection"
        pipeline:
          type: array
          description: Pipeline node configurations
          items:
            type: object
            required:
              - nodeType
              - nodeName
            properties:
              nodeType:
                type: string
                description: Type of node
              nodeName:
                type: string
                description: Node name template
              parameters:
                type: object
                description: Node-specific parameters
                additionalProperties:
                  type: string
        defaults:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string

    GroupInfo:
      type: object
      required:
        - groupId
        - groupName
      properties:
        groupId:
          type: string
          description: Unique group identifier
          pattern: "^[A-Za-z0-9_-]+$"
          example: "cameras"
        groupName:
          type: string
          description: Display name of the group
          pattern: "^[A-Za-z0-9 -_]+$"
          example: "Security Cameras"
        description:
          type: string
          description: Description of the group
          example: "Group for security camera instances"
        isDefault:
          type: boolean
          description: Whether this is a default group (cannot be deleted)
          example: false
        readOnly:
          type: boolean
          description: Whether this group is read-only (cannot be modified)
          example: false
        instanceCount:
          type: integer
          description: Number of instances in this group
          example: 3
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00.000Z"

    CreateGroupRequest:
      type: object
      required:
        - groupId
      properties:
        groupId:
          type: string
          description: Unique group identifier (alphanumeric, underscore, hyphen only)
          pattern: "^[A-Za-z0-9_-]+$"
          example: "cameras"
        groupName:
          type: string
          description: Display name of the group (optional, defaults to groupId)
          pattern: "^[A-Za-z0-9 -_]+$"
          example: "Security Cameras"
        description:
          type: string
          description: Description of the group
          example: "Group for security camera instances"

    UpdateGroupRequest:
      type: object
      description: Request body for updating a group. All fields are optional.
      properties:
        groupName:
          type: string
          description: Display name of the group
          pattern: "^[A-Za-z0-9 -_]+$"
          example: "Updated Group Name"
        description:
          type: string
          description: Description of the group
          example: "Updated description"

    NodeResponse:
      type: object
      required:
        - nodeId
        - templateId
        - inUse
        - parameters
        - createdAt
      properties:
        nodeId:
          type: string
          description: Unique node identifier
          example: "node_a1b2c3d4"
        templateId:
          type: string
          description: Template ID used to create this node
          example: "rtsp_src_template"
        displayName:
          type: string
          description: Human-readable display name from template
          example: "RTSP Source"
        nodeType:
          type: string
          description: Node type from template
          example: "rtsp_src"
        category:
          type: string
          description: Node category from template
          enum: ["source", "detector", "processor", "destination", "broker"]
          example: "source"
        description:
          type: string
          description: Node description from template
          example: "Receive video stream from RTSP URL"
        inUse:
          type: boolean
          description: Whether node is currently in use
          example: false
        parameters:
          type: object
          description: Node configuration parameters
          additionalProperties:
            type: string
          example:
            rtsp_url: "rtsp://localhost:8554/stream1"
            channel: "0"
            resize_ratio: "1.0"
        createdAt:
          type: string
          format: date-time
          description: Node creation timestamp (ISO 8601 format)
          example: "2025-01-15T10:30:00Z"
        message:
          type: string
          description: Success message (for create/update operations)
          example: "Node created successfully"
        oldNodeId:
          type: string
          description: Previous node ID (for update operations)
          example: "node_old123"
        newNodeId:
          type: string
          description: New node ID (for update operations)
          example: "node_new456"

    NodeListResponse:
      type: object
      required:
        - nodes
        - total
        - available
        - inUse
      properties:
        nodes:
          type: array
          description: List of pre-configured nodes
          items:
            $ref: '#/components/schemas/NodeResponse'
        total:
          type: integer
          description: Total number of nodes in the list
          example: 20
        available:
          type: integer
          description: Total number of available (not in use) nodes
          example: 15
        inUse:
          type: integer
          description: Total number of nodes currently in use
          example: 5

    CreateNodeRequest:
      type: object
      required:
        - templateId
      properties:
        templateId:
          type: string
          description: Template ID to use for creating the node
          example: "rtsp_src_template"
        parameters:
          type: object
          description: Node parameters (must include all required parameters from template)
          additionalProperties:
            type: string
          example:
            rtsp_url: "rtsp://localhost:8554/stream1"
            channel: "0"
            resize_ratio: "1.0"

    UpdateNodeRequest:
      type: object
      required:
        - parameters
      properties:
        parameters:
          type: object
          description: Updated node parameters
          additionalProperties:
            type: string
          example:
            rtsp_url: "rtsp://localhost:8554/stream2"
            channel: "0"
            resize_ratio: "0.5"

    Coordinate:
      type: object
      required:
        - x
        - y
      properties:
        x:
          type: number
          format: double
          description: The x coordinate
          example: 100.0
        y:
          type: number
          format: double
          description: The y coordinate
          example: 300.0

    CrossingLine:
      type: object
      required:
        - id
        - coordinates
      properties:
        id:
          type: string
          description: Unique identifier of the line
          example: "b1234567-89ab-cdef-0123-456789abcdef"
        name:
          type: string
          description: Human-readable name for the line
          example: "Counting Line 1"
        coordinates:
          type: array
          description: List of coordinate objects defining the line (minimum 2 points)
          items:
            $ref: '#/components/schemas/Coordinate'
          minItems: 2
          example:
            - x: 100.0
              y: 300.0
            - x: 600.0
              y: 300.0
        direction:
          type: string
          description: Direction for counting (Up, Down, or Both)
          enum: ["Up", "Down", "Both"]
          default: "Both"
          example: "Both"
        classes:
          type: array
          description: Object classes to count
          items:
            type: string
            enum: ["Person", "Animal", "Vehicle", "Face", "Unknown"]
          example: ["Person", "Vehicle"]
        color:
          type: array
          description: Line color in RGBA format
          items:
            type: integer
            minimum: 0
            maximum: 255
          minItems: 4
          maxItems: 4
          example: [255, 0, 0, 255]

    CreateLineRequest:
      type: object
      required:
        - coordinates
      properties:
        name:
          type: string
          description: Human-readable name for the line
          example: "Counting Line 1"
        coordinates:
          type: array
          description: List of coordinate objects defining the line (minimum 2 points)
          items:
            $ref: '#/components/schemas/Coordinate'
          minItems: 2
          example:
            - x: 100.0
              y: 300.0
            - x: 600.0
              y: 300.0
        direction:
          type: string
          description: Direction for counting (Up, Down, or Both)
          enum: ["Up", "Down", "Both"]
          default: "Both"
          example: "Both"
        classes:
          type: array
          description: Object classes to count
          items:
            type: string
            enum: ["Person", "Animal", "Vehicle", "Face", "Unknown"]
          example: ["Person", "Vehicle"]
        color:
          type: array
          description: Line color in RGBA format (default is red)
          items:
            type: integer
            minimum: 0
            maximum: 255
          minItems: 4
          maxItems: 4
          default: [255, 0, 0, 255]
          example: [255, 0, 0, 255]

    LinesResponse:
      type: object
      required:
        - crossingLines
      properties:
        crossingLines:
          type: array
          description: List of crossing lines
          items:
            $ref: '#/components/schemas/CrossingLine'

    TemplateResponse:
      type: object
      required:
        - templateId
        - nodeType
        - displayName
        - category
        - isPreConfigured
        - defaultParameters
        - requiredParameters
        - optionalParameters
      properties:
        templateId:
          type: string
          description: Unique template identifier
          example: "rtsp_src_template"
        nodeType:
          type: string
          description: Node type identifier
          example: "rtsp_src"
        displayName:
          type: string
          description: Human-readable display name
          example: "RTSP Source"
        description:
          type: string
          description: Template description
          example: "Receive video stream from RTSP URL"
        category:
          type: string
          description: Node category
          enum: ["source", "detector", "processor", "destination", "broker"]
          example: "source"
        isPreConfigured:
          type: boolean
          description: Whether this template creates pre-configured nodes
          example: false
        defaultParameters:
          type: object
          description: Default parameter values
          additionalProperties:
            type: string
          example:
            channel: "0"
            resize_ratio: "1.0"
        requiredParameters:
          type: array
          description: List of required parameter names
          items:
            type: string
          example: ["rtsp_url"]
        optionalParameters:
          type: array
          description: List of optional parameter names
          items:
            type: string
          example: ["channel", "resize_ratio"]

    TemplateListResponse:
      type: object
      required:
        - templates
        - total
      properties:
        templates:
          type: array
          description: List of node templates
          items:
            $ref: '#/components/schemas/TemplateResponse'
        total:
          type: integer
          description: Total number of templates
          example: 10

    NodeStatsResponse:
      type: object
      required:
        - totalTemplates
        - totalPreConfiguredNodes
        - availableNodes
        - inUseNodes
        - nodesByCategory
      properties:
        totalTemplates:
          type: integer
          description: Total number of node templates
          example: 10
        totalPreConfiguredNodes:
          type: integer
          description: Total number of pre-configured nodes
          example: 20
        availableNodes:
          type: integer
          description: Number of available (not in use) nodes
          example: 15
        inUseNodes:
          type: integer
          description: Number of nodes currently in use
          example: 5
        nodesByCategory:
          type: object
          description: Count of nodes by category
          additionalProperties:
            type: integer
          example:
            source: 5
            detector: 8
            processor: 4
            destination: 3
            broker: 0

tags:
  - name: Core
    description: Core API endpoints for health and version information
  - name: Logs
    description: Log management endpoints for viewing and filtering application logs by category and date
  - name: AI
    description: AI processing endpoints for image/frame processing, batch operations, status, and metrics
  - name: Config
    description: System configuration management endpoints (get, create, update, delete)
  - name: Instances
    description: AI instance management endpoints (create, list, start, stop, delete)
  - name: Lines
    description: Crossing lines management for ba_crossline instances (create, list, delete). Lines are drawn on video stream for object counting.
  - name: Solutions
    description: Solution configuration management endpoints (create, list, update, delete)
  - name: Groups
    description: Group management endpoints for organizing instances (create, list, update, delete)
  - name: Models
    description: Model file management endpoints
  - name: Video
    description: Video file management endpoints
  - name: Fonts
    description: Font file management endpoints
  - name: Node
    description: Node pool management endpoints for pre-configured nodes and templates (create, list, update, delete, templates, stats)
