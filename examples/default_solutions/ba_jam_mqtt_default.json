{
    "solutionId": "ba_jam_mqtt_default",
    "solutionName": "Behavior Analysis - Jams Detection with MQTT",
    "solutionType": "behavior_analysis",
    "isDefault": false,
    "description": "Phát hiện tình trạng kẹt xe với MQTT event publishing",
    "category": "behavior_analysis",
    "pipeline": [
        {
            "nodeType": "file_src",
            "nodeName": "file_src_{instanceId}",
            "parameters": {
                "file_path": "${FILE_PATH}",
                "channel": "0",
                "resize_ratio": "${RESIZE_RATIO}"
            }
        },
        {
            "nodeType": "yolo_detector",
            "nodeName": "yolo_detector_{instanceId}",
            "parameters": {
                "weights_path": "${WEIGHTS_PATH}",
                "config_path": "${CONFIG_PATH}",
                "labels_path": "${LABELS_PATH}",
                "score_threshold": "${detectionSensitivity}",
                "nms_threshold": "0.4"
            }
        },
        {
            "nodeType": "sort_track",
            "nodeName": "sort_tracker_{instanceId}",
            "parameters": {}
        },
        {
            "nodeType": "ba_jam",
            "nodeName": "ba_jam_{instanceId}",
            "parameters": {
                "region_channel": "0",
                "check_interval_frames": "${CHECK_INTERVAL_FRAMES}",
                "check_min_hit_frames": "${CHECK_MIN_HIT_FRAMES}",
                "check_max_distance": "${CHECK_MAX_DISTANCE}",
                "check_min_stops": "${CHECK_MIN_STOPS}",
                "check_notify_interval": "${CHECK_NOTIFY_INTERVAL}"
            }
        },
        {
            "nodeType": "json_mqtt_broker",
            "nodeName": "json_mqtt_broker_{instanceId}",
            "parameters": {}
        },
        {
            "nodeType": "ba_jam_osd",
            "nodeName": "osd_{instanceId}",
            "parameters": {}
        },
        {
            "nodeType": "file_des",
            "nodeName": "file_des_{instanceId}",
            "parameters": {
                "save_dir": "./output/{instanceId}",
                "name_prefix": "ba_jam_mqtt",
                "osd": "true"
            }
        }
    ],
    "defaults": {
        "detectorMode": "SmartDetection",
        "detectionSensitivity": "0.7",
        "sensorModality": "RGB",
        "RESIZE_RATIO": "1.0"
    },
    "requiredParams": {
        "FILE_PATH": "Đường dẫn file video input (hoặc dùng RTSP_URL)",
        "WEIGHTS_PATH": "Đường dẫn YOLO weights file",
        "CONFIG_PATH": "Đường dẫn YOLO config file",
        "LABELS_PATH": "Đường dẫn labels file",
        "CHECK_INTERVAL_FRAMES": "Số khung hình giữa các lần kiểm tra kẹt xe",
        "CHECK_MIN_HIT_FRAMES": "Số khung hình tối thiểu để xác định đối tượng kẹt xe",
        "CHECK_MAX_DISTANCE": "Khoảng cách tối đa giữa các vị trí liên tiếp để coi là kẹt xe",
        "CHECK_MIN_STOPS": "Số lần kẹt xe tối thiểu để phát hiện sự kiện",
        "CHECK_NOTIFY_INTERVAL": "Khoảng thời gian giữa các lần thông báo sự kiện"
    },
    "optionalParams": {
        "RTSP_URL": "URL RTSP stream (thay thế FILE_PATH)",
        "RTMP_URL": "URL RTMP server (thay thế file_des)",
        "RESIZE_RATIO": "Tỷ lệ resize video (0.0-1.0), mặc định 1.0"
    }
}