openapi: 3.0.3
info:
  title: Edge AI API
  description: 'REST API cho các thao tác và quản lý Edge AI.


    ## Tính năng Ghi log


    Máy chủ hỗ trợ các tính năng ghi log chi tiết có thể được bật qua các tham số dòng lệnh:


    - **Ghi log API** (`--log-api` hoặc `--debug-api`): Ghi lại tất cả các yêu cầu và phản hồi API cùng với thời gian phản hồi

    - **Ghi log Thực thi Instance** (`--log-instance` hoặc `--debug-instance`): Ghi lại các sự kiện vòng đời instance (start/stop/status)

    - **Ghi log Đầu ra SDK** (`--log-sdk-output` hoặc `--debug-sdk-output`): Ghi lại đầu ra SDK khi các instance xử lý dữ liệu


    Ví dụ sử dụng:

    ```bash

    ./edge_ai_api --log-api --log-instance --log-sdk-output

    ```


    Để biết thêm chi tiết, xem [Tài liệu Ghi log](../docs/LOGGING.md).


    ## Swagger UI


    API này cung cấp Swagger UI để kiểm thử và khám phá tương tác:

    - Truy cập Swagger UI tại `/swagger` hoặc `/v1/swagger`

    - Đặc tả OpenAPI có sẵn tại `/openapi.yaml` hoặc `/v1/openapi.yaml`

    - URL máy chủ được cập nhật tự động dựa trên các biến môi trường (`API_HOST` và `API_PORT`)

    '
  version: 1.0.0
  contact:
    name: Hỗ trợ Edge AI API
servers:
- url: http://localhost:8080
  description: Máy chủ phát triển cục bộ
- url: http://0.0.0.0:8080
  description: Máy chủ mặc định
paths:
  /v1/core/health:
    get:
      summary: Kiểm tra trạng thái sức khỏe
      description: Trả về trạng thái sức khỏe của dịch vụ API
      operationId: getHealth
      tags:
      - Core
      responses:
        '200':
          description: Dịch vụ đang hoạt động tốt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: healthy
                timestamp: '2024-01-01T00:00:00.000Z'
                uptime: 3600
                service: edge_ai_api
                version: 1.0.0
        '500':
          description: Dịch vụ không hoạt động bình thường
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/version:
    get:
      summary: Lấy thông tin phiên bản
      description: Trả về thông tin phiên bản của dịch vụ API
      operationId: getVersion
      tags:
      - Core
      responses:
        '200':
          description: Thông tin phiên bản
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'
              example:
                version: 1.0.0
                build_time: Jan 01 2024 00:00:00
                git_commit: abc123def456
                api_version: v1
                service: edge_ai_api
  /v1/core/system/info:
    get:
      summary: Lấy thông tin phần cứng hệ thống
      description: Trả về thông tin phần cứng chi tiết bao gồm CPU, GPU, RAM, Disk, Mainboard, OS và Battery
      operationId: getSystemInfo
      tags:
      - Core
      responses:
        '200':
          description: Thông tin phần cứng hệ thống
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemInfoResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho thông tin hệ thống
      operationId: getSystemInfoOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/system/status:
    get:
      summary: Lấy trạng thái hệ thống
      description: Trả về trạng thái hệ thống hiện tại bao gồm mức sử dụng CPU, mức sử dụng RAM, tải trung bình và thời gian hoạt động
      operationId: getSystemStatus
      tags:
      - Core
      responses:
        '200':
          description: Thông tin trạng thái hệ thống
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemStatusResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho trạng thái hệ thống
      operationId: getSystemStatusOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/system/config:
    get:
      summary: Lấy system configuration entities
      description: Trả về system configuration entities với fieldId, displayName, type, value, group, và availableValues
      operationId: coreGetSystemConfigV1
      tags:
      - Core
      responses:
        '200':
          description: System configuration entities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemConfigResponse'
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Cập nhật system configuration
      description: Cập nhật system configuration entities
      operationId: corePutSystemConfigV1
      tags:
      - Core
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SystemConfigUpdateRequest'
      responses:
        '200':
          description: Cấu hình đã được cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: System config updated successfully
        '406':
          description: Not Acceptable - Cấu hình không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho system config
      operationId: coreSystemConfigOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/system/preferences:
    get:
      summary: Lấy system preferences
      description: Trả về system preferences từ rtconfig.json. Các settings này ảnh hưởng đến UI của VMS plugins và Web Panel.
      operationId: coreGetPreferencesV1
      tags:
      - Core
      responses:
        '200':
          description: System preferences
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemPreferencesResponse'
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho system preferences
      operationId: coreSystemPreferencesOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/system/decoders:
    get:
      summary: Lấy thông tin decoders có sẵn
      description: Trả về thông tin về hardware và software decoders có sẵn trong hệ thống
      operationId: coreGetDecodersV1
      tags:
      - Core
      responses:
        '200':
          description: Thông tin decoders
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemDecodersResponse'
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho system decoders
      operationId: coreSystemDecodersOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/system/registry:
    get:
      summary: Lấy registry key value
      description: Trả về registry key value từ hệ thống
      operationId: coreGetRegistryKeyValueV1
      tags:
      - Core
      parameters:
      - name: key
        in: query
        required: true
        schema:
          type: string
        description: Registry key path
        example: test
      responses:
        '200':
          description: Registry key value
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
                example:
                  test:
                    value_bool: true
                    value_float: 3.14
                    value_int: 42
                    value_string: hello
                  system:
                    version: 1.0.0
        '404':
          description: Registry key không tìm thấy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho system registry
      operationId: coreSystemRegistryOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/system/shutdown:
    post:
      summary: Shutdown hệ thống
      description: Khởi động shutdown hệ thống
      operationId: corePostShutdownV1
      tags:
      - Core
      responses:
        '200':
          description: Shutdown đã được khởi động
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: System shutdown initiated
    options:
      summary: CORS preflight cho system shutdown
      operationId: coreSystemShutdownOptions
      tags:
      - Core
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/config:
    get:
      summary: Lấy cấu hình hệ thống
      description: 'Trả về cấu hình hệ thống. Nếu tham số truy vấn `path` được cung cấp, trả về phần cấu hình cụ thể.

        Nếu không, trả về cấu hình hệ thống đầy đủ.


        **Định dạng Đường dẫn:**

        - Sử dụng dấu gạch chéo `/` hoặc dấu chấm `.` để điều hướng các khóa cấu hình lồng nhau

        - Ví dụ: `system/max_running_instances`, `system.max_running_instances`, `gstreamer/decode_pipelines/auto`


        **Khuyến nghị:** Sử dụng tham số truy vấn với dấu gạch chéo để tương thích tốt hơn.

        '
      operationId: getConfig
      tags:
      - Config
      parameters:
      - name: path
        in: query
        required: false
        schema:
          type: string
        description: 'Đường dẫn cấu hình để lấy một phần cụ thể. Sử dụng `/` hoặc `.` làm dấu phân cách.

          Ví dụ: `system/max_running_instances`, `system.web_server`, `gstreamer/decode_pipelines/auto`

          '
        example: system/max_running_instances
      responses:
        '200':
          description: Cấu hình hệ thống đầy đủ
          content:
            application/json:
              schema:
                type: object
                description: Đối tượng cấu hình hệ thống đầy đủ
                additionalProperties: true
                example:
                  auto_device_list:
                  - hailo.auto
                  - blaize.auto
                  decoder_priority_list:
                  - blaize.auto
                  - software
                  gstreamer:
                    decode_pipelines:
                      auto:
                        pipeline: decodebin ! videoconvert
                  system:
                    web_server:
                      enabled: true
                      ip_address: 0.0.0.0
                      port: 8080
                    auto_reload: false
                    max_running_instances: 0
                    modelforge_permissive: false
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Tạo hoặc cập nhật cấu hình (gộp)
      description: 'Cập nhật cấu hình hệ thống bằng cách gộp JSON được cung cấp với cấu hình hiện có.

        Chỉ các trường được cung cấp sẽ được cập nhật; các trường khác giữ nguyên.

        Cấu hình được lưu vào file cấu hình sau khi cập nhật.


        **Tự động Khởi động lại:**

        - Theo mặc định, máy chủ sẽ KHÔNG tự động khởi động lại sau khi thay đổi cấu hình

        - Để bật khởi động lại tự động, đặt `auto_restart=true` làm tham số truy vấn hoặc trong body JSON

        - Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi

        '
      operationId: createOrUpdateConfig
      tags:
      - Config
      parameters:
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi cập nhật cấu hình.

          Mặc định là `false` (không tự động khởi động lại).

          Cũng có thể đặt trong body JSON như trường `auto_restart`.

          '
        example: false
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Đối tượng cấu hình để gộp. Có thể tùy chọn bao gồm trường `auto_restart` (boolean) để kích hoạt
                khởi động lại máy chủ.
              additionalProperties: true
              example:
                system:
                  web_server:
                    port: 8080
                  auto_reload: false
                auto_restart: false
      responses:
        '200':
          description: Cấu hình đã được cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Cấu hình đã được cập nhật thành công
                  config:
                    type: object
                    description: Cấu hình đầy đủ đã được cập nhật
                    additionalProperties: true
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: Máy chủ sẽ khởi động lại sau 3 giây (auto_restart được yêu cầu).
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: Cổng/máy chủ web server đã thay đổi. Vui lòng khởi động lại máy chủ thủ công để áp dụng thay đổi, hoặc đặt auto_restart=true
                      để khởi động lại tự động.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: false
        '400':
          description: Yêu cầu không hợp lệ hoặc xác thực thất bại
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Thay thế toàn bộ cấu hình
      description: 'Thay thế toàn bộ cấu hình hệ thống bằng JSON được cung cấp.

        Tất cả cấu hình hiện có sẽ được thay thế bằng các giá trị mới.

        Cấu hình được lưu vào file cấu hình sau khi thay thế.


        **Tự động Khởi động lại:**

        - Theo mặc định, máy chủ sẽ KHÔNG tự động khởi động lại sau khi thay đổi cấu hình

        - Để bật khởi động lại tự động, đặt `auto_restart=true` làm tham số truy vấn hoặc trong body JSON

        - Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi

        '
      operationId: replaceConfig
      tags:
      - Config
      parameters:
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi thay thế cấu hình.

          Mặc định là `false` (không tự động khởi động lại).

          Cũng có thể đặt trong body JSON như trường `auto_restart`.

          '
        example: false
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Đối tượng cấu hình đầy đủ để thay thế cấu hình hiện có. Có thể tùy chọn bao gồm trường `auto_restart`
                (boolean) để kích hoạt khởi động lại máy chủ.
              additionalProperties: true
              example:
                auto_device_list:
                - hailo.auto
                system:
                  web_server:
                    enabled: true
                    port: 8080
                  auto_reload: false
                  max_running_instances: 0
                  modelforge_permissive: false
                auto_restart: false
      responses:
        '200':
          description: Cấu hình đã được thay thế thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Cấu hình đã được thay thế thành công
                  config:
                    type: object
                    description: Cấu hình đầy đủ mới
                    additionalProperties: true
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_reload=true và cổng/máy chủ thay đổi)
                    example: Cổng/máy chủ web server đã thay đổi. Máy chủ sẽ khởi động lại sau 3 giây để áp dụng thay đổi.
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (auto_reload=true và cổng/máy chủ thay đổi)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_reload bị tắt
                    example: Cổng/máy chủ web server đã thay đổi, nhưng auto_reload bị tắt. Vui lòng khởi động lại máy chủ thủ công để
                      áp dụng thay đổi.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_reload bị tắt
                    example: false
        '400':
          description: Yêu cầu không hợp lệ hoặc xác thực thất bại
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    patch:
      summary: Cập nhật phần cấu hình (tham số truy vấn)
      description: 'Cập nhật một phần cụ thể của cấu hình hệ thống tại đường dẫn đã cho.


        **Định dạng Đường dẫn:**

        - Sử dụng dấu gạch chéo `/` hoặc dấu chấm `.` làm dấu phân cách

        - Ví dụ: `system/max_running_instances`, `system.max_running_instances`


        Chỉ các trường được cung cấp trong phần sẽ được cập nhật.

        Cấu hình được lưu vào file cấu hình sau khi cập nhật.


        **Tự động Khởi động lại:**

        - Theo mặc định, máy chủ sẽ KHÔNG tự động khởi động lại sau khi thay đổi cấu hình

        - Để bật khởi động lại tự động, đặt `auto_restart=true` làm tham số truy vấn hoặc trong body JSON

        - Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi

        '
      operationId: updateConfigSectionQuery
      tags:
      - Config
      parameters:
      - name: path
        in: query
        required: true
        schema:
          type: string
        description: Đường dẫn cấu hình sử dụng `/` hoặc `.` làm dấu phân cách
        example: system/max_running_instances
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi cập nhật cấu hình.

          Mặc định là `false` (không tự động khởi động lại).

          Cũng có thể đặt trong body JSON như trường `auto_restart`.

          '
        example: false
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Giá trị phần cấu hình để cập nhật. Có thể tùy chọn bao gồm trường `auto_restart` (boolean) để
                kích hoạt khởi động lại máy chủ.
              additionalProperties: true
              example:
                port: 8080
                auto_restart: false
      responses:
        '200':
          description: Phần cấu hình đã được cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Phần cấu hình đã được cập nhật thành công
                  path:
                    type: string
                    example: system/max_running_instances
                  value:
                    type: object
                    description: Giá trị phần cấu hình đã được cập nhật
                    additionalProperties: true
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: Máy chủ sẽ khởi động lại sau 3 giây (auto_restart được yêu cầu).
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: Cổng/máy chủ web server đã thay đổi. Vui lòng khởi động lại máy chủ thủ công để áp dụng thay đổi, hoặc đặt auto_restart=true
                      để khởi động lại tự động.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: false
        '400':
          description: Yêu cầu không hợp lệ hoặc xác thực thất bại
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Xóa phần cấu hình (tham số truy vấn)
      description: "Xóa một phần cụ thể của cấu hình hệ thống tại đường dẫn đã cho.\n\n**Định dạng Đường dẫn:**\n- Hỗ trợ\
        \ cả dấu gạch chéo `/` và dấu chấm `.` làm dấu phân cách\n- **Khuyến nghị:** Sử dụng dấu gạch chéo `/` để tương thích tốt hơn\n\
        - Ví dụ:\n  - `system/max_running_instances` (với dấu gạch chéo - khuyến nghị)\n  - `system.max_running_instances`\
        \ (với dấu chấm)\n  - `system/web_server/port` (đường dẫn lồng nhau với dấu gạch chéo)\n  - `system.web_server.port` (đường dẫn\
        \ lồng nhau với dấu chấm)\n\nCấu hình được lưu vào file cấu hình sau khi xóa.\n\n**Tự động Khởi động lại:**\n- Theo mặc định,\
        \ máy chủ sẽ KHÔNG tự động khởi động lại sau khi xóa cấu hình\n- Để bật khởi động lại tự động, đặt `auto_restart=true`\
        \ làm tham số truy vấn\n- Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi\n"
      operationId: deleteConfigSectionQuery
      tags:
      - Config
      parameters:
      - name: path
        in: query
        required: true
        schema:
          type: string
        description: 'Đường dẫn cấu hình. Hỗ trợ cả `/` (dấu gạch chéo) và `.` (dấu chấm) làm dấu phân cách.

          **Khuyến nghị:** Sử dụng dấu gạch chéo `/` để tương thích tốt hơn.

          Ví dụ: `system/max_running_instances`, `system.web_server`, `system/web_server/port`

          '
        example: system/max_running_instances
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi xóa cấu hình.

          Mặc định là `false` (không khởi động lại tự động).

          '
        example: false
      responses:
        '200':
          description: Phần cấu hình đã được xóa thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Phần cấu hình đã được xóa thành công
                  path:
                    type: string
                    example: system/max_running_instances
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: Máy chủ sẽ khởi động lại sau 3 giây (auto_restart được yêu cầu).
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: Cổng/máy chủ web server đã thay đổi. Vui lòng khởi động lại máy chủ thủ công để áp dụng thay đổi, hoặc đặt auto_restart=true
                      để khởi động lại tự động.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: false
        '400':
          description: Yêu cầu không hợp lệ (đường dẫn trống)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy phần cấu hình
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho cấu hình
      operationId: configOptions
      tags:
      - Config
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/config/reset:
    post:
      summary: Đặt lại cấu hình về mặc định
      description: 'Đặt lại toàn bộ cấu hình hệ thống về giá trị mặc định.

        Tất cả cấu hình hiện có sẽ được thay thế bằng giá trị mặc định.

        Cấu hình được lưu vào file cấu hình sau khi đặt lại.


        **Cảnh báo:** Thao tác này sẽ thay thế tất cả cấu hình bằng giá trị mặc định.

        Hãy cân nhắc sao lưu cấu hình của bạn trước khi đặt lại.


        **Tự động Khởi động lại:**

        - Theo mặc định, máy chủ sẽ KHÔNG tự động khởi động lại sau khi đặt lại cấu hình

        - Để bật khởi động lại tự động, đặt `auto_restart=true` làm tham số truy vấn hoặc trong body JSON

        - Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi

        '
      operationId: resetConfig
      tags:
      - Config
      parameters:
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi đặt lại cấu hình.

          Mặc định là `false` (không tự động khởi động lại).

          Cũng có thể đặt trong body JSON như trường `auto_restart`.

          '
        example: false
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              description: Body JSON tùy chọn. Có thể bao gồm trường `auto_restart` (boolean) để kích hoạt khởi động lại máy chủ.
              properties:
                auto_restart:
                  type: boolean
                  description: Nếu true, máy chủ sẽ khởi động lại sau khi đặt lại
                  example: false
      responses:
        '200':
          description: Cấu hình đã được đặt lại thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Cấu hình đã được đặt lại về mặc định thành công
                  config:
                    type: object
                    description: Đối tượng cấu hình mặc định
                    additionalProperties: true
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: Máy chủ sẽ khởi động lại sau 3 giây (auto_restart được yêu cầu).
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: Cổng/máy chủ web server đã thay đổi. Vui lòng khởi động lại máy chủ thủ công để áp dụng thay đổi, hoặc đặt auto_restart=true
                      để khởi động lại tự động.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: false
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/config/{path}:
    get:
      summary: Lấy phần cấu hình (tham số đường dẫn)
      description: 'Trả về một phần cụ thể của cấu hình hệ thống tại đường dẫn đã cho.


        **Định dạng Đường dẫn:**

        - Sử dụng dấu chấm `.` làm dấu phân cách (ví dụ: `system.max_running_instances`)

        - Dấu gạch chéo `/` với mã hóa URL (`%2F`) KHÔNG được hỗ trợ do giới hạn định tuyến Drogon


        **Khuyến nghị:** Sử dụng tham số truy vấn thay thế: `GET /v1/core/config?path=system/max_running_instances`


        Ví dụ đường dẫn: `system.max_running_instances`, `system.web_server`, `gstreamer.decode_pipelines.auto`

        '
      operationId: getConfigSection
      tags:
      - Config
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
        description: 'Đường dẫn cấu hình sử dụng dấu chấm làm dấu phân cách.

          Ví dụ: `system.max_running_instances`, `system.web_server`, `gstreamer.decode_pipelines.auto`

          Lưu ý: Dấu gạch chéo KHÔNG được hỗ trợ trong tham số đường dẫn (sử dụng tham số truy vấn thay thế)

          '
        example: system.max_running_instances
      responses:
        '200':
          description: Phần cấu hình
          content:
            application/json:
              schema:
                type: object
                description: Giá trị phần cấu hình (có thể là object, array hoặc primitive)
                additionalProperties: true
                example:
                  enabled: true
                  ip_address: 0.0.0.0
                  port: 8080
        '400':
          description: Yêu cầu không hợp lệ (đường dẫn trống)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy phần cấu hình
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    patch:
      summary: Cập nhật phần cấu hình (tham số đường dẫn)
      description: 'Cập nhật một phần cụ thể của cấu hình hệ thống tại đường dẫn đã cho.


        **Định dạng Đường dẫn:**

        - Sử dụng dấu chấm `.` làm dấu phân cách (ví dụ: `system.max_running_instances`)

        - Dấu gạch chéo `/` với mã hóa URL (`%2F`) KHÔNG được hỗ trợ


        **Khuyến nghị:** Sử dụng tham số truy vấn thay thế: `PATCH /v1/core/config?path=system/max_running_instances`


        Chỉ các trường được cung cấp trong phần sẽ được cập nhật.

        Cấu hình được lưu vào file cấu hình sau khi cập nhật.


        **Tự động Khởi động lại:**

        - Theo mặc định, máy chủ sẽ KHÔNG tự động khởi động lại sau khi thay đổi cấu hình

        - Để bật khởi động lại tự động, đặt `auto_restart=true` làm tham số truy vấn hoặc trong body JSON

        - Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi

        '
      operationId: updateConfigSection
      tags:
      - Config
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
        description: 'Đường dẫn cấu hình sử dụng dấu chấm làm dấu phân cách.

          Examples: `system.max_running_instances`, `system.web_server`

          Note: Forward slashes are NOT supported in path parameter (use query parameter instead)

          '
        example: system.max_running_instances
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi cập nhật cấu hình.

          Mặc định là `false` (không tự động khởi động lại).

          Cũng có thể đặt trong body JSON như trường `auto_restart`.

          '
        example: false
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Giá trị phần cấu hình để cập nhật
              additionalProperties: true
              example:
                port: 8080
      responses:
        '200':
          description: Phần cấu hình đã được cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Phần cấu hình đã được cập nhật thành công
                  path:
                    type: string
                    example: system/web_server
                  value:
                    type: object
                    description: Giá trị phần cấu hình đã được cập nhật
                    additionalProperties: true
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: Máy chủ sẽ khởi động lại sau 3 giây (auto_restart được yêu cầu).
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: Cổng/máy chủ web server đã thay đổi. Vui lòng khởi động lại máy chủ thủ công để áp dụng thay đổi, hoặc đặt auto_restart=true
                      để khởi động lại tự động.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: false
        '400':
          description: Yêu cầu không hợp lệ hoặc xác thực thất bại
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Xóa phần cấu hình (tham số đường dẫn)
      description: 'Xóa một phần cụ thể của cấu hình hệ thống tại đường dẫn đã cho.


        **Định dạng Đường dẫn:**

        - Sử dụng dấu chấm `.` làm dấu phân cách (ví dụ: `system.max_running_instances`)

        - Dấu gạch chéo `/` với mã hóa URL (`%2F`) KHÔNG được hỗ trợ


        **Khuyến nghị:** Sử dụng tham số truy vấn thay thế: `DELETE /v1/core/config?path=system/max_running_instances`


        Cấu hình được lưu vào file cấu hình sau khi xóa.


        **Tự động Khởi động lại:**

        - Theo mặc định, máy chủ sẽ KHÔNG tự động khởi động lại sau khi xóa cấu hình

        - Để bật khởi động lại tự động, đặt `auto_restart=true` làm tham số truy vấn

        - Khi `auto_restart=true`, máy chủ sẽ khởi động lại sau 3 giây nếu cấu hình web server thay đổi

        '
      operationId: deleteConfigSection
      tags:
      - Config
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
        description: 'Đường dẫn cấu hình sử dụng dấu chấm làm dấu phân cách.

          Examples: `system.max_running_instances`, `system.web_server`

          Note: Forward slashes are NOT supported in path parameter (use query parameter instead)

          '
        example: system.max_running_instances
      - name: auto_restart
        in: query
        required: false
        schema:
          type: boolean
          default: false
        description: 'Nếu đặt là `true`, máy chủ sẽ tự động khởi động lại sau khi xóa cấu hình.

          Mặc định là `false` (không khởi động lại tự động).

          '
        example: false
      responses:
        '200':
          description: Phần cấu hình đã được xóa thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Phần cấu hình đã được xóa thành công
                  path:
                    type: string
                    example: system/web_server
                  warning:
                    type: string
                    description: Thông báo cảnh báo nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: Máy chủ sẽ khởi động lại sau 3 giây (auto_restart được yêu cầu).
                  restart_scheduled:
                    type: boolean
                    description: True nếu khởi động lại máy chủ được lên lịch (khi auto_restart=true)
                    example: true
                  info:
                    type: string
                    description: Thông báo thông tin nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: Cổng/máy chủ web server đã thay đổi. Vui lòng khởi động lại máy chủ thủ công để áp dụng thay đổi, hoặc đặt auto_restart=true
                      để khởi động lại tự động.
                  restart_required:
                    type: boolean
                    description: True nếu cần khởi động lại nhưng auto_restart chưa được đặt
                    example: false
        '400':
          description: Yêu cầu không hợp lệ (đường dẫn trống)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy phần cấu hình
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho đường dẫn cấu hình
      operationId: configPathOptions
      tags:
      - Config
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
        description: Đường dẫn cấu hình
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/log:
    get:
      summary: Liệt kê tất cả các file log theo danh mục
      description: 'Trả về danh sách tất cả các file log được tổ chức theo danh mục (api, instance, sdk_output, general).

        Mỗi danh mục chứa một mảng các file log với ngày, kích thước và đường dẫn của chúng.

        '
      operationId: listLogFiles
      tags:
      - Logs
      responses:
        '200':
          description: Danh sách các file log theo danh mục
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogFilesResponse'
              example:
                categories:
                  api:
                  - date: '2024-01-01'
                    size: 1024
                    path: /var/log/edge_ai_api/api_2024-01-01.log
                  instance:
                  - date: '2024-01-01'
                    size: 2048
                    path: /var/log/edge_ai_api/instance_2024-01-01.log
                  sdk_output:
                  - date: '2024-01-01'
                    size: 512
                    path: /var/log/edge_ai_api/sdk_output_2024-01-01.log
                  general:
                  - date: '2024-01-01'
                    size: 4096
                    path: /var/log/edge_ai_api/general_2024-01-01.log
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho danh sách log
      operationId: listLogFilesOptions
      tags:
      - Logs
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/log/{category}:
    get:
      summary: Lấy log theo danh mục
      description: 'Trả về log từ một danh mục cụ thể với tùy chọn lọc.


        **Danh mục:** api, instance, sdk_output, general


        **Tham số Truy vấn:**

        - `level`: Lọc theo mức log (không phân biệt chữ hoa/thường, ví dụ: INFO, ERROR, WARNING)

        - `from`: Lọc log từ timestamp (định dạng ISO 8601, ví dụ: 2024-01-01T00:00:00.000Z)

        - `to`: Lọc log đến timestamp (định dạng ISO 8601, ví dụ: 2024-01-01T23:59:59.999Z)

        - `tail`: Chỉ lấy N dòng cuối cùng từ file log mới nhất (số nguyên)

        '
      operationId: getLogsByCategory
      tags:
      - Logs
      parameters:
      - name: category
        in: path
        required: true
        schema:
          type: string
          enum:
          - api
          - instance
          - sdk_output
          - general
        description: Danh mục log
        example: api
      - name: level
        in: query
        required: false
        schema:
          type: string
        description: Lọc theo mức log (không phân biệt chữ hoa/thường)
        example: INFO
      - name: from
        in: query
        required: false
        schema:
          type: string
          format: date-time
        description: Lọc log từ timestamp (ISO 8601)
        example: '2024-01-01T00:00:00.000Z'
      - name: to
        in: query
        required: false
        schema:
          type: string
          format: date-time
        description: Lọc log đến timestamp (ISO 8601)
        example: '2024-01-01T23:59:59.999Z'
      - name: tail
        in: query
        required: false
        schema:
          type: integer
          minimum: 0
        description: Chỉ lấy N dòng cuối cùng từ file log mới nhất
        example: 100
      responses:
        '200':
          description: Log từ danh mục đã chỉ định
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogsResponse'
              example:
                category: api
                category_dir: /var/log/edge_ai_api/api
                files_count: 1
                total_lines: 1000
                filtered_lines: 500
                logs:
                - timestamp: '2024-01-01T12:00:00.000Z'
                  level: INFO
                  message: API request received
                - timestamp: '2024-01-01T12:00:01.000Z'
                  level: ERROR
                  message: Failed to process request
        '400':
          description: Yêu cầu không hợp lệ (danh mục hoặc tham số không hợp lệ)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho lấy log theo danh mục
      operationId: getLogsByCategoryOptions
      tags:
      - Logs
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/log/{category}/{date}:
    get:
      summary: Lấy log theo danh mục và ngày
      description: 'Trả về log từ một danh mục và ngày cụ thể với tùy chọn lọc.


        **Danh mục:** api, instance, sdk_output, general

        **Định dạng Ngày:** YYYY-MM-DD (ví dụ: 2024-01-01)


        **Tham số Truy vấn:**

        - `level`: Lọc theo mức log (không phân biệt chữ hoa/thường, ví dụ: INFO, ERROR, WARNING)

        - `from`: Lọc log từ timestamp (định dạng ISO 8601, ví dụ: 2024-01-01T00:00:00.000Z)

        - `to`: Lọc log đến timestamp (định dạng ISO 8601, ví dụ: 2024-01-01T23:59:59.999Z)

        - `tail`: Chỉ lấy N dòng cuối cùng từ file log (số nguyên)

        '
      operationId: getLogsByCategoryAndDate
      tags:
      - Logs
      parameters:
      - name: category
        in: path
        required: true
        schema:
          type: string
          enum:
          - api
          - instance
          - sdk_output
          - general
        description: Danh mục log
        example: api
      - name: date
        in: path
        required: true
        schema:
          type: string
          pattern: ^\d{4}-\d{2}-\d{2}$
        description: Date in YYYY-MM-DD format
        example: '2024-01-01'
      - name: level
        in: query
        required: false
        schema:
          type: string
        description: Lọc theo mức log (không phân biệt chữ hoa/thường)
        example: INFO
      - name: from
        in: query
        required: false
        schema:
          type: string
          format: date-time
        description: Lọc log từ timestamp (ISO 8601)
        example: '2024-01-01T00:00:00.000Z'
      - name: to
        in: query
        required: false
        schema:
          type: string
          format: date-time
        description: Lọc log đến timestamp (ISO 8601)
        example: '2024-01-01T23:59:59.999Z'
      - name: tail
        in: query
        required: false
        schema:
          type: integer
          minimum: 0
        description: Chỉ lấy N dòng cuối cùng từ file log
        example: 100
      responses:
        '200':
          description: Log từ danh mục và ngày đã chỉ định
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogsByDateResponse'
              example:
                category: api
                date: '2024-01-01'
                total_lines: 1000
                filtered_lines: 500
                logs:
                - timestamp: '2024-01-01T12:00:00.000Z'
                  level: INFO
                  message: API request received
                - timestamp: '2024-01-01T12:00:01.000Z'
                  level: ERROR
                  message: Failed to process request
        '400':
          description: Bad request (invalid category, date format, or parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy file log cho ngày đã chỉ định
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho lấy log theo danh mục và ngày
      operationId: getLogsByCategoryAndDateOptions
      tags:
      - Logs
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/ai/process:
    post:
      summary: Xử lý một hình ảnh/khung hình
      description: 'Xử lý một hình ảnh/khung hình qua pipeline xử lý AI.

        Hỗ trợ hàng đợi dựa trên độ ưu tiên và giới hạn tốc độ.

        '
      operationId: processImage
      tags:
      - AI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - image
              properties:
                image:
                  type: string
                  description: Dữ liệu hình ảnh được mã hóa Base64
                  example: /9j/4AAQSkZJRg...
                config:
                  type: string
                  description: Cấu hình xử lý (chuỗi JSON)
                  example: '{"model": "yolo", "threshold": 0.5}'
                priority:
                  type: string
                  enum:
                  - low
                  - medium
                  - high
                  default: medium
                  description: Request priority
      responses:
        '200':
          description: Công việc xử lý đã được gửi thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id:
                    type: string
                    description: Định danh công việc duy nhất
                    example: job_1234567890
                  status:
                    type: string
                    example: queued
        '400':
          description: Bad request (invalid JSON or missing required fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '501':
          description: Not implemented
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/ai/batch:
    post:
      summary: Xử lý hàng loạt hình ảnh/khung hình
      description: 'Xử lý nhiều hình ảnh/khung hình trong một lô qua pipeline xử lý AI.

        Hiện tại trả về 501 Not Implemented.

        '
      operationId: processBatch
      tags:
      - AI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                images:
                  type: array
                  description: Mảng các hình ảnh được mã hóa Base64
                  items:
                    type: string
                config:
                  type: string
                  description: Cấu hình xử lý (chuỗi JSON)
      responses:
        '200':
          description: Công việc xử lý hàng loạt đã được gửi thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_ids:
                    type: array
                    items:
                      type: string
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '501':
          description: Not implemented
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/ai/status:
    get:
      summary: Lấy trạng thái xử lý AI
      description: 'Trả về trạng thái hiện tại của hệ thống xử lý AI bao gồm kích thước hàng đợi,

        dung lượng tối đa hàng đợi, khả năng sử dụng GPU và thông tin tài nguyên khác.

        '
      operationId: getAIStatus
      tags:
      - AI
      responses:
        '200':
          description: Trạng thái xử lý AI
          content:
            application/json:
              schema:
                type: object
                properties:
                  queue_size:
                    type: integer
                    format: int64
                    description: Số lượng mục hiện tại trong hàng đợi xử lý
                    example: 5
                  queue_max:
                    type: integer
                    format: int64
                    description: Dung lượng hàng đợi tối đa
                    example: 100
                  gpu_total:
                    type: integer
                    format: int64
                    description: Tổng số GPU có sẵn
                    example: 2
                  gpu_available:
                    type: integer
                    format: int64
                    description: Số lượng GPU có sẵn
                    example: 1
  /v1/core/ai/metrics:
    get:
      summary: Lấy số liệu xử lý AI
      description: 'Trả về số liệu chi tiết về xử lý AI bao gồm thống kê hiệu suất,

        thống kê cache và thông tin giới hạn tốc độ.

        '
      operationId: getAIMetrics
      tags:
      - AI
      responses:
        '200':
          description: Số liệu xử lý AI
          content:
            application/json:
              schema:
                type: object
                properties:
                  cache:
                    type: object
                    properties:
                      size:
                        type: integer
                        format: int64
                        description: Kích thước cache hiện tại
                      max_size:
                        type: integer
                        format: int64
                        description: Dung lượng cache tối đa
                      hit_rate:
                        type: number
                        format: float
                        description: Tỷ lệ cache hit (0.0 đến 1.0)
                  rate_limiter:
                    type: object
                    properties:
                      total_keys:
                        type: integer
                        format: int64
                        description: Tổng số khóa giới hạn tốc độ
                      active_keys:
                        type: integer
                        format: int64
                        description: Số lượng khóa giới hạn tốc độ đang hoạt động
  /v1/core/watchdog:
    get:
      summary: Lấy trạng thái watchdog
      description: 'Trả về thống kê watchdog và giám sát sức khỏe bao gồm kiểm tra sức khỏe instance,

        số lần khởi động lại và thông tin giám sát.

        '
      operationId: getWatchdogStatus
      tags:
      - Core
      responses:
        '200':
          description: Thông tin trạng thái watchdog
          content:
            application/json:
              schema:
                type: object
                description: Thống kê watchdog và giám sát sức khỏe
                additionalProperties: true
  /v1/core/endpoints:
    get:
      summary: Lấy thống kê endpoint
      description: 'Trả về thống kê cho mỗi endpoint API bao gồm số lượng yêu cầu, thời gian phản hồi,

        tỷ lệ lỗi và các số liệu hiệu suất khác.

        '
      operationId: getEndpointsStats
      tags:
      - Core
      responses:
        '200':
          description: Thống kê endpoint
          content:
            application/json:
              schema:
                type: object
                description: Thống kê cho mỗi endpoint
                additionalProperties: true
  /v1/core/metrics:
    get:
      summary: Lấy số liệu định dạng Prometheus
      description: 'Trả về số liệu hệ thống ở định dạng Prometheus để giám sát và cảnh báo.

        Endpoint này thường được sử dụng bởi các scraper Prometheus.

        '
      operationId: getMetrics
      tags:
      - Core
      responses:
        '200':
          description: Số liệu định dạng Prometheus
          content:
            text/plain:
              schema:
                type: string
                description: Số liệu ở định dạng văn bản Prometheus
                example: '# HELP http_requests_total Total number of HTTP requests

                  # TYPE http_requests_total counter

                  http_requests_total{method="GET",path="/v1/core/health"} 100

                  '
  /v1/core/model/upload:
    post:
      summary: Tải lên file mô hình
      description: 'Tải lên file mô hình (ONNX, weights, v.v.) lên máy chủ.

        File sẽ được lưu trong thư mục models. Bạn có thể chỉ định thư mục con

        bằng tham số truy vấn `directory` (ví dụ: `projects/myproject/models`).

        Nếu thư mục không tồn tại, nó sẽ được tạo tự động.

        Nếu không chỉ định thư mục, file sẽ được lưu trong thư mục models gốc.

        '
      operationId: uploadModel
      tags:
      - Models
      parameters:
      - name: directory
        in: query
        required: false
        schema:
          type: string
        description: 'Đường dẫn thư mục con nơi file mô hình sẽ được lưu.

          Use forward slashes to separate directory levels (e.g., "projects/myproject/models", "detection/yolov8", "classification/resnet50").

          The directory will be created automatically if it doesn''t exist.

          If not specified, files will be saved in the base models directory.

          '
        example: projects/myproject/models
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: File mô hình để tải lên. Chọn nhiều file để tải lên cùng lúc (.onnx, .rknn, .weights, .cfg,
                    .pt, .pth, .pb, .tflite)
                file:
                  type: string
                  format: binary
                  description: Một file mô hình để tải lên (thay thế cho mảng files)
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: File mô hình dưới dạng dữ liệu nhị phân
      responses:
        '201':
          description: File mô hình đã được tải lên thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  count:
                    type: integer
                    description: Số lượng file đã tải lên thành công
                  files:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        originalFilename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        url:
                          type: string
                  warnings:
                    type: array
                    items:
                      type: string
                    description: Cảnh báo cho các file tải lên thất bại
        '400':
          description: Yêu cầu không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: File đã tồn tại
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho tải lên mô hình
      operationId: uploadModelOptions
      tags:
      - Models
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/core/model/list:
    get:
      summary: Liệt kê các file mô hình đã tải lên
      description: "Trả về danh sách các file mô hình đã được tải lên máy chủ.\n- Nếu tham số `directory` không được\
        \ chỉ định: Tìm kiếm đệ quy và liệt kê tất cả các file mô hình\n  trong toàn bộ cây thư mục models (bao gồm tất cả\
        \ các thư mục con).\n- Nếu tham số `directory` được chỉ định: Chỉ liệt kê các file trong thư mục cụ thể đó\n  (không đệ quy,\
        \ không tìm kiếm thư mục con).\n"
      operationId: listModels
      tags:
      - Models
      parameters:
      - name: directory
        in: query
        required: false
        schema:
          type: string
        description: 'Đường dẫn thư mục con để liệt kê file từ đó (ví dụ: "projects/myproject/models", "detection/yolov8").

          Nếu được chỉ định, chỉ liệt kê các file trong thư mục đó (không đệ quy).

          Nếu không được chỉ định, tìm kiếm đệ quy tất cả các thư mục con.

          '
        example: projects/myproject/models
      responses:
        '200':
          description: Danh sách các file mô hình
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  models:
                    type: array
                    items:
                      type: object
                      properties:
                        filename:
                          type: string
                        path:
                          type: string
                        size:
                          type: integer
                        modified:
                          type: string
                  count:
                    type: integer
                  directory:
                    type: string
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/model/{modelName}:
    put:
      summary: Đổi tên một file mô hình
      description: 'Đổi tên một file mô hình trên máy chủ.

        Bạn có thể chỉ định thư mục con bằng tham số truy vấn `directory` nếu file nằm trong thư mục con.

        '
      operationId: renameModel
      tags:
      - Models
      parameters:
      - name: modelName
        in: path
        required: true
        schema:
          type: string
        description: Tên hiện tại của file mô hình cần đổi tên
      - name: directory
        in: query
        required: false
        schema:
          type: string
        description: 'Đường dẫn thư mục con nơi file mô hình được đặt (ví dụ: "projects/myproject/models", "detection/yolov8").

          Nếu không được chỉ định, file được giả định nằm trong thư mục models cơ sở.

          '
        example: projects/myproject/models
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - newName
              properties:
                newName:
                  type: string
                  description: Tên mới cho file mô hình (phải có phần mở rộng file mô hình hợp lệ)
                  example: my_model_v2.onnx
      responses:
        '200':
          description: File mô hình đã được đổi tên thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  oldName:
                    type: string
                  newName:
                    type: string
                  path:
                    type: string
        '400':
          description: Yêu cầu không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy file mô hình
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Tên mới đã tồn tại
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Xóa một file mô hình
      description: 'Xóa một file mô hình khỏi máy chủ.

        Bạn có thể chỉ định thư mục con bằng tham số truy vấn `directory` nếu file nằm trong thư mục con.

        '
      operationId: deleteModel
      tags:
      - Models
      parameters:
      - name: modelName
        in: path
        required: true
        schema:
          type: string
        description: Tên file mô hình cần xóa
      - name: directory
        in: query
        required: false
        schema:
          type: string
        description: 'Đường dẫn thư mục con nơi file mô hình được đặt (ví dụ: "projects/myproject/models", "detection/yolov8").

          Nếu không được chỉ định, file được giả định nằm trong thư mục models cơ sở.

          '
        example: projects/myproject/models
      responses:
        '200':
          description: File mô hình đã được xóa thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  filename:
                    type: string
        '400':
          description: Yêu cầu không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy file mô hình
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/core/video/upload:
    post:
      summary: Upload a video file
      description: 'Uploads a video file (MP4, AVI, MKV, etc.) to the server.

        The file will be saved in the videos directory. You can specify a subdirectory

        using the `directory` query parameter (e.g., `projects/myproject/videos`).

        If the directory doesn''t exist, it will be created automatically.

        If no directory is specified, files will be saved in the base videos directory.

        '
      operationId: uploadVideo
      tags:
      - Video
      parameters:
      - name: directory
        in: query
        required: false
        schema:
          type: string
        description: 'Đường dẫn thư mục con nơi file video sẽ được lưu.

          Sử dụng dấu gạch chéo để phân tách các cấp thư mục (ví dụ: "projects/myproject/videos", "users/user123", "category1/subcategory").

          Thư mục sẽ được tạo tự động nếu không tồn tại.

          Nếu không được chỉ định, file sẽ được lưu trong thư mục videos gốc.

          '
        example: projects/myproject/videos
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: File video để tải lên. Chọn nhiều file để tải lên cùng lúc (.mp4, .avi, .mkv, .mov, .flv,
                    .wmv, .webm, v.v.)
                file:
                  type: string
                  format: binary
                  description: Một file video để tải lên (thay thế cho mảng files)
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: File video dưới dạng dữ liệu nhị phân
      responses:
        '201':
          description: File video đã được tải lên thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  count:
                    type: integer
  /v1/onvif/discover:
    post:
      summary: Khám phá camera ONVIF
      description: 'Khám phá các camera ONVIF trên mạng bằng giao thức WS-Discovery.

        Endpoint này khởi động quá trình khám phá bất đồng bộ để tìm kiếm các camera tuân thủ ONVIF trên mạng cục bộ.

        **Tham số Timeout:**
        - Tham số truy vấn tùy chọn `timeout` (1-30 giây, mặc định: 5)
        - Điều khiển thời gian chờ phản hồi từ camera trong quá trình khám phá

        **Phản hồi:**
        - Trả về 204 No Content khi quá trình khám phá được khởi động
        - Sử dụng GET /v1/onvif/cameras để lấy danh sách camera đã khám phá sau khi hoàn tất
        '
      operationId: discoverONVIFCameras
      tags:
      - ONVIF
      parameters:
      - name: timeout
        in: query
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 30
          default: 5
        description: 'Thời gian chờ khám phá tính bằng giây (1-30, mặc định: 5)'
        example: 5
      responses:
        '204':
          description: Quá trình khám phá đã được khởi động thành công
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho khám phá ONVIF
      operationId: discoverONVIFCamerasOptions
      tags:
      - ONVIF
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/onvif/cameras:
    get:
      summary: Lấy danh sách tất cả camera ONVIF đã khám phá
      description: 'Lấy danh sách tất cả các camera ONVIF đã được khám phá trên mạng.

        **Thông tin Camera:**
        - Mỗi camera bao gồm địa chỉ IP, UUID, nhà sản xuất, model và số serial
        - Camera được lọc dựa trên whitelist hỗ trợ (nếu được cấu hình)
        - Chỉ các camera vượt qua kiểm tra whitelist mới được trả về

        **Cách sử dụng:**
        1. Đầu tiên gọi POST /v1/onvif/discover để khám phá camera
        2. Sau đó gọi endpoint này để lấy danh sách camera đã khám phá
        3. Sử dụng camera ID (IP hoặc UUID) để lấy streams hoặc thiết lập credentials
        '
      operationId: getONVIFCameras
      tags:
      - ONVIF
      responses:
        '200':
          description: Danh sách camera ONVIF đã khám phá
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ONVIFCamera'
              example:
                - ip: 192.168.1.100
                  uuid: 00000000-0000-0000-0000-000000000000
                  manufacturer: Hikvision
                  model: DS-2CD2347G1-LU
                  serialNumber: ABC123456
                - ip: 192.168.1.101
                  uuid: 11111111-1111-1111-1111-111111111111
                  manufacturer: Axis
                  model: P3245-LVE
                  serialNumber: DEF789012
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho camera ONVIF
      operationId: getONVIFCamerasOptions
      tags:
      - ONVIF
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/onvif/streams/{cameraid}:
    get:
      summary: Lấy streams cho một camera ONVIF
      description: 'Lấy các video streams có sẵn cho một camera ONVIF cụ thể.

        **Camera ID:**
        - Có thể là địa chỉ IP của camera (ví dụ: "192.168.1.100") hoặc UUID
        - Định dạng địa chỉ IP: 0-255.0-255.0-255.0-255

        **Thông tin Stream:**
        - Mỗi stream bao gồm profile token, độ phân giải (width/height), frame rate (fps) và RTSP URI
        - Streams được lấy bằng dịch vụ ONVIF Media
        - Credentials của camera phải được thiết lập trước khi lấy streams (nếu yêu cầu xác thực)

        **Cách sử dụng:**
        1. Khám phá camera bằng POST /v1/onvif/discover
        2. Lấy danh sách camera bằng GET /v1/onvif/cameras
        3. Thiết lập credentials bằng POST /v1/onvif/camera/{cameraid}/credentials (nếu cần)
        4. Lấy streams bằng endpoint này
        '
      operationId: getONVIFStreams
      tags:
      - ONVIF
      parameters:
      - name: cameraid
        in: path
        required: true
        schema:
          type: string
        description: Định danh camera (địa chỉ IP hoặc UUID)
        example: 192.168.1.100
      responses:
        '200':
          description: Danh sách streams có sẵn cho camera
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ONVIFStream'
              example:
                - token: Profile_1
                  width: 1920
                  height: 1080
                  fps: 30
                  uri: rtsp://192.168.1.100:554/Streaming/Channels/101
                - token: Profile_2
                  width: 640
                  height: 480
                  fps: 15
                  uri: rtsp://192.168.1.100:554/Streaming/Channels/102
        '400':
          description: Yêu cầu không hợp lệ (thiếu hoặc không hợp lệ camera ID)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy camera
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho streams ONVIF
      operationId: getONVIFStreamsOptions
      tags:
      - ONVIF
      responses:
        '200':
          description: Phản hồi CORS preflight
  /v1/onvif/camera/{cameraid}/credentials:
    post:
      summary: Thiết lập credentials cho một camera ONVIF
      description: 'Thiết lập thông tin xác thực cho một camera ONVIF cụ thể.

        **Camera ID:**
        - Có thể là địa chỉ IP của camera (ví dụ: "192.168.1.100") hoặc UUID
        - Định dạng địa chỉ IP: 0-255.0-255.0-255.0-255

        **Credentials:**
        - Username và password là bắt buộc
        - Credentials được lưu trữ an toàn và được sử dụng cho các thao tác ONVIF tiếp theo
        - Nếu camera không được tìm thấy, có thể được đề xuất nếu phát hiện IP tương tự

        **Cách sử dụng:**
        1. Khám phá camera bằng POST /v1/onvif/discover
        2. Lấy danh sách camera bằng GET /v1/onvif/cameras
        3. Thiết lập credentials bằng endpoint này
        4. Lấy streams bằng GET /v1/onvif/streams/{cameraid}
        '
      operationId: setONVIFCredentials
      tags:
      - ONVIF
      parameters:
      - name: cameraid
        in: path
        required: true
        schema:
          type: string
        description: Định danh camera (địa chỉ IP hoặc UUID)
        example: 192.168.1.100
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ONVIFCredentialsRequest'
            example:
              username: admin
              password: password123
      responses:
        '204':
          description: Credentials đã được thiết lập thành công
        '400':
          description: Yêu cầu không hợp lệ (thiếu username hoặc password, JSON không hợp lệ)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy camera
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    options:
      summary: CORS preflight cho credentials ONVIF
      operationId: setONVIFCredentialsOptions
      tags:
      - ONVIF
      responses:
        '200':
          description: Phản hồi CORS preflight
components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
        message:
          type: string
    HealthResponse:
      type: object
      properties:
        status:
          type: string
        timestamp:
          type: string
        uptime:
          type: integer
        service:
          type: string
        version:
          type: string
    VersionResponse:
      type: object
      properties:
        version:
          type: string
        build_time:
          type: string
        git_commit:
          type: string
        api_version:
          type: string
        service:
          type: string
    SystemInfoResponse:
      type: object
      additionalProperties: true
    SystemStatusResponse:
      type: object
      additionalProperties: true
    SystemConfigResponse:
      type: object
      description: System configuration entities response
      properties:
        systemConfig:
          type: array
          description: Array of system configuration entities
          items:
            type: object
            properties:
              fieldId:
                type: string
                description: Configuration field identifier
                example: voice6
              displayName:
                type: string
                description: Human-readable display name
                example: voice n. 6
              type:
                type: string
                description: Configuration type (options, string, number, boolean)
                example: options
              value:
                type: string
                description: Current configuration value
                example: solutions
              group:
                type: string
                description: Configuration group name
                example: groupBy
              availableValues:
                type: array
                description: Available values for options type
                items:
                  type: object
                  properties:
                    displayName:
                      type: string
                      example: securt 1 version 1.0
                    value:
                      type: string
                      example: securt
    SystemConfigUpdateRequest:
      type: object
      description: System configuration update request
      required:
      - systemConfig
      properties:
        systemConfig:
          type: array
          description: Array of configuration updates
          items:
            type: object
            required:
            - fieldId
            - value
            properties:
              fieldId:
                type: string
                description: Configuration field identifier to update
                example: voice6
              value:
                type: string
                description: New configuration value
                example: securt
    SystemPreferencesResponse:
      type: object
      description: System preferences from rtconfig.json
      additionalProperties:
        oneOf:
        - type: boolean
        - type: string
        - type: number
      example:
        vms.show_area_crossing: true
        vms.show_line_crossing: true
        vms.show_intrusion: true
        vms.show_crowding: true
        vms.show_loitering: true
        vms.show_object_left: true
        vms.show_object_guarding: true
        vms.show_tailgating: true
        vms.show_fallen_person: true
        vms.show_armed_person: true
        vms.show_access_control_plate: true
        vms.show_access_control_face: true
        vms.show_appearance_search: true
        vms.show_identities: true
        vms.show_remote_mode: true
        vms.show_thermal_support: true
        vms.show_active_detection: true
        vms.show_error_reporting: true
        vms.show_trial_licenses: true
        vms.hardware_decoding: true
        global.default_performance_mode: Performance
    SystemDecodersResponse:
      type: object
      description: Available system decoders information
      additionalProperties:
        type: object
        additionalProperties:
          type: integer
          description: Number of available decoders for the codec
      example:
        nvidia:
          hevc: 1
          h264: 1
    LogFilesResponse:
      type: object
      additionalProperties: true
    LogsResponse:
      type: object
      additionalProperties: true
    LogsByDateResponse:
      type: object
      additionalProperties: true
    ONVIFCamera:
      type: object
      description: Thông tin camera ONVIF
      properties:
        ip:
          type: string
          format: ipv4
          description: Địa chỉ IP camera
          example: "{ip_address}"
        uuid:
          type: string
          description: UUID camera (định danh duy nhất)
          example: "{Hỗ}"
        manufacturer:
          type: string
          description: Tên nhà sản xuất camera
          example: Hikvision
        model:
          type: string
          description: Tên model camera
          example: DS-2CD2347G1-LU
        serialNumber:
          type: string
          description: Số serial camera
          example: ABC123456
    ONVIFStream:
      type: object
      description: Thông tin video stream ONVIF
      properties:
        token:
          type: string
          description: Token profile stream
          example: Profile_1
        width:
          type: integer
          description: Độ rộng stream tính bằng pixel
          example: 1920
        height:
          type: integer
          description: Độ cao stream tính bằng pixel
          example: 1080
        fps:
          type: integer
          description: Frame rate (số khung hình mỗi giây)
          example: 30
          uri:
            type: string
            format: uri
            description: RTSP stream URI
            example: "rtsp://{ip_address}:554/Streaming/Channels/101"
    ONVIFCredentialsRequest:
      type: object
      required:
      - username
      - password
      description: Credentials camera ONVIF
      properties:
        username:
          type: string
          description: Username camera
          example: admin
        password:
          type: string
          format: password
          description: Password camera
          example: password123
